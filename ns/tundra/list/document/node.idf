<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.list.document</value>
  <value name="shared">Ly8gcmV0dXJucyBhIG5ldyBJRGF0YVtdIHdpdGggYWxsIG51bGwgdmFsdWVzIHJlbW92ZWQKcHVi
bGljIHN0YXRpYyBJRGF0YVtdIGNvbXBhY3QoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJh
eTsKCiAgLy8gdGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFs
bHkgYW4gSURhdGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFi
bGUgdG8gc3RvcmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElE
YXRhW10pamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJ
RGF0YVswXSkuZ2V0Q2xhc3MoKSk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3Ro
OyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9IHR1bmRyYS5kb2N1
bWVudC5jb21wYWN0KGFycmF5W2ldLCByZWN1cnNlKTsKICB9CgogIHJldHVybiB0dW5kcmEubGlz
dC5vYmplY3QuY29tcGFjdChhcnJheSk7Cn0KCi8vIHJldHVybnMgdGhlIHVuaW9uIHNldCBvZiBr
ZXlzIHByZXNlbnQgaW4gZXZlcnkgaXRlbSBpbiB0aGUgZ2l2ZW4KLy8gSURhdGFbXSBkb2N1bWVu
dCBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5cyhJRGF0YVtdIGlucHV0KSB7CiAgcmV0
dXJuIGtleXMoaW5wdXQsIG51bGwpOwp9CgovLyByZXR1cm5zIHRoZSB1bmlvbiBzZXQgb2Yga2V5
cyBwcmVzZW50IGluIGV2ZXJ5IGl0ZW0gaW4gdGhlIGdpdmVuCi8vIElEYXRhW10gZG9jdW1lbnQg
bGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIHBh
dHRlcm5TdHJpbmcpIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwYXR0ZXJuID0gbnVsbDsK
ICBpZiAocGF0dGVyblN0cmluZyAhPSBudWxsKSBwYXR0ZXJuID0gamF2YS51dGlsLnJlZ2V4LlBh
dHRlcm4uY29tcGlsZShwYXR0ZXJuU3RyaW5nKTsKICAKICBqYXZhLnV0aWwuU2V0PFN0cmluZz4g
a2V5cyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxTdHJpbmc+KCk7CgogIGlmIChpbnB1
dCAhPSBudWxsKSB7CiAgICBmb3IgKElEYXRhIGRvY3VtZW50IDogaW5wdXQpIHsKICAgICAgaWYg
KGRvY3VtZW50ICE9IG51bGwpIHsKICAgICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBkb2N1bWVu
dC5nZXRDdXJzb3IoKTsKICAgICAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgICAgICBT
dHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICAgICAgCiAgICAgICAgICBpZiAocGF0
dGVybiA9PSBudWxsKSB7CiAgICAgICAgICAgIGtleXMuYWRkKGtleSk7CiAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICBqYXZhLnV0aWwucmVnZXguTWF0Y2hlciBtYXRjaGVyID0gcGF0dGVy
bi5tYXRjaGVyKGtleSk7CiAgICAgICAgICAgIGlmIChtYXRjaGVyLm1hdGNoZXMoKSkga2V5cy5h
ZGQoa2V5KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3Vyc29yLmRlc3Ryb3koKTsg
ICAgIAogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4ga2V5cy50b0FycmF5KG5ldyBTdHJpbmdb
MF0pOwp9CgovLyByZXR1cm5zIGFuIElEYXRhIGRvY3VtZW50IHdoZXJlIHRoZSBrZXlzIGFyZSB0
aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aAovLyBnaXZlbiBwaXZvdCBrZXkgZnJvbSB0aGUgZ2l2
ZW4gSURhdGFbXSBkb2N1bWVudCBsaXN0LCBhbmQgdGhlIHZhbHVlcyBhcmUKLy8gdGhlIElEYXRh
W10gZG9jdW1lbnQgbGlzdCBpdGVtcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBwaXZvdCBrZXkKcHVi
bGljIHN0YXRpYyBJRGF0YSBwaXZvdChJRGF0YVtdIGFycmF5LCBTdHJpbmcgcGl2b3RLZXkpIHsK
ICByZXR1cm4gcGl2b3QoYXJyYXksIG51bGwsIHBpdm90S2V5KTsKfQoKLy8gcmV0dXJucyBhbiBJ
RGF0YSBkb2N1bWVudCB3aGVyZSB0aGUga2V5cyBhcmUgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdp
dGgKLy8gZ2l2ZW4gcGl2b3Qga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhW10gZG9jdW1lbnQgbGlz
dCwgYW5kIHRoZSB2YWx1ZXMgYXJlCi8vIHRoZSBJRGF0YVtdIGRvY3VtZW50IGxpc3QgaXRlbXMg
YXNzb2NpYXRlZCB3aXRoIGVhY2ggcGl2b3Qga2V5CnB1YmxpYyBzdGF0aWMgSURhdGEgcGl2b3Qo
SURhdGFbXSBhcnJheSwgU3RyaW5nIGRlbGltaXRlciwgU3RyaW5nIC4uLiBwaXZvdEtleXMpIHsK
ICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBwaXZvdEtleXMgPT0gbnVsbCB8fCBwaXZvdEtleXMubGVu
Z3RoID09IDApIHJldHVybiBudWxsOwogIGlmIChkZWxpbWl0ZXIgPT0gbnVsbCkgZGVsaW1pdGVy
ID0gIjoiOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgSURhdGFD
dXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIG91dGVyOgogIGZvciAoSURhdGEgaXRl
bSA6IGFycmF5KSB7CiAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAgICAgIFN0cmluZ0J1aWxkZXIg
YnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBw
aXZvdEtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBPYmplY3QgdmFsdWUgPSB0dW5kcmEuc3Vw
cG9ydC5kb2N1bWVudC5nZXQoaXRlbSwgcGl2b3RLZXlzW2ldKTsKICAgICAgICBpZiAodmFsdWUg
PT0gbnVsbCkgewogICAgICAgICAgY29udGludWUgb3V0ZXI7CiAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgIGJ1ZmZlci5hcHBlbmQodmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICAg
IGlmIChpIDwgKHBpdm90S2V5cy5sZW5ndGggLSAxKSkgYnVmZmVyLmFwcGVuZChkZWxpbWl0ZXIp
OwogICAgICB9CiAgICAgIFN0cmluZyBrZXkgPSBidWZmZXIudG9TdHJpbmcoKTsKICAgICAgaWYg
KElEYXRhVXRpbC5nZXQob2MsIGtleSkgPT0gbnVsbCkgSURhdGFVdGlsLnB1dChvYywga2V5LCBp
dGVtKTsKICAgIH0KICB9CgogIG9jLmRlc3Ryb3koKTsKCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8g
cmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0ZWQgaW4gYXNjZW5kaW5n
IG9yZGVyIGJ5Ci8vIHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBrZXkKcHVi
bGljIHN0YXRpYyBJRGF0YVtdIHNvcnQoSURhdGFbXSBhcnJheSwgU3RyaW5nIGtleSkgewogIHJl
dHVybiBzb3J0KGFycmF5LCBrZXksIHRydWUpOwp9CgovLyByZXR1cm5zIGEgbmV3IGFycmF5IHdp
dGggYWxsIGVsZW1lbnRzIHNvcnRlZCBlaXRoZXIgaW4gYXNjZW5kaW5nIG9yCi8vIGRlc2NlbmRp
bmcgb3JkZXIgYnkgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGtleQpwdWJs
aWMgc3RhdGljIElEYXRhW10gc29ydChJRGF0YVtdIGFycmF5LCBTdHJpbmcga2V5LCBib29sZWFu
IGFzY2VuZGluZykgewogIFN0cmluZ1tdIGtleXMgPSBudWxsOwogIGlmIChrZXkgIT0gbnVsbCkg
ewogICAga2V5cyA9IG5ldyBTdHJpbmdbMV07CiAgICBrZXlzWzBdID0ga2V5OwogIH0KCiAgcmV0
dXJuIHNvcnQoYXJyYXksIGtleXMsIGFzY2VuZGluZyk7Cn0KCi8vIHJldHVybnMgYSBuZXcgYXJy
YXkgd2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGluIGFzY2VuZGluZyBvcmRlciBieSB0aGUgCi8v
IHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGtleXMKcHVibGljIHN0YXRpYyBJRGF0
YVtdIHNvcnQoSURhdGFbXSBhcnJheSwgU3RyaW5nW10ga2V5cykgewogIHJldHVybiBzb3J0KGFy
cmF5LCBrZXlzLCB0cnVlKTsKfQoKLy8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVt
ZW50cyBzb3J0ZWQgYnkgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggCi8vIHRoZSBnaXZlbiBr
ZXlzCnB1YmxpYyBzdGF0aWMgSURhdGFbXSBzb3J0KElEYXRhW10gYXJyYXksIFN0cmluZ1tdIGtl
eXMsIGJvb2xlYW4gYXNjZW5kaW5nKSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVu
Z3RoIDwgMiB8fCBrZXlzID09IG51bGwgfHwga2V5cy5sZW5ndGggPT0gMCkgcmV0dXJuIGFycmF5
OwoKICBJRGF0YVtdIHNvcnRLZXlzID0gbmV3IElEYXRhW2tleXMubGVuZ3RoXTsKICBmb3IgKGlu
dCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIHNvcnRLZXlzW2ldID0gSURhdGFG
YWN0b3J5LmNyZWF0ZSgpOwogICAgSURhdGFDdXJzb3IgY3Vyc29yID0gc29ydEtleXNbaV0uZ2V0
Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgImtleSIsIGtleXNbaV0pOwogICAg
SURhdGFVdGlsLnB1dChjdXJzb3IsICJkZXNjZW5kaW5nPyIsICIiICsgIWFzY2VuZGluZyk7CiAg
ICBjdXJzb3IuZGVzdHJveSgpOwogIH0KCiAgcmV0dXJuIHNvcnQoYXJyYXksIHNvcnRLZXlzKTsK
fQoKLy8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0ZWQgYnkgdGhl
IHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggCi8vIHRoZSBnaXZlbiBrZXlzCnB1YmxpYyBzdGF0aWMg
SURhdGFbXSBzb3J0KElEYXRhW10gYXJyYXksIElEYXRhW10gY3JpdGVyaWEpIHsKICBpZiAoYXJy
YXkgPT0gbnVsbCB8fCBhcnJheS5sZW5ndGggPCAyIHx8IGNyaXRlcmlhID09IG51bGwgfHwgY3Jp
dGVyaWEubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgYXJyYXkgPSBqYXZhLnV0aWwuQXJy
YXlzLmNvcHlPZihhcnJheSwgYXJyYXkubGVuZ3RoKTsKICBqYXZhLnV0aWwuQXJyYXlzLnNvcnQo
YXJyYXksIG5ldyBJRGF0YUNvbXBhcmF0b3IoY3JpdGVyaWEpKTsKCiAgcmV0dXJuIGFycmF5Owp9
CgovLyByZXR1cm5zIGEgbmV3IElEYXRhW10gd2l0aCBhbGwgZW1wdHkgYW5kIG51bGwgaXRlbXMg
cmVtb3ZlZApwdWJsaWMgc3RhdGljIElEYXRhW10gc3F1ZWV6ZShJRGF0YVtdIGFycmF5LCBib29s
ZWFuIHJlY3Vyc2UpIHsKICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBhcnJheS5sZW5ndGggPT0gMCkg
cmV0dXJuIGFycmF5OwoKICAvLyB0YWtlIGEgY29weSBvZiB0aGUgYXJyYXksIHRvIG1ha2Ugc3Vy
ZSBpdCdzIHJlYWxseSBhbiBJRGF0YVtdIGFuZCBub3Qgc29tZSBzdWJjbGFzcyB0aGF0IHdvbid0
CiAgLy8gYmUgYWJsZSB0byBzdG9yZSBkaWZmZXJlbnQgSURhdGEgaW1wbGVtZW50YXRpb25zCiAg
YXJyYXkgPSAoSURhdGFbXSlqYXZhLnV0aWwuQXJyYXlzLmNvcHlPZihhcnJheSwgYXJyYXkubGVu
Z3RoLCAobmV3IElEYXRhWzBdKS5nZXRDbGFzcygpKTsKCiAgamF2YS51dGlsLkxpc3Q8SURhdGE+
IGxpc3QgPSBuZXcgamF2YS51dGlsLkFycmF5TGlzdDxJRGF0YT4oYXJyYXkubGVuZ3RoKTsKCiAg
Zm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgaWYgKGFycmF5W2ld
ICE9IG51bGwpIGFycmF5W2ldID0gdHVuZHJhLmRvY3VtZW50LnNxdWVlemUoYXJyYXlbaV0sIHJl
Y3Vyc2UpOwogICAgaWYgKGFycmF5W2ldICE9IG51bGwpIGxpc3QuYWRkKGFycmF5W2ldKTsKICB9
CgogIGFycmF5ID0gbGlzdC50b0FycmF5KG5ldyBJRGF0YVswXSk7CiAgaWYgKGFycmF5Lmxlbmd0
aCA9PSAwKSBhcnJheSA9IG51bGw7CgogIHJldHVybiBhcnJheTsKfQoKLy8gY29tcGFyZXMgdHdv
IElEYXRhIG9iamVjdHMgdXNpbmcgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVu
IGxpc3QKLy8gb2Yga2V5cwpwdWJsaWMgc3RhdGljIGNsYXNzIElEYXRhQ29tcGFyYXRvciBpbXBs
ZW1lbnRzIGphdmEudXRpbC5Db21wYXJhdG9yPElEYXRhPiB7CiAgcHJvdGVjdGVkIElEYXRhW10g
Y3JpdGVyaWE7CgogIHB1YmxpYyBJRGF0YUNvbXBhcmF0b3IoSURhdGFbXSBjcml0ZXJpYSkgewog
ICAgdGhpcy5jcml0ZXJpYSA9IGNyaXRlcmlhOwogIH0KCiAgcHJvdGVjdGVkIHN0YXRpYyBpbnQg
bm9ybWFsaXplKGludCByZXN1bHQsIGJvb2xlYW4gZGVzY2VuZGluZykgewogICAgaWYgKGRlc2Nl
bmRpbmcpIHsKICAgICAgaWYgKHJlc3VsdCA8IDApIHsKICAgICAgICByZXN1bHQgPSAxOwogICAg
ICB9IGVsc2UgaWYgKHJlc3VsdCA+IDApIHsKICAgICAgICByZXN1bHQgPSAtMTsKICAgICAgfQog
ICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIHB1YmxpYyBpbnQgY29tcGFyZShJRGF0YSBh
LCBJRGF0YSBiKSB7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIGZvciAoSURhdGEgaXRlbSA6IGNy
aXRlcmlhKSB7CiAgICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGl0ZW0uZ2V0Q3Vyc29yKCk7CiAg
ICAgIFN0cmluZyBrZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImtleSIpOwogICAg
ICBTdHJpbmcgdHlwZSA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCAidHlwZSIpOwogICAg
ICBTdHJpbmcgcGF0dGVybiA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCAicGF0dGVybiIp
OwogICAgICBib29sZWFuIGRlc2NlbmRpbmcgPSB0dW5kcmEuYm9vbC5wYXJzZShJRGF0YVV0aWwu
Z2V0U3RyaW5nKGN1cnNvciwgImRlc2NlbmRpbmc/IikpOwogICAgICBjdXJzb3IuZGVzdHJveSgp
OwoKICAgICAgT2JqZWN0IHZhbHVlX2EgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoYSwg
a2V5KTsKICAgICAgT2JqZWN0IHZhbHVlX2IgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQo
Yiwga2V5KTsKCiAgICAgIGlmICh2YWx1ZV9hID09IG51bGwpIHsKICAgICAgICBpZiAodmFsdWVf
YiAhPSBudWxsKSB7CiAgICAgICAgICByZXN1bHQgPSBub3JtYWxpemUoLTEsIGRlc2NlbmRpbmcp
OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHZhbHVlX2IgPT0g
bnVsbCkgewogICAgICAgIGlmICh2YWx1ZV9hICE9IG51bGwpIHsKICAgICAgICAgIHJlc3VsdCA9
IG5vcm1hbGl6ZSgxLCBkZXNjZW5kaW5nKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAg
ICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZSAhPSBudWxsKSB7CiAgICAgICAgICB2YWx1ZV9h
ID0gdmFsdWVfYS50b1N0cmluZygpOwogICAgICAgICAgdmFsdWVfYiA9IHZhbHVlX2IudG9TdHJp
bmcoKTsKICAgICAgICAgIGlmICh0eXBlLmVxdWFscygiaW50ZWdlciIpKSB7CiAgICAgICAgICAg
IHZhbHVlX2EgPSB0dW5kcmEuaW50ZWdlci5wYXJzZSgoU3RyaW5nKXZhbHVlX2EpOwogICAgICAg
ICAgICB2YWx1ZV9iID0gdHVuZHJhLmludGVnZXIucGFyc2UoKFN0cmluZyl2YWx1ZV9iKTsKICAg
ICAgICAgIH0gZWxzZSBpZiAodHlwZS5lcXVhbHMoImRlY2ltYWwiKSkgewogICAgICAgICAgICB2
YWx1ZV9hID0gdHVuZHJhLmRlY2ltYWwucGFyc2UoKFN0cmluZyl2YWx1ZV9hKTsKICAgICAgICAg
ICAgdmFsdWVfYiA9IHR1bmRyYS5kZWNpbWFsLnBhcnNlKChTdHJpbmcpdmFsdWVfYik7CiAgICAg
ICAgICB9IGVsc2UgaWYgKHR5cGUuZXF1YWxzKCJkYXRldGltZSIpKSB7CiAgICAgICAgICAgIHZh
bHVlX2EgPSB0dW5kcmEuZGF0ZXRpbWUucGFyc2UoKFN0cmluZyl2YWx1ZV9hLCBwYXR0ZXJuKTsK
ICAgICAgICAgICAgdmFsdWVfYiA9IHR1bmRyYS5kYXRldGltZS5wYXJzZSgoU3RyaW5nKXZhbHVl
X2IsIHBhdHRlcm4pOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlLmVxdWFscygiZHVyYXRpb24i
KSkgewogICAgICAgICAgICB2YWx1ZV9hID0gdHVuZHJhLmludGVnZXIucGFyc2UodHVuZHJhLmR1
cmF0aW9uLmZvcm1hdCgoU3RyaW5nKXZhbHVlX2EsIHBhdHRlcm4sICJtaWxsaXNlY29uZHMiKSk7
CiAgICAgICAgICAgIHZhbHVlX2IgPSB0dW5kcmEuaW50ZWdlci5wYXJzZSh0dW5kcmEuZHVyYXRp
b24uZm9ybWF0KChTdHJpbmcpdmFsdWVfYiwgcGF0dGVybiwgIm1pbGxpc2Vjb25kcyIpKTsKICAg
ICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZV9hIGluc3RhbmNlb2YgQ29tcGFy
YWJsZSAmJiB2YWx1ZV9iIGluc3RhbmNlb2YgQ29tcGFyYWJsZSkgewogICAgICAgICAgcmVzdWx0
ID0gbm9ybWFsaXplKCgoQ29tcGFyYWJsZSl2YWx1ZV9hKS5jb21wYXJlVG8oKENvbXBhcmFibGUp
dmFsdWVfYiksIGRlc2NlbmRpbmcpOwogICAgICAgICAgaWYgKHJlc3VsdCAhPSAwKSBicmVhazsK
ICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CgovLyBncm91
cHMgdGhlIGdpdmVuIGxpc3QgYnkgdGhlIGdpdmVuIGtleXMKcHVibGljIHN0YXRpYyBJRGF0YVtd
IGdyb3VwKElEYXRhW10gbGlzdCwgU3RyaW5nW10ga2V5cykgewogIGlmIChsaXN0ID09IG51bGwg
fHwgbGlzdC5sZW5ndGggPT0gMCkgcmV0dXJuIGxpc3Q7CgogIGlmIChrZXlzID09IG51bGwgfHwg
a2V5cy5sZW5ndGggPT0gMCkgewogICAgSURhdGFbXSByZXN1bHQgPSBuZXcgSURhdGFbMV07CiAg
ICByZXN1bHRbMF0gPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBjdXJz
b3IgPSByZXN1bHRbMF0uZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgImdy
b3VwIiwgSURhdGFGYWN0b3J5LmNyZWF0ZSgpKTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCAi
aXRlbXMiLCBsaXN0KTsKICAgIGN1cnNvci5kZXN0cm95KCk7CiAgICByZXR1cm4gcmVzdWx0Owog
IH0gZWxzZSB7CiAgICBqYXZhLnV0aWwuTWFwPENvbXBvdW5kS2V5LCBqYXZhLnV0aWwuTGlzdDxJ
RGF0YT4+IGdyb3VwcyA9IG5ldyBqYXZhLnV0aWwuVHJlZU1hcDxDb21wb3VuZEtleSwgamF2YS51
dGlsLkxpc3Q8SURhdGE+PigpOwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7
IGkrKykgewogICAgICBpZiAobGlzdFtpXSAhPSBudWxsKSB7CiAgICAgICAgQ29tcG91bmRLZXkg
a2V5ID0gbmV3IENvbXBvdW5kS2V5KGtleXMsIGxpc3RbaV0pOwogICAgICAgIGphdmEudXRpbC5M
aXN0PElEYXRhPiBhcnJheSA9IGdyb3Vwcy5nZXQoa2V5KTsKICAgICAgICBpZiAoYXJyYXkgPT0g
bnVsbCkgYXJyYXkgPSBuZXcgamF2YS51dGlsLkxpbmtlZExpc3Q8SURhdGE+KCk7CiAgICAgICAg
YXJyYXkuYWRkKGxpc3RbaV0pOwogICAgICAgIGdyb3Vwcy5wdXQoa2V5LCBhcnJheSk7CiAgICAg
IH0KICAgIH0KCiAgICBqYXZhLnV0aWwuTGlzdDxJRGF0YT4gcmVzdWx0ID0gbmV3IGphdmEudXRp
bC5BcnJheUxpc3Q8SURhdGE+KGdyb3Vwcy5zaXplKCkpOwogICAgamF2YS51dGlsLkl0ZXJhdG9y
PENvbXBvdW5kS2V5PiBpdGVyYXRvciA9IGdyb3Vwcy5rZXlTZXQoKS5pdGVyYXRvcigpOwoKICAg
IHdoaWxlKGl0ZXJhdG9yLmhhc05leHQoKSkgewogICAgICBDb21wb3VuZEtleSBrZXkgPSBpdGVy
YXRvci5uZXh0KCk7CiAgICAgIGphdmEudXRpbC5MaXN0PElEYXRhPiBpdGVtcyA9IGdyb3Vwcy5n
ZXQoa2V5KTsKCiAgICAgIElEYXRhIGdyb3VwID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAg
ICBJRGF0YUN1cnNvciBjdXJzb3IgPSBncm91cC5nZXRDdXJzb3IoKTsKICAgICAgSURhdGFVdGls
LnB1dChjdXJzb3IsICJncm91cCIsIGtleS5nZXRJRGF0YSgpKTsKICAgICAgSURhdGFVdGlsLnB1
dChjdXJzb3IsICJpdGVtcyIsIChJRGF0YVtdKWl0ZW1zLnRvQXJyYXkobmV3IElEYXRhWzBdKSk7
CiAgICAgIGN1cnNvci5kZXN0cm95KCk7CgogICAgICByZXN1bHQuYWRkKGdyb3VwKTsKICAgIH0K
ICAgIHJldHVybiAoSURhdGFbXSlyZXN1bHQudG9BcnJheShuZXcgSURhdGFbMF0pOwogIH0KfQoK
cHVibGljIHN0YXRpYyBjbGFzcyBDb21wb3VuZEtleSBleHRlbmRzIGphdmEudXRpbC5MaW5rZWRI
YXNoTWFwPFN0cmluZywgQ29tcGFyYWJsZT4gaW1wbGVtZW50cyBDb21wYXJhYmxlPENvbXBvdW5k
S2V5PiwgY29tLndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxlIHsKICBwdWJsaWMgQ29tcG91bmRL
ZXkoKSB7CiAgICBzdXBlcigpOwogIH0KCiAgcHVibGljIENvbXBvdW5kS2V5KGludCBpbml0aWFs
Q2FwYWNpdHkpIHsKICAgIHN1cGVyKGluaXRpYWxDYXBhY2l0eSk7CiAgfQoKICBwdWJsaWMgQ29t
cG91bmRLZXkoaW50IGluaXRpYWxDYXBhY2l0eSwgZmxvYXQgbG9hZEZhY3RvcikgewogICAgc3Vw
ZXIoaW5pdGlhbENhcGFjaXR5LCBsb2FkRmFjdG9yKTsKICB9CgogIHB1YmxpYyBDb21wb3VuZEtl
eShpbnQgaW5pdGlhbENhcGFjaXR5LCBmbG9hdCBsb2FkRmFjdG9yLCBib29sZWFuIGFjY2Vzc09y
ZGVyKSB7CiAgICBzdXBlcihpbml0aWFsQ2FwYWNpdHksIGxvYWRGYWN0b3IsIGFjY2Vzc09yZGVy
KTsKICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShqYXZhLnV0aWwuTWFwPD8gZXh0ZW5kcyBTdHJp
bmcsPyBleHRlbmRzIENvbXBhcmFibGU+IG1hcCkgewogICAgc3VwZXIobWFwKTsKICB9CgogIHB1
YmxpYyBDb21wb3VuZEtleShTdHJpbmdbXSBrZXlzLCBJRGF0YSBkb2N1bWVudCkgewogICAgc3Vw
ZXIoa2V5cy5sZW5ndGgpOwogICAgCiAgICAvLyBzZWVkIHdpdGgga2V5IHZhbHVlIHBhaXJzCiAg
ICBmb3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0IHZh
bHVlID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsKICAg
ICAgaWYgKHZhbHVlICE9IG51bGwgJiYgdmFsdWUgaW5zdGFuY2VvZiBDb21wYXJhYmxlKSB7CiAg
ICAgICAgdGhpcy5wdXQoa2V5c1tpXSwgKENvbXBhcmFibGUpdmFsdWUpOwogICAgICB9IGVsc2Ug
ewogICAgICAgIHRoaXMucHV0KGtleXNbaV0sIG51bGwpOwogICAgICB9CiAgICB9ICAgIAogIH0K
CiAgcHVibGljIGludCBjb21wYXJlVG8oQ29tcG91bmRLZXkgb3RoZXIpIHsKICAgIGlmIChvdGhl
ciA9PSBudWxsKSByZXR1cm4gMTsKCiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIAogICAgamF2YS51
dGlsLkl0ZXJhdG9yPFN0cmluZz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJhdG9yKCk7
CgogICAgd2hpbGUoaXRlcmF0b3IuaGFzTmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkgPSBpdGVy
YXRvci5uZXh0KCk7CiAgICAgIENvbXBhcmFibGUgdGhpc1ZhbHVlID0gdGhpcy5nZXQoa2V5KTsK
ICAgICAgQ29tcGFyYWJsZSBvdGhlclZhbHVlID0gb3RoZXIuZ2V0KGtleSk7CgogICAgICBpZiAo
dGhpc1ZhbHVlID09IG51bGwpIHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSAhPSBudWxsKSByZXN1
bHQgPSAtMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSA9PSBudWxsKSB7
CiAgICAgICAgICByZXN1bHQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQg
PSB0aGlzVmFsdWUuY29tcGFyZVRvKG90aGVyVmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAg
ICBpZiAocmVzdWx0ICE9IDApIGJyZWFrOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9Cgog
IHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgIGJvb2xlYW4gcmVzdWx0
ID0gZmFsc2U7CgogICAgaWYgKG90aGVyICE9IG51bGwgJiYgb3RoZXIgaW5zdGFuY2VvZiBDb21w
b3VuZEtleSkgewogICAgICByZXN1bHQgPSB0aGlzLmNvbXBhcmVUbygoQ29tcG91bmRLZXkpb3Ro
ZXIpID09IDA7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgcHVibGljIElEYXRhIGdl
dElEYXRhKCkgewogICAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAg
amF2YS51dGlsLkl0ZXJhdG9yPFN0cmluZz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJh
dG9yKCk7CiAgICB3aGlsZShpdGVyYXRvci5oYXNOZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9
IGl0ZXJhdG9yLm5leHQoKTsKICAgICAgT2JqZWN0IHZhbHVlID0gdGhpcy5nZXQoa2V5KTsKICAg
ICAgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCB2YWx1ZSk7CiAgICB9
CiAgICByZXR1cm4gb3V0cHV0OwogIH0KCiAgcHVibGljIHZvaWQgc2V0SURhdGEoSURhdGEgaW5w
dXQpIHsKICAgIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm47CgogICAgdGhpcy5jbGVhcigpOwoK
ICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgd2hpbGUoY3Vy
c29yLm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICBP
YmplY3QgdmFsdWUgPSBjdXJzb3IuZ2V0VmFsdWUoKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxs
ICYmIHZhbHVlIGluc3RhbmNlb2YgQ29tcGFyYWJsZSkgdGhpcy5wdXQoa2V5LCAoQ29tcGFyYWJs
ZSl2YWx1ZSk7CiAgICB9CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KfQoKLy8gcmV0dXJucyB0
aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gZWFjaCBpdGVtIGlu
IHRoZSBnaXZlbiBJRGF0YVtdIGRvY3VtZW50IGxpc3QKcHVibGljIHN0YXRpYyBPYmplY3RbXSB2
YWx1ZXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIGtleSwgT2JqZWN0IGRlZmF1bHRWYWx1ZSkgewog
IGlmIChpbnB1dCA9PSBudWxsIHx8IGtleSA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgamF2YS51
dGlsLlNldDxDbGFzczw/Pj4gY2xhc3NlcyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxD
bGFzczw/Pj4oKTsKICBqYXZhLnV0aWwuTGlzdCBsaXN0ID0gbmV3IGphdmEudXRpbC5BcnJheUxp
c3QoaW5wdXQubGVuZ3RoKTsKICAKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsg
aSsrKSB7CiAgICBPYmplY3QgdmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaW5w
dXRbaV0sIGtleSwgZGVmYXVsdFZhbHVlKTsKICAgIGlmICh2YWx1ZSAhPSBudWxsKSBjbGFzc2Vz
LmFkZCh2YWx1ZS5nZXRDbGFzcygpKTsKICAgIGxpc3QuYWRkKHZhbHVlKTsKICB9CiAgCiAgQ2xh
c3M8Pz4gbmVhcmVzdEFuY2VzdG9yID0gdHVuZHJhLnN1cHBvcnQub2JqZWN0Lm5lYXJlc3RBbmNl
c3RvcihjbGFzc2VzKTsKICBpZiAobmVhcmVzdEFuY2VzdG9yID09IG51bGwpIG5lYXJlc3RBbmNl
c3RvciA9IE9iamVjdC5jbGFzczsKICAKICByZXR1cm4gbGlzdC50b0FycmF5KChPYmplY3RbXSlq
YXZhLmxhbmcucmVmbGVjdC5BcnJheS5uZXdJbnN0YW5jZShuZWFyZXN0QW5jZXN0b3IsIDApKTsK
fQo=</value>
  <value name="encodeutf8">true</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
