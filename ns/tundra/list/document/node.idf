<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.list.document</value>
  <value name="shared">Ly8gcmV0dXJucyBhIG5ldyBJRGF0YVtdIHdpdGggYWxsIG51bGwgdmFsdWVzIHJlbW92ZWQKcHVi
bGljIHN0YXRpYyBJRGF0YVtdIGNvbXBhY3QoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJh
eTsKCiAgLy8gdGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFs
bHkgYW4gSURhdGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFi
bGUgdG8gc3RvcmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElE
YXRhW10pamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJ
RGF0YVswXSkuZ2V0Q2xhc3MoKSk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3Ro
OyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9IHR1bmRyYS5kb2N1
bWVudC5jb21wYWN0KGFycmF5W2ldLCByZWN1cnNlKTsKICB9CgogIHJldHVybiB0dW5kcmEubGlz
dC5vYmplY3QuY29tcGFjdChhcnJheSk7Cn0KCi8vIHJldHVybnMgdGhlIHVuaW9uIHNldCBvZiBr
ZXlzIHByZXNlbnQgaW4gZXZlcnkgaXRlbSBpbiB0aGUgZ2l2ZW4KLy8gSURhdGFbXSBkb2N1bWVu
dCBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5cyhJRGF0YVtdIGlucHV0KSB7CiAgcmV0
dXJuIGtleXMoaW5wdXQsIG51bGwpOwp9CgovLyByZXR1cm5zIHRoZSB1bmlvbiBzZXQgb2Yga2V5
cyBwcmVzZW50IGluIGV2ZXJ5IGl0ZW0gaW4gdGhlIGdpdmVuCi8vIElEYXRhW10gZG9jdW1lbnQg
bGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIHBh
dHRlcm5TdHJpbmcpIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwYXR0ZXJuID0gbnVsbDsK
ICBpZiAocGF0dGVyblN0cmluZyAhPSBudWxsKSBwYXR0ZXJuID0gamF2YS51dGlsLnJlZ2V4LlBh
dHRlcm4uY29tcGlsZShwYXR0ZXJuU3RyaW5nKTsKICAKICBqYXZhLnV0aWwuU2V0PFN0cmluZz4g
a2V5cyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxTdHJpbmc+KCk7CgogIGlmIChpbnB1
dCAhPSBudWxsKSB7CiAgICBmb3IgKElEYXRhIGRvY3VtZW50IDogaW5wdXQpIHsKICAgICAgaWYg
KGRvY3VtZW50ICE9IG51bGwpIHsKICAgICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBkb2N1bWVu
dC5nZXRDdXJzb3IoKTsKICAgICAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgICAgICBT
dHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICAgICAgCiAgICAgICAgICBpZiAocGF0
dGVybiA9PSBudWxsKSB7CiAgICAgICAgICAgIGtleXMuYWRkKGtleSk7CiAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICBqYXZhLnV0aWwucmVnZXguTWF0Y2hlciBtYXRjaGVyID0gcGF0dGVy
bi5tYXRjaGVyKGtleSk7CiAgICAgICAgICAgIGlmIChtYXRjaGVyLm1hdGNoZXMoKSkga2V5cy5h
ZGQoa2V5KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3Vyc29yLmRlc3Ryb3koKTsg
ICAgIAogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4ga2V5cy50b0FycmF5KG5ldyBTdHJpbmdb
MF0pOwp9CgovLyByZXR1cm5zIGFuIElEYXRhIGRvY3VtZW50IHdoZXJlIHRoZSBrZXlzIGFyZSB0
aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aAovLyBnaXZlbiBwaXZvdCBrZXkgZnJvbSB0aGUgZ2l2
ZW4gSURhdGFbXSBkb2N1bWVudCBsaXN0LCBhbmQgdGhlIHZhbHVlcyBhcmUKLy8gdGhlIElEYXRh
W10gZG9jdW1lbnQgbGlzdCBpdGVtcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBwaXZvdCBrZXkKcHVi
bGljIHN0YXRpYyBJRGF0YSBwaXZvdChJRGF0YVtdIGFycmF5LCBTdHJpbmcgcGl2b3RLZXkpIHsK
ICByZXR1cm4gcGl2b3QoYXJyYXksIG51bGwsIHBpdm90S2V5KTsKfQoKLy8gcmV0dXJucyBhbiBJ
RGF0YSBkb2N1bWVudCB3aGVyZSB0aGUga2V5cyBhcmUgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdp
dGgKLy8gZ2l2ZW4gcGl2b3Qga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhW10gZG9jdW1lbnQgbGlz
dCwgYW5kIHRoZSB2YWx1ZXMgYXJlCi8vIHRoZSBJRGF0YVtdIGRvY3VtZW50IGxpc3QgaXRlbXMg
YXNzb2NpYXRlZCB3aXRoIGVhY2ggcGl2b3Qga2V5CnB1YmxpYyBzdGF0aWMgSURhdGEgcGl2b3Qo
SURhdGFbXSBhcnJheSwgU3RyaW5nIGRlbGltaXRlciwgU3RyaW5nIC4uLiBwaXZvdEtleXMpIHsK
ICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBwaXZvdEtleXMgPT0gbnVsbCB8fCBwaXZvdEtleXMubGVu
Z3RoID09IDApIHJldHVybiBudWxsOwogIGlmIChkZWxpbWl0ZXIgPT0gbnVsbCkgZGVsaW1pdGVy
ID0gIi8iOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CgogIG91dGVy
OgogIGZvciAoSURhdGEgaXRlbSA6IGFycmF5KSB7CiAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAg
ICAgIFN0cmluZ0J1aWxkZXIgYnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBwaXZvdEtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBPYmplY3Qg
dmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaXRlbSwgcGl2b3RLZXlzW2ldKTsK
ICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgY29udGludWUgb3V0ZXI7CiAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJ1ZmZlci5hcHBlbmQodmFsdWUudG9TdHJpbmcoKSk7
CiAgICAgICAgfQogICAgICAgIGlmIChpIDwgKHBpdm90S2V5cy5sZW5ndGggLSAxKSkgYnVmZmVy
LmFwcGVuZChkZWxpbWl0ZXIpOwogICAgICB9CiAgICAgIFN0cmluZyBrZXkgPSBidWZmZXIudG9T
dHJpbmcoKTsKICAgICAgaWYgKHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LmdldChvdXRwdXQsIGtl
eSkgPT0gbnVsbCkgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCBpdGVt
KTsKICAgIH0KICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJldHVybnMgYSBuZXcgYXJyYXkg
d2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGluIGFzY2VuZGluZyBvcmRlciBieQovLyB0aGUgdmFs
dWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5CnB1YmxpYyBzdGF0aWMgSURhdGFbXSBz
b3J0KElEYXRhW10gYXJyYXksIFN0cmluZyBrZXkpIHsKICByZXR1cm4gc29ydChhcnJheSwga2V5
LCB0cnVlKTsKfQoKLy8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0
ZWQgZWl0aGVyIGluIGFzY2VuZGluZyBvcgovLyBkZXNjZW5kaW5nIG9yZGVyIGJ5IHRoZSB2YWx1
ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBrZXkKcHVibGljIHN0YXRpYyBJRGF0YVtdIHNv
cnQoSURhdGFbXSBhcnJheSwgU3RyaW5nIGtleSwgYm9vbGVhbiBhc2NlbmRpbmcpIHsKICBTdHJp
bmdbXSBrZXlzID0gbnVsbDsKICBpZiAoa2V5ICE9IG51bGwpIHsKICAgIGtleXMgPSBuZXcgU3Ry
aW5nWzFdOwogICAga2V5c1swXSA9IGtleTsKICB9CgogIHJldHVybiBzb3J0KGFycmF5LCBrZXlz
LCBhc2NlbmRpbmcpOwp9CgovLyByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIGVsZW1lbnRz
IHNvcnRlZCBpbiBhc2NlbmRpbmcgb3JkZXIgYnkgdGhlIAovLyB2YWx1ZXMgYXNzb2NpYXRlZCB3
aXRoIHRoZSBnaXZlbiBrZXlzCnB1YmxpYyBzdGF0aWMgSURhdGFbXSBzb3J0KElEYXRhW10gYXJy
YXksIFN0cmluZ1tdIGtleXMpIHsKICByZXR1cm4gc29ydChhcnJheSwga2V5cywgdHJ1ZSk7Cn0K
Ci8vIHJldHVybnMgYSBuZXcgYXJyYXkgd2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGJ5IHRoZSB2
YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIAovLyB0aGUgZ2l2ZW4ga2V5cwpwdWJsaWMgc3RhdGljIElE
YXRhW10gc29ydChJRGF0YVtdIGFycmF5LCBTdHJpbmdbXSBrZXlzLCBib29sZWFuIGFzY2VuZGlu
ZykgewogIGlmIChhcnJheSA9PSBudWxsIHx8IGFycmF5Lmxlbmd0aCA8IDIgfHwga2V5cyA9PSBu
dWxsIHx8IGtleXMubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgSURhdGFbXSBzb3J0S2V5
cyA9IG5ldyBJRGF0YVtrZXlzLmxlbmd0aF07CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBrZXlzLmxl
bmd0aDsgaSsrKSB7CiAgICBzb3J0S2V5c1tpXSA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAg
IElEYXRhQ3Vyc29yIGN1cnNvciA9IHNvcnRLZXlzW2ldLmdldEN1cnNvcigpOwogICAgSURhdGFV
dGlsLnB1dChjdXJzb3IsICJrZXkiLCBrZXlzW2ldKTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29y
LCAiZGVzY2VuZGluZz8iLCAiIiArICFhc2NlbmRpbmcpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsK
ICB9CgogIHJldHVybiBzb3J0KGFycmF5LCBzb3J0S2V5cyk7Cn0KCi8vIHJldHVybnMgYSBuZXcg
YXJyYXkgd2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGJ5IHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3
aXRoIAovLyB0aGUgZ2l2ZW4ga2V5cwpwdWJsaWMgc3RhdGljIElEYXRhW10gc29ydChJRGF0YVtd
IGFycmF5LCBJRGF0YVtdIGNyaXRlcmlhKSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXku
bGVuZ3RoIDwgMiB8fCBjcml0ZXJpYSA9PSBudWxsIHx8IGNyaXRlcmlhLmxlbmd0aCA9PSAwKSBy
ZXR1cm4gYXJyYXk7CgogIGFycmF5ID0gamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFy
cmF5Lmxlbmd0aCk7CiAgamF2YS51dGlsLkFycmF5cy5zb3J0KGFycmF5LCBuZXcgSURhdGFDb21w
YXJhdG9yKGNyaXRlcmlhKSk7CgogIHJldHVybiBhcnJheTsKfQoKLy8gcmV0dXJucyBhIG5ldyBJ
RGF0YVtdIHdpdGggYWxsIGVtcHR5IGFuZCBudWxsIGl0ZW1zIHJlbW92ZWQKcHVibGljIHN0YXRp
YyBJRGF0YVtdIHNxdWVlemUoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYg
KGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgLy8g
dGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFsbHkgYW4gSURh
dGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFibGUgdG8gc3Rv
cmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElEYXRhW10pamF2
YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJRGF0YVswXSku
Z2V0Q2xhc3MoKSk7CgogIGphdmEudXRpbC5MaXN0PElEYXRhPiBsaXN0ID0gbmV3IGphdmEudXRp
bC5BcnJheUxpc3Q8SURhdGE+KGFycmF5Lmxlbmd0aCk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwg
YXJyYXkubGVuZ3RoOyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9
IHR1bmRyYS5kb2N1bWVudC5zcXVlZXplKGFycmF5W2ldLCByZWN1cnNlKTsKICAgIGlmIChhcnJh
eVtpXSAhPSBudWxsKSBsaXN0LmFkZChhcnJheVtpXSk7CiAgfQoKICBhcnJheSA9IGxpc3QudG9B
cnJheShuZXcgSURhdGFbMF0pOwogIGlmIChhcnJheS5sZW5ndGggPT0gMCkgYXJyYXkgPSBudWxs
OwoKICByZXR1cm4gYXJyYXk7Cn0KCi8vIGNvbXBhcmVzIHR3byBJRGF0YSBvYmplY3RzIHVzaW5n
IHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBsaXN0Ci8vIG9mIGtleXMKcHVi
bGljIHN0YXRpYyBjbGFzcyBJRGF0YUNvbXBhcmF0b3IgaW1wbGVtZW50cyBqYXZhLnV0aWwuQ29t
cGFyYXRvcjxJRGF0YT4gewogIHByb3RlY3RlZCBJRGF0YVtdIGNyaXRlcmlhOwoKICBwdWJsaWMg
SURhdGFDb21wYXJhdG9yKElEYXRhW10gY3JpdGVyaWEpIHsKICAgIHRoaXMuY3JpdGVyaWEgPSBj
cml0ZXJpYTsKICB9CgogIHByb3RlY3RlZCBzdGF0aWMgaW50IG5vcm1hbGl6ZShpbnQgcmVzdWx0
LCBib29sZWFuIGRlc2NlbmRpbmcpIHsKICAgIGlmIChkZXNjZW5kaW5nKSB7CiAgICAgIGlmIChy
ZXN1bHQgPCAwKSB7CiAgICAgICAgcmVzdWx0ID0gMTsKICAgICAgfSBlbHNlIGlmIChyZXN1bHQg
PiAwKSB7CiAgICAgICAgcmVzdWx0ID0gLTE7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1
bHQ7CiAgfQoKICBwdWJsaWMgaW50IGNvbXBhcmUoSURhdGEgYSwgSURhdGEgYikgewogICAgaW50
IHJlc3VsdCA9IDA7CiAgICBmb3IgKElEYXRhIGl0ZW0gOiBjcml0ZXJpYSkgewogICAgICBJRGF0
YUN1cnNvciBjdXJzb3IgPSBpdGVtLmdldEN1cnNvcigpOwogICAgICBTdHJpbmcga2V5ID0gSURh
dGFVdGlsLmdldFN0cmluZyhjdXJzb3IsICJrZXkiKTsKICAgICAgU3RyaW5nIHR5cGUgPSBJRGF0
YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInR5cGUiKTsKICAgICAgU3RyaW5nIHBhdHRlcm4gPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInBhdHRlcm4iKTsKICAgICAgYm9vbGVhbiBkZXNj
ZW5kaW5nID0gdHVuZHJhLmJvb2wucGFyc2UoSURhdGFVdGlsLmdldFN0cmluZyhjdXJzb3IsICJk
ZXNjZW5kaW5nPyIpKTsKICAgICAgY3Vyc29yLmRlc3Ryb3koKTsKCiAgICAgIE9iamVjdCB2YWx1
ZV9hID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGEsIGtleSk7CiAgICAgIE9iamVjdCB2
YWx1ZV9iID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGIsIGtleSk7CgogICAgICBpZiAo
dmFsdWVfYSA9PSBudWxsKSB7CiAgICAgICAgaWYgKHZhbHVlX2IgIT0gbnVsbCkgewogICAgICAg
ICAgcmVzdWx0ID0gbm9ybWFsaXplKC0xLCBkZXNjZW5kaW5nKTsKICAgICAgICAgIGJyZWFrOwog
ICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh2YWx1ZV9iID09IG51bGwpIHsKICAgICAgICBpZiAo
dmFsdWVfYSAhPSBudWxsKSB7CiAgICAgICAgICByZXN1bHQgPSBub3JtYWxpemUoMSwgZGVzY2Vu
ZGluZyk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
aWYgKHR5cGUgIT0gbnVsbCkgewogICAgICAgICAgdmFsdWVfYSA9IHZhbHVlX2EudG9TdHJpbmco
KTsKICAgICAgICAgIHZhbHVlX2IgPSB2YWx1ZV9iLnRvU3RyaW5nKCk7CiAgICAgICAgICBpZiAo
dHlwZS5lcXVhbHMoImludGVnZXIiKSkgewogICAgICAgICAgICB2YWx1ZV9hID0gdHVuZHJhLmlu
dGVnZXIucGFyc2UoKFN0cmluZyl2YWx1ZV9hKTsKICAgICAgICAgICAgdmFsdWVfYiA9IHR1bmRy
YS5pbnRlZ2VyLnBhcnNlKChTdHJpbmcpdmFsdWVfYik7CiAgICAgICAgICB9IGVsc2UgaWYgKHR5
cGUuZXF1YWxzKCJkZWNpbWFsIikpIHsKICAgICAgICAgICAgdmFsdWVfYSA9IHR1bmRyYS5kZWNp
bWFsLnBhcnNlKChTdHJpbmcpdmFsdWVfYSk7CiAgICAgICAgICAgIHZhbHVlX2IgPSB0dW5kcmEu
ZGVjaW1hbC5wYXJzZSgoU3RyaW5nKXZhbHVlX2IpOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBl
LmVxdWFscygiZGF0ZXRpbWUiKSkgewogICAgICAgICAgICB2YWx1ZV9hID0gdHVuZHJhLmRhdGV0
aW1lLnBhcnNlKChTdHJpbmcpdmFsdWVfYSwgcGF0dGVybik7CiAgICAgICAgICAgIHZhbHVlX2Ig
PSB0dW5kcmEuZGF0ZXRpbWUucGFyc2UoKFN0cmluZyl2YWx1ZV9iLCBwYXR0ZXJuKTsKICAgICAg
ICAgIH0gZWxzZSBpZiAodHlwZS5lcXVhbHMoImR1cmF0aW9uIikpIHsKICAgICAgICAgICAgdmFs
dWVfYSA9IHR1bmRyYS5pbnRlZ2VyLnBhcnNlKHR1bmRyYS5kdXJhdGlvbi5mb3JtYXQoKFN0cmlu
Zyl2YWx1ZV9hLCBwYXR0ZXJuLCAibWlsbGlzZWNvbmRzIikpOwogICAgICAgICAgICB2YWx1ZV9i
ID0gdHVuZHJhLmludGVnZXIucGFyc2UodHVuZHJhLmR1cmF0aW9uLmZvcm1hdCgoU3RyaW5nKXZh
bHVlX2IsIHBhdHRlcm4sICJtaWxsaXNlY29uZHMiKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoK
ICAgICAgICBpZiAodmFsdWVfYSBpbnN0YW5jZW9mIENvbXBhcmFibGUgJiYgdmFsdWVfYiBpbnN0
YW5jZW9mIENvbXBhcmFibGUpIHsKICAgICAgICAgIHJlc3VsdCA9IG5vcm1hbGl6ZSgoKENvbXBh
cmFibGUpdmFsdWVfYSkuY29tcGFyZVRvKChDb21wYXJhYmxlKXZhbHVlX2IpLCBkZXNjZW5kaW5n
KTsKICAgICAgICAgIGlmIChyZXN1bHQgIT0gMCkgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAg
ICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KfQoKLy8gZ3JvdXBzIHRoZSBnaXZlbiBsaXN0IGJ5
IHRoZSBnaXZlbiBrZXlzCnB1YmxpYyBzdGF0aWMgSURhdGFbXSBncm91cChJRGF0YVtdIGxpc3Qs
IFN0cmluZ1tdIGtleXMpIHsKICBpZiAobGlzdCA9PSBudWxsIHx8IGxpc3QubGVuZ3RoID09IDAp
IHJldHVybiBsaXN0OwoKICBpZiAoa2V5cyA9PSBudWxsIHx8IGtleXMubGVuZ3RoID09IDApIHsK
ICAgIElEYXRhW10gcmVzdWx0ID0gbmV3IElEYXRhWzFdOwogICAgcmVzdWx0WzBdID0gSURhdGFG
YWN0b3J5LmNyZWF0ZSgpOwogICAgSURhdGFDdXJzb3IgY3Vyc29yID0gcmVzdWx0WzBdLmdldEN1
cnNvcigpOwogICAgSURhdGFVdGlsLnB1dChjdXJzb3IsICJncm91cCIsIElEYXRhRmFjdG9yeS5j
cmVhdGUoKSk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgIml0ZW1zIiwgbGlzdCk7CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogICAgcmV0dXJuIHJlc3VsdDsKICB9IGVsc2UgewogICAgamF2YS51
dGlsLk1hcDxDb21wb3VuZEtleSwgamF2YS51dGlsLkxpc3Q8SURhdGE+PiBncm91cHMgPSBuZXcg
amF2YS51dGlsLlRyZWVNYXA8Q29tcG91bmRLZXksIGphdmEudXRpbC5MaXN0PElEYXRhPj4oKTsK
CiAgICBmb3IgKGludCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGxp
c3RbaV0gIT0gbnVsbCkgewogICAgICAgIENvbXBvdW5kS2V5IGtleSA9IG5ldyBDb21wb3VuZEtl
eShrZXlzLCBsaXN0W2ldKTsKICAgICAgICBqYXZhLnV0aWwuTGlzdDxJRGF0YT4gYXJyYXkgPSBn
cm91cHMuZ2V0KGtleSk7CiAgICAgICAgaWYgKGFycmF5ID09IG51bGwpIGFycmF5ID0gbmV3IGph
dmEudXRpbC5MaW5rZWRMaXN0PElEYXRhPigpOwogICAgICAgIGFycmF5LmFkZChsaXN0W2ldKTsK
ICAgICAgICBncm91cHMucHV0KGtleSwgYXJyYXkpOwogICAgICB9CiAgICB9CgogICAgamF2YS51
dGlsLkxpc3Q8SURhdGE+IHJlc3VsdCA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0PElEYXRhPihn
cm91cHMuc2l6ZSgpKTsKICAgIGphdmEudXRpbC5JdGVyYXRvcjxDb21wb3VuZEtleT4gaXRlcmF0
b3IgPSBncm91cHMua2V5U2V0KCkuaXRlcmF0b3IoKTsKCiAgICB3aGlsZShpdGVyYXRvci5oYXNO
ZXh0KCkpIHsKICAgICAgQ29tcG91bmRLZXkga2V5ID0gaXRlcmF0b3IubmV4dCgpOwogICAgICBq
YXZhLnV0aWwuTGlzdDxJRGF0YT4gaXRlbXMgPSBncm91cHMuZ2V0KGtleSk7CgogICAgICBJRGF0
YSBncm91cCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgICAgSURhdGFDdXJzb3IgY3Vyc29y
ID0gZ3JvdXAuZ2V0Q3Vyc29yKCk7CiAgICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCAiZ3JvdXAi
LCBrZXkuZ2V0SURhdGEoKSk7CiAgICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCAiaXRlbXMiLCAo
SURhdGFbXSlpdGVtcy50b0FycmF5KG5ldyBJRGF0YVswXSkpOwogICAgICBjdXJzb3IuZGVzdHJv
eSgpOwoKICAgICAgcmVzdWx0LmFkZChncm91cCk7CiAgICB9CiAgICByZXR1cm4gKElEYXRhW10p
cmVzdWx0LnRvQXJyYXkobmV3IElEYXRhWzBdKTsKICB9Cn0KCnB1YmxpYyBzdGF0aWMgY2xhc3Mg
Q29tcG91bmRLZXkgZXh0ZW5kcyBqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDxTdHJpbmcsIENvbXBh
cmFibGU+IGltcGxlbWVudHMgQ29tcGFyYWJsZTxDb21wb3VuZEtleT4sIGNvbS53bS51dGlsLmNv
ZGVyLklEYXRhQ29kYWJsZSB7CiAgcHVibGljIENvbXBvdW5kS2V5KCkgewogICAgc3VwZXIoKTsK
ICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShpbnQgaW5pdGlhbENhcGFjaXR5KSB7CiAgICBzdXBl
cihpbml0aWFsQ2FwYWNpdHkpOwogIH0KCiAgcHVibGljIENvbXBvdW5kS2V5KGludCBpbml0aWFs
Q2FwYWNpdHksIGZsb2F0IGxvYWRGYWN0b3IpIHsKICAgIHN1cGVyKGluaXRpYWxDYXBhY2l0eSwg
bG9hZEZhY3Rvcik7CiAgfQoKICBwdWJsaWMgQ29tcG91bmRLZXkoaW50IGluaXRpYWxDYXBhY2l0
eSwgZmxvYXQgbG9hZEZhY3RvciwgYm9vbGVhbiBhY2Nlc3NPcmRlcikgewogICAgc3VwZXIoaW5p
dGlhbENhcGFjaXR5LCBsb2FkRmFjdG9yLCBhY2Nlc3NPcmRlcik7CiAgfQoKICBwdWJsaWMgQ29t
cG91bmRLZXkoamF2YS51dGlsLk1hcDw/IGV4dGVuZHMgU3RyaW5nLD8gZXh0ZW5kcyBDb21wYXJh
YmxlPiBtYXApIHsKICAgIHN1cGVyKG1hcCk7CiAgfQoKICBwdWJsaWMgQ29tcG91bmRLZXkoU3Ry
aW5nW10ga2V5cywgSURhdGEgZG9jdW1lbnQpIHsKICAgIHN1cGVyKGtleXMubGVuZ3RoKTsKICAg
IAogICAgLy8gc2VlZCB3aXRoIGtleSB2YWx1ZSBwYWlycwogICAgZm9yIChpbnQgaSA9IDA7IGkg
PCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIE9iamVjdCB2YWx1ZSA9IHR1bmRyYS5zdXBwb3J0
LmRvY3VtZW50LmdldChkb2N1bWVudCwga2V5c1tpXSk7CiAgICAgIGlmICh2YWx1ZSAhPSBudWxs
ICYmIHZhbHVlIGluc3RhbmNlb2YgQ29tcGFyYWJsZSkgewogICAgICAgIHRoaXMucHV0KGtleXNb
aV0sIChDb21wYXJhYmxlKXZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnB1dChr
ZXlzW2ldLCBudWxsKTsKICAgICAgfQogICAgfSAgICAKICB9CgogIHB1YmxpYyBpbnQgY29tcGFy
ZVRvKENvbXBvdW5kS2V5IG90aGVyKSB7CiAgICBpZiAob3RoZXIgPT0gbnVsbCkgcmV0dXJuIDE7
CgogICAgaW50IHJlc3VsdCA9IDA7CiAgICAKICAgIGphdmEudXRpbC5JdGVyYXRvcjxTdHJpbmc+
IGl0ZXJhdG9yID0gdGhpcy5rZXlTZXQoKS5pdGVyYXRvcigpOwoKICAgIHdoaWxlKGl0ZXJhdG9y
Lmhhc05leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaXRlcmF0b3IubmV4dCgpOwogICAgICBD
b21wYXJhYmxlIHRoaXNWYWx1ZSA9IHRoaXMuZ2V0KGtleSk7CiAgICAgIENvbXBhcmFibGUgb3Ro
ZXJWYWx1ZSA9IG90aGVyLmdldChrZXkpOwoKICAgICAgaWYgKHRoaXNWYWx1ZSA9PSBudWxsKSB7
CiAgICAgICAgaWYgKG90aGVyVmFsdWUgIT0gbnVsbCkgcmVzdWx0ID0gLTE7CiAgICAgIH0gZWxz
ZSB7CiAgICAgICAgaWYgKG90aGVyVmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgcmVzdWx0ID0g
MTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gdGhpc1ZhbHVlLmNvbXBhcmVU
byhvdGhlclZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHJlc3VsdCAhPSAwKSBi
cmVhazsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQoKICBwdWJsaWMgYm9vbGVhbiBlcXVh
bHMoT2JqZWN0IG90aGVyKSB7CiAgICBib29sZWFuIHJlc3VsdCA9IGZhbHNlOwoKICAgIGlmIChv
dGhlciAhPSBudWxsICYmIG90aGVyIGluc3RhbmNlb2YgQ29tcG91bmRLZXkpIHsKICAgICAgcmVz
dWx0ID0gdGhpcy5jb21wYXJlVG8oKENvbXBvdW5kS2V5KW90aGVyKSA9PSAwOwogICAgfQogICAg
cmV0dXJuIHJlc3VsdDsKICB9CgogIHB1YmxpYyBJRGF0YSBnZXRJRGF0YSgpIHsKICAgIElEYXRh
IG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgIGphdmEudXRpbC5JdGVyYXRvcjxT
dHJpbmc+IGl0ZXJhdG9yID0gdGhpcy5rZXlTZXQoKS5pdGVyYXRvcigpOwogICAgd2hpbGUoaXRl
cmF0b3IuaGFzTmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkgPSBpdGVyYXRvci5uZXh0KCk7CiAg
ICAgIE9iamVjdCB2YWx1ZSA9IHRoaXMuZ2V0KGtleSk7CiAgICAgIHR1bmRyYS5zdXBwb3J0LmRv
Y3VtZW50LnB1dChvdXRwdXQsIGtleSwgdmFsdWUpOwogICAgfQogICAgcmV0dXJuIG91dHB1dDsK
ICB9CgogIHB1YmxpYyB2b2lkIHNldElEYXRhKElEYXRhIGlucHV0KSB7CiAgICBpZiAoaW5wdXQg
PT0gbnVsbCkgcmV0dXJuOwoKICAgIHRoaXMuY2xlYXIoKTsKCiAgICBJRGF0YUN1cnNvciBjdXJz
b3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAg
U3RyaW5nIGtleSA9IGN1cnNvci5nZXRLZXkoKTsKICAgICAgT2JqZWN0IHZhbHVlID0gY3Vyc29y
LmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSBpbnN0YW5jZW9m
IENvbXBhcmFibGUpIHRoaXMucHV0KGtleSwgKENvbXBhcmFibGUpdmFsdWUpOwogICAgfQogICAg
Y3Vyc29yLmRlc3Ryb3koKTsKICB9Cn0KCi8vIHJldHVybnMgdGhlIHZhbHVlcyBhc3NvY2lhdGVk
IHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIGVhY2ggaXRlbSBpbiB0aGUgZ2l2ZW4gSURhdGFbXSBk
b2N1bWVudCBsaXN0CnB1YmxpYyBzdGF0aWMgT2JqZWN0W10gdmFsdWVzKElEYXRhW10gaW5wdXQs
IFN0cmluZyBrZXksIE9iamVjdCBkZWZhdWx0VmFsdWUpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCB8
fCBrZXkgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIGphdmEudXRpbC5TZXQ8Q2xhc3M8Pz4+IGNs
YXNzZXMgPSBuZXcgamF2YS51dGlsLkxpbmtlZEhhc2hTZXQ8Q2xhc3M8Pz4+KCk7CiAgamF2YS51
dGlsLkxpc3QgbGlzdCA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0KGlucHV0Lmxlbmd0aCk7CiAg
CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgT2JqZWN0IHZh
bHVlID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGlucHV0W2ldLCBrZXksIGRlZmF1bHRW
YWx1ZSk7CiAgICBpZiAodmFsdWUgIT0gbnVsbCkgY2xhc3Nlcy5hZGQodmFsdWUuZ2V0Q2xhc3Mo
KSk7CiAgICBsaXN0LmFkZCh2YWx1ZSk7CiAgfQogIAogIENsYXNzPD8+IG5lYXJlc3RBbmNlc3Rv
ciA9IHR1bmRyYS5zdXBwb3J0Lm9iamVjdC5uZWFyZXN0QW5jZXN0b3IoY2xhc3Nlcyk7CiAgaWYg
KG5lYXJlc3RBbmNlc3RvciA9PSBudWxsKSBuZWFyZXN0QW5jZXN0b3IgPSBPYmplY3QuY2xhc3M7
CiAgCiAgcmV0dXJuIGxpc3QudG9BcnJheSgoT2JqZWN0W10pamF2YS5sYW5nLnJlZmxlY3QuQXJy
YXkubmV3SW5zdGFuY2UobmVhcmVzdEFuY2VzdG9yLCAwKSk7Cn0K</value>
  <value name="encodeutf8">true</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
