<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.list.document</value>
  <value name="shared">Ly8gcmV0dXJucyBhIG5ldyBJRGF0YVtdIHdpdGggYWxsIG51bGwgdmFsdWVzIHJlbW92ZWQKcHVi
bGljIHN0YXRpYyBJRGF0YVtdIGNvbXBhY3QoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJh
eTsKCiAgLy8gdGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFs
bHkgYW4gSURhdGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFi
bGUgdG8gc3RvcmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElE
YXRhW10pamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJ
RGF0YVswXSkuZ2V0Q2xhc3MoKSk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3Ro
OyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9IHR1bmRyYS5kb2N1
bWVudC5jb21wYWN0KGFycmF5W2ldLCByZWN1cnNlKTsKICB9CgogIHJldHVybiB0dW5kcmEubGlz
dC5vYmplY3QuY29tcGFjdChhcnJheSk7Cn0KCi8vIHJldHVybnMgdGhlIHVuaW9uIHNldCBvZiBr
ZXlzIHByZXNlbnQgaW4gZXZlcnkgaXRlbSBpbiB0aGUgZ2l2ZW4KLy8gSURhdGFbXSBkb2N1bWVu
dCBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5cyhJRGF0YVtdIGlucHV0KSB7CiAgcmV0
dXJuIGtleXMoaW5wdXQsIG51bGwpOwp9CgovLyByZXR1cm5zIHRoZSB1bmlvbiBzZXQgb2Yga2V5
cyBwcmVzZW50IGluIGV2ZXJ5IGl0ZW0gaW4gdGhlIGdpdmVuCi8vIElEYXRhW10gZG9jdW1lbnQg
bGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIHBh
dHRlcm5TdHJpbmcpIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwYXR0ZXJuID0gbnVsbDsK
ICBpZiAocGF0dGVyblN0cmluZyAhPSBudWxsKSBwYXR0ZXJuID0gamF2YS51dGlsLnJlZ2V4LlBh
dHRlcm4uY29tcGlsZShwYXR0ZXJuU3RyaW5nKTsKICAKICBqYXZhLnV0aWwuU2V0PFN0cmluZz4g
a2V5cyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxTdHJpbmc+KCk7CgogIGlmIChpbnB1
dCAhPSBudWxsKSB7CiAgICBmb3IgKElEYXRhIGRvY3VtZW50IDogaW5wdXQpIHsKICAgICAgaWYg
KGRvY3VtZW50ICE9IG51bGwpIHsKICAgICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBkb2N1bWVu
dC5nZXRDdXJzb3IoKTsKICAgICAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgICAgICBT
dHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICAgICAgCiAgICAgICAgICBpZiAocGF0
dGVybiA9PSBudWxsKSB7CiAgICAgICAgICAgIGtleXMuYWRkKGtleSk7CiAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICBqYXZhLnV0aWwucmVnZXguTWF0Y2hlciBtYXRjaGVyID0gcGF0dGVy
bi5tYXRjaGVyKGtleSk7CiAgICAgICAgICAgIGlmIChtYXRjaGVyLm1hdGNoZXMoKSkga2V5cy5h
ZGQoa2V5KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3Vyc29yLmRlc3Ryb3koKTsg
ICAgIAogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4ga2V5cy50b0FycmF5KG5ldyBTdHJpbmdb
MF0pOwp9CgovLyByZXR1cm5zIGFuIElEYXRhIGRvY3VtZW50IHdoZXJlIHRoZSBrZXlzIGFyZSB0
aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aAovLyBnaXZlbiBwaXZvdCBrZXkgZnJvbSB0aGUgZ2l2
ZW4gSURhdGFbXSBkb2N1bWVudCBsaXN0LCBhbmQgdGhlIHZhbHVlcyBhcmUKLy8gdGhlIElEYXRh
W10gZG9jdW1lbnQgbGlzdCBpdGVtcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBwaXZvdCBrZXkKcHVi
bGljIHN0YXRpYyBJRGF0YSBwaXZvdChJRGF0YVtdIGFycmF5LCBTdHJpbmcgcGl2b3RLZXkpIHsK
ICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBwaXZvdEtleSA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAg
SURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIG9jID0g
b3V0cHV0LmdldEN1cnNvcigpOwoKICBmb3IgKElEYXRhIGl0ZW0gOiBhcnJheSkgewogICAgaWYg
KGl0ZW0gIT0gbnVsbCkgewogICAgICBPYmplY3QgdmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1
bWVudC5nZXQoaXRlbSwgcGl2b3RLZXkpOwogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAg
ICAgIFN0cmluZyBrZXkgPSB2YWx1ZS50b1N0cmluZygpOwogICAgICAgIGlmIChJRGF0YVV0aWwu
Z2V0KG9jLCBrZXkpID09IG51bGwpIElEYXRhVXRpbC5wdXQob2MsIGtleSwgaXRlbSk7CiAgICAg
IH0KICAgIH0KICB9CgogIG9jLmRlc3Ryb3koKTsKCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmV0
dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0ZWQgaW4gYXNjZW5kaW5nIG9y
ZGVyIGJ5Ci8vIHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBrZXkKcHVibGlj
IHN0YXRpYyBJRGF0YVtdIHNvcnQoSURhdGFbXSBhcnJheSwgU3RyaW5nIGtleSkgewogIHJldHVy
biBzb3J0KGFycmF5LCBrZXksIHRydWUpOwp9CgovLyByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGgg
YWxsIGVsZW1lbnRzIHNvcnRlZCBlaXRoZXIgaW4gYXNjZW5kaW5nIG9yCi8vIGRlc2NlbmRpbmcg
b3JkZXIgYnkgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGtleQpwdWJsaWMg
c3RhdGljIElEYXRhW10gc29ydChJRGF0YVtdIGFycmF5LCBTdHJpbmcga2V5LCBib29sZWFuIGFz
Y2VuZGluZykgewogIFN0cmluZ1tdIGtleXMgPSBudWxsOwogIGlmIChrZXkgIT0gbnVsbCkgewog
ICAga2V5cyA9IG5ldyBTdHJpbmdbMV07CiAgICBrZXlzWzBdID0ga2V5OwogIH0KCiAgcmV0dXJu
IHNvcnQoYXJyYXksIGtleXMsIGFzY2VuZGluZyk7Cn0KCi8vIHJldHVybnMgYSBuZXcgYXJyYXkg
d2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGluIGFzY2VuZGluZyBvcmRlciBieSB0aGUgCi8vIHZh
bHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGtleXMKcHVibGljIHN0YXRpYyBJRGF0YVtd
IHNvcnQoSURhdGFbXSBhcnJheSwgU3RyaW5nW10ga2V5cykgewogIHJldHVybiBzb3J0KGFycmF5
LCBrZXlzLCB0cnVlKTsKfQoKLy8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50
cyBzb3J0ZWQgYnkgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggCi8vIHRoZSBnaXZlbiBrZXlz
CnB1YmxpYyBzdGF0aWMgSURhdGFbXSBzb3J0KElEYXRhW10gYXJyYXksIFN0cmluZ1tdIGtleXMs
IGJvb2xlYW4gYXNjZW5kaW5nKSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3Ro
IDwgMiB8fCBrZXlzID09IG51bGwgfHwga2V5cy5sZW5ndGggPT0gMCkgcmV0dXJuIGFycmF5OwoK
ICBJRGF0YVtdIHNvcnRLZXlzID0gbmV3IElEYXRhW2tleXMubGVuZ3RoXTsKICBmb3IgKGludCBp
ID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIHNvcnRLZXlzW2ldID0gSURhdGFGYWN0
b3J5LmNyZWF0ZSgpOwogICAgSURhdGFDdXJzb3IgY3Vyc29yID0gc29ydEtleXNbaV0uZ2V0Q3Vy
c29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgImtleSIsIGtleXNbaV0pOwogICAgSURh
dGFVdGlsLnB1dChjdXJzb3IsICJkZXNjZW5kaW5nPyIsICIiICsgIWFzY2VuZGluZyk7CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogIH0KCiAgcmV0dXJuIHNvcnQoYXJyYXksIHNvcnRLZXlzKTsKfQoK
Ly8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0ZWQgYnkgdGhlIHZh
bHVlcyBhc3NvY2lhdGVkIHdpdGggCi8vIHRoZSBnaXZlbiBrZXlzCnB1YmxpYyBzdGF0aWMgSURh
dGFbXSBzb3J0KElEYXRhW10gYXJyYXksIElEYXRhW10gY3JpdGVyaWEpIHsKICBpZiAoYXJyYXkg
PT0gbnVsbCB8fCBhcnJheS5sZW5ndGggPCAyIHx8IGNyaXRlcmlhID09IG51bGwgfHwgY3JpdGVy
aWEubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgYXJyYXkgPSBqYXZhLnV0aWwuQXJyYXlz
LmNvcHlPZihhcnJheSwgYXJyYXkubGVuZ3RoKTsKICBqYXZhLnV0aWwuQXJyYXlzLnNvcnQoYXJy
YXksIG5ldyBJRGF0YUNvbXBhcmF0b3IoY3JpdGVyaWEpKTsKCiAgcmV0dXJuIGFycmF5Owp9Cgov
LyByZXR1cm5zIGEgbmV3IElEYXRhW10gd2l0aCBhbGwgZW1wdHkgYW5kIG51bGwgaXRlbXMgcmVt
b3ZlZApwdWJsaWMgc3RhdGljIElEYXRhW10gc3F1ZWV6ZShJRGF0YVtdIGFycmF5LCBib29sZWFu
IHJlY3Vyc2UpIHsKICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBhcnJheS5sZW5ndGggPT0gMCkgcmV0
dXJuIGFycmF5OwoKICAvLyB0YWtlIGEgY29weSBvZiB0aGUgYXJyYXksIHRvIG1ha2Ugc3VyZSBp
dCdzIHJlYWxseSBhbiBJRGF0YVtdIGFuZCBub3Qgc29tZSBzdWJjbGFzcyB0aGF0IHdvbid0CiAg
Ly8gYmUgYWJsZSB0byBzdG9yZSBkaWZmZXJlbnQgSURhdGEgaW1wbGVtZW50YXRpb25zCiAgYXJy
YXkgPSAoSURhdGFbXSlqYXZhLnV0aWwuQXJyYXlzLmNvcHlPZihhcnJheSwgYXJyYXkubGVuZ3Ro
LCAobmV3IElEYXRhWzBdKS5nZXRDbGFzcygpKTsKCiAgamF2YS51dGlsLkxpc3Q8SURhdGE+IGxp
c3QgPSBuZXcgamF2YS51dGlsLkFycmF5TGlzdDxJRGF0YT4oYXJyYXkubGVuZ3RoKTsKCiAgZm9y
IChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgaWYgKGFycmF5W2ldICE9
IG51bGwpIGFycmF5W2ldID0gdHVuZHJhLmRvY3VtZW50LnNxdWVlemUoYXJyYXlbaV0sIHJlY3Vy
c2UpOwogICAgaWYgKGFycmF5W2ldICE9IG51bGwpIGxpc3QuYWRkKGFycmF5W2ldKTsKICB9Cgog
IGFycmF5ID0gbGlzdC50b0FycmF5KG5ldyBJRGF0YVswXSk7CiAgaWYgKGFycmF5Lmxlbmd0aCA9
PSAwKSBhcnJheSA9IG51bGw7CgogIHJldHVybiBhcnJheTsKfQoKLy8gY29tcGFyZXMgdHdvIElE
YXRhIG9iamVjdHMgdXNpbmcgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGxp
c3QKLy8gb2Yga2V5cwpwdWJsaWMgc3RhdGljIGNsYXNzIElEYXRhQ29tcGFyYXRvciBpbXBsZW1l
bnRzIGphdmEudXRpbC5Db21wYXJhdG9yPElEYXRhPiB7CiAgcHJvdGVjdGVkIElEYXRhW10gY3Jp
dGVyaWE7CgogIHB1YmxpYyBJRGF0YUNvbXBhcmF0b3IoSURhdGFbXSBjcml0ZXJpYSkgewogICAg
dGhpcy5jcml0ZXJpYSA9IGNyaXRlcmlhOwogIH0KCiAgcHJvdGVjdGVkIHN0YXRpYyBpbnQgbm9y
bWFsaXplKGludCByZXN1bHQsIGJvb2xlYW4gZGVzY2VuZGluZykgewogICAgaWYgKGRlc2NlbmRp
bmcpIHsKICAgICAgaWYgKHJlc3VsdCA8IDApIHsKICAgICAgICByZXN1bHQgPSAxOwogICAgICB9
IGVsc2UgaWYgKHJlc3VsdCA+IDApIHsKICAgICAgICByZXN1bHQgPSAtMTsKICAgICAgfQogICAg
fQogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIHB1YmxpYyBpbnQgY29tcGFyZShJRGF0YSBhLCBJ
RGF0YSBiKSB7CiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIGZvciAoSURhdGEgaXRlbSA6IGNyaXRl
cmlhKSB7CiAgICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGl0ZW0uZ2V0Q3Vyc29yKCk7CiAgICAg
IFN0cmluZyBrZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImtleSIpOwogICAgICBT
dHJpbmcgdHlwZSA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCAidHlwZSIpOwogICAgICBT
dHJpbmcgcGF0dGVybiA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCAicGF0dGVybiIpOwog
ICAgICBib29sZWFuIGRlc2NlbmRpbmcgPSB0dW5kcmEuYm9vbC5wYXJzZShJRGF0YVV0aWwuZ2V0
U3RyaW5nKGN1cnNvciwgImRlc2NlbmRpbmc/IikpOwogICAgICBjdXJzb3IuZGVzdHJveSgpOwoK
ICAgICAgT2JqZWN0IHZhbHVlX2EgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoYSwga2V5
KTsKICAgICAgT2JqZWN0IHZhbHVlX2IgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoYiwg
a2V5KTsKCiAgICAgIGlmICh2YWx1ZV9hID09IG51bGwpIHsKICAgICAgICBpZiAodmFsdWVfYiAh
PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQgPSBub3JtYWxpemUoLTEsIGRlc2NlbmRpbmcpOwog
ICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHZhbHVlX2IgPT0gbnVs
bCkgewogICAgICAgIGlmICh2YWx1ZV9hICE9IG51bGwpIHsKICAgICAgICAgIHJlc3VsdCA9IG5v
cm1hbGl6ZSgxLCBkZXNjZW5kaW5nKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAg
fSBlbHNlIHsKICAgICAgICBpZiAodHlwZSAhPSBudWxsKSB7CiAgICAgICAgICB2YWx1ZV9hID0g
dmFsdWVfYS50b1N0cmluZygpOwogICAgICAgICAgdmFsdWVfYiA9IHZhbHVlX2IudG9TdHJpbmco
KTsKICAgICAgICAgIGlmICh0eXBlLmVxdWFscygiaW50ZWdlciIpKSB7CiAgICAgICAgICAgIHZh
bHVlX2EgPSB0dW5kcmEuaW50ZWdlci5wYXJzZSgoU3RyaW5nKXZhbHVlX2EpOwogICAgICAgICAg
ICB2YWx1ZV9iID0gdHVuZHJhLmludGVnZXIucGFyc2UoKFN0cmluZyl2YWx1ZV9iKTsKICAgICAg
ICAgIH0gZWxzZSBpZiAodHlwZS5lcXVhbHMoImRlY2ltYWwiKSkgewogICAgICAgICAgICB2YWx1
ZV9hID0gdHVuZHJhLmRlY2ltYWwucGFyc2UoKFN0cmluZyl2YWx1ZV9hKTsKICAgICAgICAgICAg
dmFsdWVfYiA9IHR1bmRyYS5kZWNpbWFsLnBhcnNlKChTdHJpbmcpdmFsdWVfYik7CiAgICAgICAg
ICB9IGVsc2UgaWYgKHR5cGUuZXF1YWxzKCJkYXRldGltZSIpKSB7CiAgICAgICAgICAgIHZhbHVl
X2EgPSB0dW5kcmEuZGF0ZXRpbWUucGFyc2UoKFN0cmluZyl2YWx1ZV9hLCBwYXR0ZXJuKTsKICAg
ICAgICAgICAgdmFsdWVfYiA9IHR1bmRyYS5kYXRldGltZS5wYXJzZSgoU3RyaW5nKXZhbHVlX2Is
IHBhdHRlcm4pOwogICAgICAgICAgfSBlbHNlIGlmICh0eXBlLmVxdWFscygiZHVyYXRpb24iKSkg
ewogICAgICAgICAgICB2YWx1ZV9hID0gdHVuZHJhLmludGVnZXIucGFyc2UodHVuZHJhLmR1cmF0
aW9uLmZvcm1hdCgoU3RyaW5nKXZhbHVlX2EsIHBhdHRlcm4sICJtaWxsaXNlY29uZHMiKSk7CiAg
ICAgICAgICAgIHZhbHVlX2IgPSB0dW5kcmEuaW50ZWdlci5wYXJzZSh0dW5kcmEuZHVyYXRpb24u
Zm9ybWF0KChTdHJpbmcpdmFsdWVfYiwgcGF0dGVybiwgIm1pbGxpc2Vjb25kcyIpKTsKICAgICAg
ICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZV9hIGluc3RhbmNlb2YgQ29tcGFyYWJs
ZSAmJiB2YWx1ZV9iIGluc3RhbmNlb2YgQ29tcGFyYWJsZSkgewogICAgICAgICAgcmVzdWx0ID0g
bm9ybWFsaXplKCgoQ29tcGFyYWJsZSl2YWx1ZV9hKS5jb21wYXJlVG8oKENvbXBhcmFibGUpdmFs
dWVfYiksIGRlc2NlbmRpbmcpOwogICAgICAgICAgaWYgKHJlc3VsdCAhPSAwKSBicmVhazsKICAg
ICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CgovLyBncm91cHMg
dGhlIGdpdmVuIGxpc3QgYnkgdGhlIGdpdmVuIGtleXMKcHVibGljIHN0YXRpYyBJRGF0YVtdIGdy
b3VwKElEYXRhW10gbGlzdCwgU3RyaW5nW10ga2V5cykgewogIGlmIChsaXN0ID09IG51bGwgfHwg
bGlzdC5sZW5ndGggPT0gMCkgcmV0dXJuIGxpc3Q7CgogIGlmIChrZXlzID09IG51bGwgfHwga2V5
cy5sZW5ndGggPT0gMCkgewogICAgSURhdGFbXSByZXN1bHQgPSBuZXcgSURhdGFbMV07CiAgICBy
ZXN1bHRbMF0gPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBjdXJzb3Ig
PSByZXN1bHRbMF0uZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgImdyb3Vw
IiwgSURhdGFGYWN0b3J5LmNyZWF0ZSgpKTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCAiaXRl
bXMiLCBsaXN0KTsKICAgIGN1cnNvci5kZXN0cm95KCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0g
ZWxzZSB7CiAgICBqYXZhLnV0aWwuTWFwPENvbXBvdW5kS2V5LCBqYXZhLnV0aWwuTGlzdDxJRGF0
YT4+IGdyb3VwcyA9IG5ldyBqYXZhLnV0aWwuVHJlZU1hcDxDb21wb3VuZEtleSwgamF2YS51dGls
Lkxpc3Q8SURhdGE+PigpOwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkr
KykgewogICAgICBpZiAobGlzdFtpXSAhPSBudWxsKSB7CiAgICAgICAgQ29tcG91bmRLZXkga2V5
ID0gbmV3IENvbXBvdW5kS2V5KGtleXMsIGxpc3RbaV0pOwogICAgICAgIGphdmEudXRpbC5MaXN0
PElEYXRhPiBhcnJheSA9IGdyb3Vwcy5nZXQoa2V5KTsKICAgICAgICBpZiAoYXJyYXkgPT0gbnVs
bCkgYXJyYXkgPSBuZXcgamF2YS51dGlsLkxpbmtlZExpc3Q8SURhdGE+KCk7CiAgICAgICAgYXJy
YXkuYWRkKGxpc3RbaV0pOwogICAgICAgIGdyb3Vwcy5wdXQoa2V5LCBhcnJheSk7CiAgICAgIH0K
ICAgIH0KCiAgICBqYXZhLnV0aWwuTGlzdDxJRGF0YT4gcmVzdWx0ID0gbmV3IGphdmEudXRpbC5B
cnJheUxpc3Q8SURhdGE+KGdyb3Vwcy5zaXplKCkpOwogICAgamF2YS51dGlsLkl0ZXJhdG9yPENv
bXBvdW5kS2V5PiBpdGVyYXRvciA9IGdyb3Vwcy5rZXlTZXQoKS5pdGVyYXRvcigpOwoKICAgIHdo
aWxlKGl0ZXJhdG9yLmhhc05leHQoKSkgewogICAgICBDb21wb3VuZEtleSBrZXkgPSBpdGVyYXRv
ci5uZXh0KCk7CiAgICAgIGphdmEudXRpbC5MaXN0PElEYXRhPiBpdGVtcyA9IGdyb3Vwcy5nZXQo
a2V5KTsKCiAgICAgIElEYXRhIGdyb3VwID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAgICBJ
RGF0YUN1cnNvciBjdXJzb3IgPSBncm91cC5nZXRDdXJzb3IoKTsKICAgICAgSURhdGFVdGlsLnB1
dChjdXJzb3IsICJncm91cCIsIGtleS5nZXRJRGF0YSgpKTsKICAgICAgSURhdGFVdGlsLnB1dChj
dXJzb3IsICJpdGVtcyIsIChJRGF0YVtdKWl0ZW1zLnRvQXJyYXkobmV3IElEYXRhWzBdKSk7CiAg
ICAgIGN1cnNvci5kZXN0cm95KCk7CgogICAgICByZXN1bHQuYWRkKGdyb3VwKTsKICAgIH0KICAg
IHJldHVybiAoSURhdGFbXSlyZXN1bHQudG9BcnJheShuZXcgSURhdGFbMF0pOwogIH0KfQoKcHVi
bGljIHN0YXRpYyBjbGFzcyBDb21wb3VuZEtleSBleHRlbmRzIGphdmEudXRpbC5MaW5rZWRIYXNo
TWFwPFN0cmluZywgQ29tcGFyYWJsZT4gaW1wbGVtZW50cyBDb21wYXJhYmxlPENvbXBvdW5kS2V5
PiwgY29tLndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxlIHsKICBwdWJsaWMgQ29tcG91bmRLZXko
KSB7CiAgICBzdXBlcigpOwogIH0KCiAgcHVibGljIENvbXBvdW5kS2V5KGludCBpbml0aWFsQ2Fw
YWNpdHkpIHsKICAgIHN1cGVyKGluaXRpYWxDYXBhY2l0eSk7CiAgfQoKICBwdWJsaWMgQ29tcG91
bmRLZXkoaW50IGluaXRpYWxDYXBhY2l0eSwgZmxvYXQgbG9hZEZhY3RvcikgewogICAgc3VwZXIo
aW5pdGlhbENhcGFjaXR5LCBsb2FkRmFjdG9yKTsKICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShp
bnQgaW5pdGlhbENhcGFjaXR5LCBmbG9hdCBsb2FkRmFjdG9yLCBib29sZWFuIGFjY2Vzc09yZGVy
KSB7CiAgICBzdXBlcihpbml0aWFsQ2FwYWNpdHksIGxvYWRGYWN0b3IsIGFjY2Vzc09yZGVyKTsK
ICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShqYXZhLnV0aWwuTWFwPD8gZXh0ZW5kcyBTdHJpbmcs
PyBleHRlbmRzIENvbXBhcmFibGU+IG1hcCkgewogICAgc3VwZXIobWFwKTsKICB9CgogIHB1Ymxp
YyBDb21wb3VuZEtleShTdHJpbmdbXSBrZXlzLCBJRGF0YSBkb2N1bWVudCkgewogICAgc3VwZXIo
a2V5cy5sZW5ndGgpOwogICAgCiAgICAvLyBzZWVkIHdpdGgga2V5IHZhbHVlIHBhaXJzCiAgICBm
b3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0IHZhbHVl
ID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsKICAgICAg
aWYgKHZhbHVlICE9IG51bGwgJiYgdmFsdWUgaW5zdGFuY2VvZiBDb21wYXJhYmxlKSB7CiAgICAg
ICAgdGhpcy5wdXQoa2V5c1tpXSwgKENvbXBhcmFibGUpdmFsdWUpOwogICAgICB9IGVsc2Ugewog
ICAgICAgIHRoaXMucHV0KGtleXNbaV0sIG51bGwpOwogICAgICB9CiAgICB9ICAgIAogIH0KCiAg
cHVibGljIGludCBjb21wYXJlVG8oQ29tcG91bmRLZXkgb3RoZXIpIHsKICAgIGlmIChvdGhlciA9
PSBudWxsKSByZXR1cm4gMTsKCiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIAogICAgamF2YS51dGls
Lkl0ZXJhdG9yPFN0cmluZz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJhdG9yKCk7Cgog
ICAgd2hpbGUoaXRlcmF0b3IuaGFzTmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkgPSBpdGVyYXRv
ci5uZXh0KCk7CiAgICAgIENvbXBhcmFibGUgdGhpc1ZhbHVlID0gdGhpcy5nZXQoa2V5KTsKICAg
ICAgQ29tcGFyYWJsZSBvdGhlclZhbHVlID0gb3RoZXIuZ2V0KGtleSk7CgogICAgICBpZiAodGhp
c1ZhbHVlID09IG51bGwpIHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSAhPSBudWxsKSByZXN1bHQg
PSAtMTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSA9PSBudWxsKSB7CiAg
ICAgICAgICByZXN1bHQgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSB0
aGlzVmFsdWUuY29tcGFyZVRvKG90aGVyVmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBp
ZiAocmVzdWx0ICE9IDApIGJyZWFrOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIHB1
YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgIGJvb2xlYW4gcmVzdWx0ID0g
ZmFsc2U7CgogICAgaWYgKG90aGVyICE9IG51bGwgJiYgb3RoZXIgaW5zdGFuY2VvZiBDb21wb3Vu
ZEtleSkgewogICAgICByZXN1bHQgPSB0aGlzLmNvbXBhcmVUbygoQ29tcG91bmRLZXkpb3RoZXIp
ID09IDA7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgcHVibGljIElEYXRhIGdldElE
YXRhKCkgewogICAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAgamF2
YS51dGlsLkl0ZXJhdG9yPFN0cmluZz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJhdG9y
KCk7CiAgICB3aGlsZShpdGVyYXRvci5oYXNOZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGl0
ZXJhdG9yLm5leHQoKTsKICAgICAgT2JqZWN0IHZhbHVlID0gdGhpcy5nZXQoa2V5KTsKICAgICAg
dHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCB2YWx1ZSk7CiAgICB9CiAg
ICByZXR1cm4gb3V0cHV0OwogIH0KCiAgcHVibGljIHZvaWQgc2V0SURhdGEoSURhdGEgaW5wdXQp
IHsKICAgIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm47CgogICAgdGhpcy5jbGVhcigpOwoKICAg
IElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgd2hpbGUoY3Vyc29y
Lm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICBPYmpl
Y3QgdmFsdWUgPSBjdXJzb3IuZ2V0VmFsdWUoKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYm
IHZhbHVlIGluc3RhbmNlb2YgQ29tcGFyYWJsZSkgdGhpcy5wdXQoa2V5LCAoQ29tcGFyYWJsZSl2
YWx1ZSk7CiAgICB9CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KfQoKLy8gcmV0dXJucyB0aGUg
dmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gZWFjaCBpdGVtIGluIHRo
ZSBnaXZlbiBJRGF0YVtdIGRvY3VtZW50IGxpc3QKcHVibGljIHN0YXRpYyBPYmplY3RbXSB2YWx1
ZXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIGtleSwgT2JqZWN0IGRlZmF1bHRWYWx1ZSkgewogIGlm
IChpbnB1dCA9PSBudWxsIHx8IGtleSA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgamF2YS51dGls
LlNldDxDbGFzczw/Pj4gY2xhc3NlcyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxDbGFz
czw/Pj4oKTsKICBqYXZhLnV0aWwuTGlzdCBsaXN0ID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Qo
aW5wdXQubGVuZ3RoKTsKICAKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsr
KSB7CiAgICBPYmplY3QgdmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaW5wdXRb
aV0sIGtleSwgZGVmYXVsdFZhbHVlKTsKICAgIGlmICh2YWx1ZSAhPSBudWxsKSBjbGFzc2VzLmFk
ZCh2YWx1ZS5nZXRDbGFzcygpKTsKICAgIGxpc3QuYWRkKHZhbHVlKTsKICB9CiAgCiAgQ2xhc3M8
Pz4gbmVhcmVzdEFuY2VzdG9yID0gdHVuZHJhLnN1cHBvcnQub2JqZWN0Lm5lYXJlc3RBbmNlc3Rv
cihjbGFzc2VzKTsKICBpZiAobmVhcmVzdEFuY2VzdG9yID09IG51bGwpIG5lYXJlc3RBbmNlc3Rv
ciA9IE9iamVjdC5jbGFzczsKICAKICByZXR1cm4gbGlzdC50b0FycmF5KChPYmplY3RbXSlqYXZh
LmxhbmcucmVmbGVjdC5BcnJheS5uZXdJbnN0YW5jZShuZWFyZXN0QW5jZXN0b3IsIDApKTsKfQo=
</value>
  <value name="encodeutf8">true</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
