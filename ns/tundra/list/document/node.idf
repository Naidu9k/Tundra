<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.list.document</value>
  <value name="shared">Ly8gcmV0dXJucyBhIG5ldyBJRGF0YVtdIHdpdGggYWxsIG51bGwgdmFsdWVzIHJlbW92ZWQKcHVi
bGljIHN0YXRpYyBJRGF0YVtdIGNvbXBhY3QoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJh
eTsKCiAgLy8gdGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFs
bHkgYW4gSURhdGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFi
bGUgdG8gc3RvcmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElE
YXRhW10pamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJ
RGF0YVswXSkuZ2V0Q2xhc3MoKSk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3Ro
OyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9IHR1bmRyYS5kb2N1
bWVudC5jb21wYWN0KGFycmF5W2ldLCByZWN1cnNlKTsKICB9CgogIHJldHVybiB0dW5kcmEubGlz
dC5vYmplY3QuY29tcGFjdChhcnJheSk7Cn0KCi8vIHJldHVybnMgdGhlIHVuaW9uIHNldCBvZiBr
ZXlzIHByZXNlbnQgaW4gZXZlcnkgaXRlbSBpbiB0aGUgZ2l2ZW4KLy8gSURhdGFbXSBkb2N1bWVu
dCBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5cyhJRGF0YVtdIGlucHV0KSB7CiAgcmV0
dXJuIGtleXMoaW5wdXQsIG51bGwpOwp9CgovLyByZXR1cm5zIHRoZSB1bmlvbiBzZXQgb2Yga2V5
cyBwcmVzZW50IGluIGV2ZXJ5IGl0ZW0gaW4gdGhlIGdpdmVuCi8vIElEYXRhW10gZG9jdW1lbnQg
bGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXMoSURhdGFbXSBpbnB1dCwgU3RyaW5nIHBh
dHRlcm5TdHJpbmcpIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwYXR0ZXJuID0gbnVsbDsK
ICBpZiAocGF0dGVyblN0cmluZyAhPSBudWxsKSBwYXR0ZXJuID0gamF2YS51dGlsLnJlZ2V4LlBh
dHRlcm4uY29tcGlsZShwYXR0ZXJuU3RyaW5nKTsKICAKICBqYXZhLnV0aWwuU2V0PFN0cmluZz4g
a2V5cyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxTdHJpbmc+KCk7CgogIGlmIChpbnB1
dCAhPSBudWxsKSB7CiAgICBmb3IgKElEYXRhIGRvY3VtZW50IDogaW5wdXQpIHsKICAgICAgaWYg
KGRvY3VtZW50ICE9IG51bGwpIHsKICAgICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBkb2N1bWVu
dC5nZXRDdXJzb3IoKTsKICAgICAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgICAgICBT
dHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICAgICAgCiAgICAgICAgICBpZiAocGF0
dGVybiA9PSBudWxsKSB7CiAgICAgICAgICAgIGtleXMuYWRkKGtleSk7CiAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICBqYXZhLnV0aWwucmVnZXguTWF0Y2hlciBtYXRjaGVyID0gcGF0dGVy
bi5tYXRjaGVyKGtleSk7CiAgICAgICAgICAgIGlmIChtYXRjaGVyLm1hdGNoZXMoKSkga2V5cy5h
ZGQoa2V5KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3Vyc29yLmRlc3Ryb3koKTsg
ICAgIAogICAgICB9CiAgICB9CiAgfQoKICByZXR1cm4ga2V5cy50b0FycmF5KG5ldyBTdHJpbmdb
MF0pOwp9CgovLyByZXR1cm5zIGFuIElEYXRhIGRvY3VtZW50IHdoZXJlIHRoZSBrZXlzIGFyZSB0
aGUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aAovLyBnaXZlbiBwaXZvdCBrZXkgZnJvbSB0aGUgZ2l2
ZW4gSURhdGFbXSBkb2N1bWVudCBsaXN0LCBhbmQgdGhlIHZhbHVlcyBhcmUKLy8gdGhlIElEYXRh
W10gZG9jdW1lbnQgbGlzdCBpdGVtcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBwaXZvdCBrZXkKcHVi
bGljIHN0YXRpYyBJRGF0YSBwaXZvdChJRGF0YVtdIGFycmF5LCBTdHJpbmcgcGl2b3RLZXkpIHsK
ICByZXR1cm4gcGl2b3QoYXJyYXksIG51bGwsIHBpdm90S2V5KTsKfQoKLy8gcmV0dXJucyBhbiBJ
RGF0YSBkb2N1bWVudCB3aGVyZSB0aGUga2V5cyBhcmUgdGhlIHZhbHVlcyBhc3NvY2lhdGVkIHdp
dGgKLy8gZ2l2ZW4gcGl2b3Qga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhW10gZG9jdW1lbnQgbGlz
dCwgYW5kIHRoZSB2YWx1ZXMgYXJlCi8vIHRoZSBJRGF0YVtdIGRvY3VtZW50IGxpc3QgaXRlbXMg
YXNzb2NpYXRlZCB3aXRoIGVhY2ggcGl2b3Qga2V5CnB1YmxpYyBzdGF0aWMgSURhdGEgcGl2b3Qo
SURhdGFbXSBhcnJheSwgU3RyaW5nIGRlbGltaXRlciwgU3RyaW5nIC4uLiBwaXZvdEtleXMpIHsK
ICBpZiAoYXJyYXkgPT0gbnVsbCB8fCBwaXZvdEtleXMgPT0gbnVsbCB8fCBwaXZvdEtleXMubGVu
Z3RoID09IDApIHJldHVybiBudWxsOwogIGlmIChkZWxpbWl0ZXIgPT0gbnVsbCkgZGVsaW1pdGVy
ID0gIi8iOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CgogIG91dGVy
OgogIGZvciAoSURhdGEgaXRlbSA6IGFycmF5KSB7CiAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAg
ICAgIFN0cmluZ0J1aWxkZXIgYnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBwaXZvdEtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBPYmplY3Qg
dmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaXRlbSwgcGl2b3RLZXlzW2ldKTsK
ICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgewogICAgICAgICAgY29udGludWUgb3V0ZXI7CiAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgIGJ1ZmZlci5hcHBlbmQodmFsdWUudG9TdHJpbmcoKSk7
CiAgICAgICAgfQogICAgICAgIGlmIChpIDwgKHBpdm90S2V5cy5sZW5ndGggLSAxKSkgYnVmZmVy
LmFwcGVuZChkZWxpbWl0ZXIpOwogICAgICB9CiAgICAgIFN0cmluZyBrZXkgPSBidWZmZXIudG9T
dHJpbmcoKTsKICAgICAgaWYgKHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LmdldChvdXRwdXQsIGtl
eSkgPT0gbnVsbCkgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCBpdGVt
KTsKICAgIH0KICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJldHVybnMgYSBuZXcgYXJyYXkg
d2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGluIGFzY2VuZGluZyBvcmRlciBieQovLyB0aGUgdmFs
dWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5CnB1YmxpYyBzdGF0aWMgSURhdGFbXSBz
b3J0KElEYXRhW10gYXJyYXksIFN0cmluZyBrZXkpIHsKICByZXR1cm4gc29ydChhcnJheSwga2V5
LCB0cnVlKTsKfQoKLy8gcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCBlbGVtZW50cyBzb3J0
ZWQgZWl0aGVyIGluIGFzY2VuZGluZyBvcgovLyBkZXNjZW5kaW5nIG9yZGVyIGJ5IHRoZSB2YWx1
ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBrZXkKcHVibGljIHN0YXRpYyBJRGF0YVtdIHNv
cnQoSURhdGFbXSBhcnJheSwgU3RyaW5nIGtleSwgYm9vbGVhbiBhc2NlbmRpbmcpIHsKICBTdHJp
bmdbXSBrZXlzID0gbnVsbDsKICBpZiAoa2V5ICE9IG51bGwpIHsKICAgIGtleXMgPSBuZXcgU3Ry
aW5nWzFdOwogICAga2V5c1swXSA9IGtleTsKICB9CgogIHJldHVybiBzb3J0KGFycmF5LCBrZXlz
LCBhc2NlbmRpbmcpOwp9CgovLyByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIGVsZW1lbnRz
IHNvcnRlZCBpbiBhc2NlbmRpbmcgb3JkZXIgYnkgdGhlIAovLyB2YWx1ZXMgYXNzb2NpYXRlZCB3
aXRoIHRoZSBnaXZlbiBrZXlzCnB1YmxpYyBzdGF0aWMgSURhdGFbXSBzb3J0KElEYXRhW10gYXJy
YXksIFN0cmluZ1tdIGtleXMpIHsKICByZXR1cm4gc29ydChhcnJheSwga2V5cywgdHJ1ZSk7Cn0K
Ci8vIHJldHVybnMgYSBuZXcgYXJyYXkgd2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGJ5IHRoZSB2
YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIAovLyB0aGUgZ2l2ZW4ga2V5cwpwdWJsaWMgc3RhdGljIElE
YXRhW10gc29ydChJRGF0YVtdIGFycmF5LCBTdHJpbmdbXSBrZXlzLCBib29sZWFuIGFzY2VuZGlu
ZykgewogIGlmIChhcnJheSA9PSBudWxsIHx8IGFycmF5Lmxlbmd0aCA8IDIgfHwga2V5cyA9PSBu
dWxsIHx8IGtleXMubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgSURhdGFbXSBzb3J0S2V5
cyA9IG5ldyBJRGF0YVtrZXlzLmxlbmd0aF07CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBrZXlzLmxl
bmd0aDsgaSsrKSB7CiAgICBzb3J0S2V5c1tpXSA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAg
IElEYXRhQ3Vyc29yIGN1cnNvciA9IHNvcnRLZXlzW2ldLmdldEN1cnNvcigpOwogICAgSURhdGFV
dGlsLnB1dChjdXJzb3IsICJrZXkiLCBrZXlzW2ldKTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29y
LCAiZGVzY2VuZGluZz8iLCAiIiArICFhc2NlbmRpbmcpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsK
ICB9CgogIHJldHVybiBzb3J0KGFycmF5LCBzb3J0S2V5cyk7Cn0KCi8vIHJldHVybnMgYSBuZXcg
YXJyYXkgd2l0aCBhbGwgZWxlbWVudHMgc29ydGVkIGJ5IHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3
aXRoIAovLyB0aGUgZ2l2ZW4ga2V5cwpwdWJsaWMgc3RhdGljIElEYXRhW10gc29ydChJRGF0YVtd
IGFycmF5LCBJRGF0YVtdIGNyaXRlcmlhKSB7CiAgaWYgKGFycmF5ID09IG51bGwgfHwgYXJyYXku
bGVuZ3RoIDwgMiB8fCBjcml0ZXJpYSA9PSBudWxsIHx8IGNyaXRlcmlhLmxlbmd0aCA9PSAwKSBy
ZXR1cm4gYXJyYXk7CgogIGFycmF5ID0gamF2YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFy
cmF5Lmxlbmd0aCk7CiAgamF2YS51dGlsLkFycmF5cy5zb3J0KGFycmF5LCBuZXcgSURhdGFDb21w
YXJhdG9yKGNyaXRlcmlhKSk7CgogIHJldHVybiBhcnJheTsKfQoKLy8gcmV0dXJucyBhIG5ldyBJ
RGF0YVtdIHdpdGggYWxsIGVtcHR5IGFuZCBudWxsIGl0ZW1zIHJlbW92ZWQKcHVibGljIHN0YXRp
YyBJRGF0YVtdIHNxdWVlemUoSURhdGFbXSBhcnJheSwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYg
KGFycmF5ID09IG51bGwgfHwgYXJyYXkubGVuZ3RoID09IDApIHJldHVybiBhcnJheTsKCiAgLy8g
dGFrZSBhIGNvcHkgb2YgdGhlIGFycmF5LCB0byBtYWtlIHN1cmUgaXQncyByZWFsbHkgYW4gSURh
dGFbXSBhbmQgbm90IHNvbWUgc3ViY2xhc3MgdGhhdCB3b24ndAogIC8vIGJlIGFibGUgdG8gc3Rv
cmUgZGlmZmVyZW50IElEYXRhIGltcGxlbWVudGF0aW9ucwogIGFycmF5ID0gKElEYXRhW10pamF2
YS51dGlsLkFycmF5cy5jb3B5T2YoYXJyYXksIGFycmF5Lmxlbmd0aCwgKG5ldyBJRGF0YVswXSku
Z2V0Q2xhc3MoKSk7CgogIGphdmEudXRpbC5MaXN0PElEYXRhPiBsaXN0ID0gbmV3IGphdmEudXRp
bC5BcnJheUxpc3Q8SURhdGE+KGFycmF5Lmxlbmd0aCk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwg
YXJyYXkubGVuZ3RoOyBpKyspIHsKICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSBhcnJheVtpXSA9
IHR1bmRyYS5kb2N1bWVudC5zcXVlZXplKGFycmF5W2ldLCByZWN1cnNlKTsKICAgIGlmIChhcnJh
eVtpXSAhPSBudWxsKSBsaXN0LmFkZChhcnJheVtpXSk7CiAgfQoKICBhcnJheSA9IGxpc3QudG9B
cnJheShuZXcgSURhdGFbMF0pOwogIGlmIChhcnJheS5sZW5ndGggPT0gMCkgYXJyYXkgPSBudWxs
OwoKICByZXR1cm4gYXJyYXk7Cn0KCi8vIGNvbXBhcmVzIHR3byBJRGF0YSBvYmplY3RzIHVzaW5n
IHRoZSB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlbiBsaXN0Ci8vIG9mIGtleXMKcHVi
bGljIHN0YXRpYyBjbGFzcyBJRGF0YUNvbXBhcmF0b3IgaW1wbGVtZW50cyBqYXZhLnV0aWwuQ29t
cGFyYXRvcjxJRGF0YT4gewogIHByb3RlY3RlZCBJRGF0YVtdIGNyaXRlcmlhOwoKICBwdWJsaWMg
SURhdGFDb21wYXJhdG9yKElEYXRhW10gY3JpdGVyaWEpIHsKICAgIHRoaXMuY3JpdGVyaWEgPSBj
cml0ZXJpYTsKICB9CgogIHByb3RlY3RlZCBzdGF0aWMgaW50IG5vcm1hbGl6ZShpbnQgcmVzdWx0
LCBib29sZWFuIGRlc2NlbmRpbmcpIHsKICAgIGlmIChkZXNjZW5kaW5nKSB7CiAgICAgIGlmIChy
ZXN1bHQgPCAwKSB7CiAgICAgICAgcmVzdWx0ID0gMTsKICAgICAgfSBlbHNlIGlmIChyZXN1bHQg
PiAwKSB7CiAgICAgICAgcmVzdWx0ID0gLTE7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1
bHQ7CiAgfQoKICBwdWJsaWMgaW50IGNvbXBhcmUoSURhdGEgYSwgSURhdGEgYikgewogICAgaW50
IHJlc3VsdCA9IDA7CiAgICBmb3IgKElEYXRhIGl0ZW0gOiBjcml0ZXJpYSkgewogICAgICBJRGF0
YUN1cnNvciBjdXJzb3IgPSBpdGVtLmdldEN1cnNvcigpOwogICAgICBTdHJpbmcga2V5ID0gSURh
dGFVdGlsLmdldFN0cmluZyhjdXJzb3IsICJrZXkiKTsKICAgICAgU3RyaW5nIHR5cGUgPSBJRGF0
YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInR5cGUiKTsKICAgICAgU3RyaW5nIHBhdHRlcm4gPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInBhdHRlcm4iKTsKICAgICAgYm9vbGVhbiBkZXNj
ZW5kaW5nID0gQm9vbGVhbkhlbHBlci5wYXJzZShJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwg
ImRlc2NlbmRpbmc/IikpOwogICAgICBjdXJzb3IuZGVzdHJveSgpOwoKICAgICAgT2JqZWN0IHZh
bHVlX2EgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoYSwga2V5KTsKICAgICAgT2JqZWN0
IHZhbHVlX2IgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoYiwga2V5KTsKCiAgICAgIGlm
ICh2YWx1ZV9hID09IG51bGwpIHsKICAgICAgICBpZiAodmFsdWVfYiAhPSBudWxsKSB7CiAgICAg
ICAgICByZXN1bHQgPSBub3JtYWxpemUoLTEsIGRlc2NlbmRpbmcpOwogICAgICAgICAgYnJlYWs7
CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHZhbHVlX2IgPT0gbnVsbCkgewogICAgICAgIGlm
ICh2YWx1ZV9hICE9IG51bGwpIHsKICAgICAgICAgIHJlc3VsdCA9IG5vcm1hbGl6ZSgxLCBkZXNj
ZW5kaW5nKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAg
ICBpZiAodHlwZSAhPSBudWxsKSB7CiAgICAgICAgICB2YWx1ZV9hID0gdmFsdWVfYS50b1N0cmlu
ZygpOwogICAgICAgICAgdmFsdWVfYiA9IHZhbHVlX2IudG9TdHJpbmcoKTsKICAgICAgICAgIGlm
ICh0eXBlLmVxdWFscygiaW50ZWdlciIpKSB7CiAgICAgICAgICAgIHZhbHVlX2EgPSB0dW5kcmEu
aW50ZWdlci5wYXJzZSgoU3RyaW5nKXZhbHVlX2EpOwogICAgICAgICAgICB2YWx1ZV9iID0gdHVu
ZHJhLmludGVnZXIucGFyc2UoKFN0cmluZyl2YWx1ZV9iKTsKICAgICAgICAgIH0gZWxzZSBpZiAo
dHlwZS5lcXVhbHMoImRlY2ltYWwiKSkgewogICAgICAgICAgICB2YWx1ZV9hID0gdHVuZHJhLmRl
Y2ltYWwucGFyc2UoKFN0cmluZyl2YWx1ZV9hKTsKICAgICAgICAgICAgdmFsdWVfYiA9IHR1bmRy
YS5kZWNpbWFsLnBhcnNlKChTdHJpbmcpdmFsdWVfYik7CiAgICAgICAgICB9IGVsc2UgaWYgKHR5
cGUuZXF1YWxzKCJkYXRldGltZSIpKSB7CiAgICAgICAgICAgIHZhbHVlX2EgPSB0dW5kcmEuZGF0
ZXRpbWUucGFyc2UoKFN0cmluZyl2YWx1ZV9hLCBwYXR0ZXJuKTsKICAgICAgICAgICAgdmFsdWVf
YiA9IHR1bmRyYS5kYXRldGltZS5wYXJzZSgoU3RyaW5nKXZhbHVlX2IsIHBhdHRlcm4pOwogICAg
ICAgICAgfSBlbHNlIGlmICh0eXBlLmVxdWFscygiZHVyYXRpb24iKSkgewogICAgICAgICAgICB2
YWx1ZV9hID0gdHVuZHJhLmludGVnZXIucGFyc2UodHVuZHJhLmR1cmF0aW9uLmZvcm1hdCgoU3Ry
aW5nKXZhbHVlX2EsIHBhdHRlcm4sICJtaWxsaXNlY29uZHMiKSk7CiAgICAgICAgICAgIHZhbHVl
X2IgPSB0dW5kcmEuaW50ZWdlci5wYXJzZSh0dW5kcmEuZHVyYXRpb24uZm9ybWF0KChTdHJpbmcp
dmFsdWVfYiwgcGF0dGVybiwgIm1pbGxpc2Vjb25kcyIpKTsKICAgICAgICAgIH0KICAgICAgICB9
CgogICAgICAgIGlmICh2YWx1ZV9hIGluc3RhbmNlb2YgQ29tcGFyYWJsZSAmJiB2YWx1ZV9iIGlu
c3RhbmNlb2YgQ29tcGFyYWJsZSkgewogICAgICAgICAgcmVzdWx0ID0gbm9ybWFsaXplKCgoQ29t
cGFyYWJsZSl2YWx1ZV9hKS5jb21wYXJlVG8oKENvbXBhcmFibGUpdmFsdWVfYiksIGRlc2NlbmRp
bmcpOwogICAgICAgICAgaWYgKHJlc3VsdCAhPSAwKSBicmVhazsKICAgICAgICB9CiAgICAgIH0K
ICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CgovLyBncm91cHMgdGhlIGdpdmVuIGxpc3Qg
YnkgdGhlIGdpdmVuIGtleXMKcHVibGljIHN0YXRpYyBJRGF0YVtdIGdyb3VwKElEYXRhW10gbGlz
dCwgU3RyaW5nW10ga2V5cykgewogIGlmIChsaXN0ID09IG51bGwgfHwgbGlzdC5sZW5ndGggPT0g
MCkgcmV0dXJuIGxpc3Q7CgogIGlmIChrZXlzID09IG51bGwgfHwga2V5cy5sZW5ndGggPT0gMCkg
ewogICAgSURhdGFbXSByZXN1bHQgPSBuZXcgSURhdGFbMV07CiAgICByZXN1bHRbMF0gPSBJRGF0
YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSByZXN1bHRbMF0uZ2V0
Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgImdyb3VwIiwgSURhdGFGYWN0b3J5
LmNyZWF0ZSgpKTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCAiaXRlbXMiLCBsaXN0KTsKICAg
IGN1cnNvci5kZXN0cm95KCk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0gZWxzZSB7CiAgICBqYXZh
LnV0aWwuTWFwPENvbXBvdW5kS2V5LCBqYXZhLnV0aWwuTGlzdDxJRGF0YT4+IGdyb3VwcyA9IG5l
dyBqYXZhLnV0aWwuVHJlZU1hcDxDb21wb3VuZEtleSwgamF2YS51dGlsLkxpc3Q8SURhdGE+Pigp
OwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewogICAgICBpZiAo
bGlzdFtpXSAhPSBudWxsKSB7CiAgICAgICAgQ29tcG91bmRLZXkga2V5ID0gbmV3IENvbXBvdW5k
S2V5KGtleXMsIGxpc3RbaV0pOwogICAgICAgIGphdmEudXRpbC5MaXN0PElEYXRhPiBhcnJheSA9
IGdyb3Vwcy5nZXQoa2V5KTsKICAgICAgICBpZiAoYXJyYXkgPT0gbnVsbCkgYXJyYXkgPSBuZXcg
amF2YS51dGlsLkxpbmtlZExpc3Q8SURhdGE+KCk7CiAgICAgICAgYXJyYXkuYWRkKGxpc3RbaV0p
OwogICAgICAgIGdyb3Vwcy5wdXQoa2V5LCBhcnJheSk7CiAgICAgIH0KICAgIH0KCiAgICBqYXZh
LnV0aWwuTGlzdDxJRGF0YT4gcmVzdWx0ID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Q8SURhdGE+
KGdyb3Vwcy5zaXplKCkpOwogICAgamF2YS51dGlsLkl0ZXJhdG9yPENvbXBvdW5kS2V5PiBpdGVy
YXRvciA9IGdyb3Vwcy5rZXlTZXQoKS5pdGVyYXRvcigpOwoKICAgIHdoaWxlKGl0ZXJhdG9yLmhh
c05leHQoKSkgewogICAgICBDb21wb3VuZEtleSBrZXkgPSBpdGVyYXRvci5uZXh0KCk7CiAgICAg
IGphdmEudXRpbC5MaXN0PElEYXRhPiBpdGVtcyA9IGdyb3Vwcy5nZXQoa2V5KTsKCiAgICAgIElE
YXRhIGdyb3VwID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAgICBJRGF0YUN1cnNvciBjdXJz
b3IgPSBncm91cC5nZXRDdXJzb3IoKTsKICAgICAgSURhdGFVdGlsLnB1dChjdXJzb3IsICJncm91
cCIsIGtleS5nZXRJRGF0YSgpKTsKICAgICAgSURhdGFVdGlsLnB1dChjdXJzb3IsICJpdGVtcyIs
IChJRGF0YVtdKWl0ZW1zLnRvQXJyYXkobmV3IElEYXRhWzBdKSk7CiAgICAgIGN1cnNvci5kZXN0
cm95KCk7CgogICAgICByZXN1bHQuYWRkKGdyb3VwKTsKICAgIH0KICAgIHJldHVybiAoSURhdGFb
XSlyZXN1bHQudG9BcnJheShuZXcgSURhdGFbMF0pOwogIH0KfQoKcHVibGljIHN0YXRpYyBjbGFz
cyBDb21wb3VuZEtleSBleHRlbmRzIGphdmEudXRpbC5MaW5rZWRIYXNoTWFwPFN0cmluZywgQ29t
cGFyYWJsZT4gaW1wbGVtZW50cyBDb21wYXJhYmxlPENvbXBvdW5kS2V5PiwgY29tLndtLnV0aWwu
Y29kZXIuSURhdGFDb2RhYmxlIHsKICBwdWJsaWMgQ29tcG91bmRLZXkoKSB7CiAgICBzdXBlcigp
OwogIH0KCiAgcHVibGljIENvbXBvdW5kS2V5KGludCBpbml0aWFsQ2FwYWNpdHkpIHsKICAgIHN1
cGVyKGluaXRpYWxDYXBhY2l0eSk7CiAgfQoKICBwdWJsaWMgQ29tcG91bmRLZXkoaW50IGluaXRp
YWxDYXBhY2l0eSwgZmxvYXQgbG9hZEZhY3RvcikgewogICAgc3VwZXIoaW5pdGlhbENhcGFjaXR5
LCBsb2FkRmFjdG9yKTsKICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShpbnQgaW5pdGlhbENhcGFj
aXR5LCBmbG9hdCBsb2FkRmFjdG9yLCBib29sZWFuIGFjY2Vzc09yZGVyKSB7CiAgICBzdXBlcihp
bml0aWFsQ2FwYWNpdHksIGxvYWRGYWN0b3IsIGFjY2Vzc09yZGVyKTsKICB9CgogIHB1YmxpYyBD
b21wb3VuZEtleShqYXZhLnV0aWwuTWFwPD8gZXh0ZW5kcyBTdHJpbmcsPyBleHRlbmRzIENvbXBh
cmFibGU+IG1hcCkgewogICAgc3VwZXIobWFwKTsKICB9CgogIHB1YmxpYyBDb21wb3VuZEtleShT
dHJpbmdbXSBrZXlzLCBJRGF0YSBkb2N1bWVudCkgewogICAgc3VwZXIoa2V5cy5sZW5ndGgpOwog
ICAgCiAgICAvLyBzZWVkIHdpdGgga2V5IHZhbHVlIHBhaXJzCiAgICBmb3IgKGludCBpID0gMDsg
aSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0IHZhbHVlID0gdHVuZHJhLnN1cHBv
cnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsKICAgICAgaWYgKHZhbHVlICE9IG51
bGwgJiYgdmFsdWUgaW5zdGFuY2VvZiBDb21wYXJhYmxlKSB7CiAgICAgICAgdGhpcy5wdXQoa2V5
c1tpXSwgKENvbXBhcmFibGUpdmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucHV0
KGtleXNbaV0sIG51bGwpOwogICAgICB9CiAgICB9ICAgIAogIH0KCiAgcHVibGljIGludCBjb21w
YXJlVG8oQ29tcG91bmRLZXkgb3RoZXIpIHsKICAgIGlmIChvdGhlciA9PSBudWxsKSByZXR1cm4g
MTsKCiAgICBpbnQgcmVzdWx0ID0gMDsKICAgIAogICAgamF2YS51dGlsLkl0ZXJhdG9yPFN0cmlu
Zz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJhdG9yKCk7CgogICAgd2hpbGUoaXRlcmF0
b3IuaGFzTmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkgPSBpdGVyYXRvci5uZXh0KCk7CiAgICAg
IENvbXBhcmFibGUgdGhpc1ZhbHVlID0gdGhpcy5nZXQoa2V5KTsKICAgICAgQ29tcGFyYWJsZSBv
dGhlclZhbHVlID0gb3RoZXIuZ2V0KGtleSk7CgogICAgICBpZiAodGhpc1ZhbHVlID09IG51bGwp
IHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSAhPSBudWxsKSByZXN1bHQgPSAtMTsKICAgICAgfSBl
bHNlIHsKICAgICAgICBpZiAob3RoZXJWYWx1ZSA9PSBudWxsKSB7CiAgICAgICAgICByZXN1bHQg
PSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSB0aGlzVmFsdWUuY29tcGFy
ZVRvKG90aGVyVmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAocmVzdWx0ICE9IDAp
IGJyZWFrOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIHB1YmxpYyBib29sZWFuIGVx
dWFscyhPYmplY3Qgb3RoZXIpIHsKICAgIGJvb2xlYW4gcmVzdWx0ID0gZmFsc2U7CgogICAgaWYg
KG90aGVyICE9IG51bGwgJiYgb3RoZXIgaW5zdGFuY2VvZiBDb21wb3VuZEtleSkgewogICAgICBy
ZXN1bHQgPSB0aGlzLmNvbXBhcmVUbygoQ29tcG91bmRLZXkpb3RoZXIpID09IDA7CiAgICB9CiAg
ICByZXR1cm4gcmVzdWx0OwogIH0KCiAgcHVibGljIElEYXRhIGdldElEYXRhKCkgewogICAgSURh
dGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAgamF2YS51dGlsLkl0ZXJhdG9y
PFN0cmluZz4gaXRlcmF0b3IgPSB0aGlzLmtleVNldCgpLml0ZXJhdG9yKCk7CiAgICB3aGlsZShp
dGVyYXRvci5oYXNOZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGl0ZXJhdG9yLm5leHQoKTsK
ICAgICAgT2JqZWN0IHZhbHVlID0gdGhpcy5nZXQoa2V5KTsKICAgICAgdHVuZHJhLnN1cHBvcnQu
ZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCB2YWx1ZSk7CiAgICB9CiAgICByZXR1cm4gb3V0cHV0
OwogIH0KCiAgcHVibGljIHZvaWQgc2V0SURhdGEoSURhdGEgaW5wdXQpIHsKICAgIGlmIChpbnB1
dCA9PSBudWxsKSByZXR1cm47CgogICAgdGhpcy5jbGVhcigpOwoKICAgIElEYXRhQ3Vyc29yIGN1
cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgd2hpbGUoY3Vyc29yLm5leHQoKSkgewogICAg
ICBTdHJpbmcga2V5ID0gY3Vyc29yLmdldEtleSgpOwogICAgICBPYmplY3QgdmFsdWUgPSBjdXJz
b3IuZ2V0VmFsdWUoKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYmIHZhbHVlIGluc3RhbmNl
b2YgQ29tcGFyYWJsZSkgdGhpcy5wdXQoa2V5LCAoQ29tcGFyYWJsZSl2YWx1ZSk7CiAgICB9CiAg
ICBjdXJzb3IuZGVzdHJveSgpOwogIH0KfQoKLy8gcmV0dXJucyB0aGUgdmFsdWVzIGFzc29jaWF0
ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gZWFjaCBpdGVtIGluIHRoZSBnaXZlbiBJRGF0YVtd
IGRvY3VtZW50IGxpc3QKcHVibGljIHN0YXRpYyBPYmplY3RbXSB2YWx1ZXMoSURhdGFbXSBpbnB1
dCwgU3RyaW5nIGtleSwgT2JqZWN0IGRlZmF1bHRWYWx1ZSkgewogIGlmIChpbnB1dCA9PSBudWxs
IHx8IGtleSA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgamF2YS51dGlsLlNldDxDbGFzczw/Pj4g
Y2xhc3NlcyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxDbGFzczw/Pj4oKTsKICBqYXZh
LnV0aWwuTGlzdCBsaXN0ID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3QoaW5wdXQubGVuZ3RoKTsK
ICAKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBPYmplY3Qg
dmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaW5wdXRbaV0sIGtleSwgZGVmYXVs
dFZhbHVlKTsKICAgIGlmICh2YWx1ZSAhPSBudWxsKSBjbGFzc2VzLmFkZCh2YWx1ZS5nZXRDbGFz
cygpKTsKICAgIGxpc3QuYWRkKHZhbHVlKTsKICB9CiAgCiAgQ2xhc3M8Pz4gbmVhcmVzdEFuY2Vz
dG9yID0gdHVuZHJhLnN1cHBvcnQub2JqZWN0Lm5lYXJlc3RBbmNlc3RvcihjbGFzc2VzKTsKICBp
ZiAobmVhcmVzdEFuY2VzdG9yID09IG51bGwpIG5lYXJlc3RBbmNlc3RvciA9IE9iamVjdC5jbGFz
czsKICAKICByZXR1cm4gbGlzdC50b0FycmF5KChPYmplY3RbXSlqYXZhLmxhbmcucmVmbGVjdC5B
cnJheS5uZXdJbnN0YW5jZShuZWFyZXN0QW5jZXN0b3IsIDApKTsKfQoJ</value>
  <value name="encodeutf8">true</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
    <value>permafrost.tundra.lang.BooleanHelper</value>
  </array>
</Values>
