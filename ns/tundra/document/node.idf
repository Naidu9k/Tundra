<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gcmV0dXJucyB3aGV0aGVyIHR3byBkb2N1bWVudHMgYXJlIGVxdWFsCnB1YmxpYyBzdGF0aWMg
Ym9vbGVhbiBlcXVhbChJRGF0YSB4LCBJRGF0YSB5KSB7CiAgcmV0dXJuIHR1bmRyYS5vYmplY3Qu
ZXF1YWwoeCwgeSk7Cn0KCi8vIHJldHVybnMgYWxsIHRoZSBrZXlzIGluIHRoZSBnaXZlbiBkb2N1
bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5c2V0KElEYXRh
IGlucHV0KSB7CiAgamF2YS51dGlsLkxpc3Q8U3RyaW5nPiBrZXlzID0gbmV3IGphdmEudXRpbC5B
cnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNv
ciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsK
ICAgICAga2V5cy5hZGQoY3Vyc29yLmdldEtleSgpKTsKICAgIH0KICAgIGN1cnNvci5kZXN0cm95
KCk7CiAgfQogIHJldHVybiAoU3RyaW5nW10pa2V5cy50b0FycmF5KG5ldyBTdHJpbmdbMF0pOwp9
CgovLyByZXR1cm5zIGFsbCB0aGUgdmFsdWVzIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0
cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgT2JqZWN0W10gdmFsdWVzZXQoSURhdGEgaW5wdXQpIHsK
ICBqYXZhLnV0aWwuTGlzdDxPYmplY3Q+IHZhbHVlcyA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0
PE9iamVjdD4oKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29y
ID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgIHZh
bHVlcy5hZGQoY3Vyc29yLmdldFZhbHVlKCkpOwogICAgfQogICAgY3Vyc29yLmRlc3Ryb3koKTsK
ICB9CiAgcmV0dXJuIChPYmplY3RbXSl2YWx1ZXMudG9BcnJheShuZXcgT2JqZWN0WzBdKTsKfQoK
Ly8gbWVyZ2VzIG11bHRpcGxlIElEYXRhIGRvY3VtZW50cyBpbnRvIGEgc2luZ2xlIGRvY3VtZW50
CnB1YmxpYyBzdGF0aWMgSURhdGEgbWVyZ2UoSURhdGFbXSBpbnB1dCkgewogIElEYXRhIG91dHB1
dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgICBJRGF0YVV0aWwubWVy
Z2UoaW5wdXRbaV0sIG91dHB1dCk7CiAgICB9CiAgfQogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJl
dHVybnMgdGhlIG51bWJlciBvZiB0b3AtbGV2ZWwge2tleSwgdmFsdWV9IHBhaXJzIGluIHRoZSBn
aXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIGludCBzaXplKElEYXRhIGlucHV0KSB7
CiAgaW50IHNpemUgPSAwOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBj
dXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHNpemUgPSBJRGF0YVV0aWwuc2l6ZShjdXJz
b3IpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIHNpemU7Cn0KCi8vIHJldHVy
bnMgYSBjbG9uZSBvZiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0
YSBkdXBsaWNhdGUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgdGhyb3dzIFNlcnZpY2VF
eGNlcHRpb24gewogIElEYXRhIG91dHB1dCA9IG51bGw7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsK
ICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgdHJ5IHsKICAg
ICAgaWYgKHJlY3Vyc2UpIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuZGVlcENsb25lKGlu
cHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuY2xvbmUoaW5w
dXQpOwogICAgICB9CiAgICB9IGNhdGNoIChqYXZhLmlvLklPRXhjZXB0aW9uIGV4KSB7CiAgICAg
IHR1bmRyYS5leGNlcHRpb24ucmFpc2UoZXgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3Vyc29y
LmRlc3Ryb3koKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUg
dmFsdWUgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1
YmxpYyBzdGF0aWMgSURhdGEgZHJvcChJRGF0YSBpbnB1dCwgU3RyaW5nIGtleSkgewogIGlmIChp
bnB1dCAhPSBudWxsICYmIGtleSAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBp
bnB1dC5nZXRDdXJzb3IoKTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXkpOwogICAg
Y3Vyc29yLmRlc3Ryb3koKTsKCiAgICBpZiAoS2V5LmlzRnVsbHlRdWFsaWZpZWQoa2V5KSkgZHJv
cChpbnB1dCwgS2V5LnBhcnNlKGtleSkpOwogIH0KICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHJlbW92
ZXMgdGhlIHZhbHVlIHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1
bWVudApwcm90ZWN0ZWQgc3RhdGljIElEYXRhIGRyb3AoSURhdGEgaW5wdXQsIGphdmEudXRpbC5R
dWV1ZTxLZXk+IGtleXMpIHsKICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBrZXlzICE9IG51bGwgJiYg
a2V5cy5zaXplKCkgPiAwKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJz
b3IoKTsKICAgIEtleSBrZXkgPSBrZXlzLnJlbW92ZSgpOwoKICAgIGlmIChrZXlzLnNpemUoKSA+
IDApIHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9
IElEYXRhVXRpbC5nZXRJRGF0YUFycmF5KGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICAg
IGRyb3AodHVuZHJhLmxpc3Qub2JqZWN0LmdldChhcnJheSwga2V5LmdldEluZGV4KCkpLCBrZXlz
KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkcm9wKElEYXRhVXRpbC5nZXRJRGF0YShjdXJzb3Is
IGtleS50b1N0cmluZygpKSwga2V5cyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChr
ZXkuaGFzSW5kZXgoKSkgewogICAgICAgIE9iamVjdFtdIGFycmF5ID0gSURhdGFVdGlsLmdldE9i
amVjdEFycmF5KGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICAgIElEYXRhVXRpbC5wdXQo
Y3Vyc29yLCBrZXkudG9TdHJpbmcoKSwgdHVuZHJhLmxpc3Qub2JqZWN0LmRyb3AoYXJyYXksIGtl
eS5nZXRJbmRleCgpKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgSURhdGFVdGlsLnJlbW92ZShj
dXJzb3IsIGtleS50b1N0cmluZygpKTsKICAgICAgfQogICAgfQogICAgY3Vyc29yLmRlc3Ryb3ko
KTsKICB9CiAgcmV0dXJuIGlucHV0Owp9CgovLyB2aXNpdHMgZWFjaCBlbGVtZW50IGluIHRoZSBn
aXZlbiBJRGF0YSBkb2N1bWVudCwgY2FsbHMgdGhlIGdpdmVuIHNlcnZpY2UgdG8gY29udmVydCB0
aGUgZWxlbWVudCwgYW5kIGNyZWF0ZXMgYSBuZXcgSURhdGEgZG9jdW1lbnQgd2l0aCB0aGUgcmVz
dWx0aW5nIGVsZW1lbnRzCnB1YmxpYyBzdGF0aWMgSURhdGEgbWFwKElEYXRhIGlucHV0LCBTdHJp
bmcgc2VydmljZSwgSURhdGEgcGlwZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIGtleU91
dHB1dCwgU3RyaW5nIHZhbHVlSW5wdXQsIFN0cmluZyB2YWx1ZU91dHB1dCwgQ2xhc3MgdmFsdWVD
bGFzcywgYm9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgSURhdGEg
b3V0cHV0ID0gbnVsbDsKCiAgaWYgKGlucHV0ICE9IG51bGwgJiYgc2VydmljZSAhPSBudWxsKSB7
CiAgICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogICAgb3V0cHV0ID0gSURh
dGFGYWN0b3J5LmNyZWF0ZSgpOwogICAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29y
KCk7CgogICAgaWYgKGtleUlucHV0ID09IG51bGwpIGtleUlucHV0ID0gIiRrZXkiOwogICAgaWYg
KGtleU91dHB1dCA9PSBudWxsKSBrZXlPdXRwdXQgPSBrZXlJbnB1dDsKICAgIGlmICh2YWx1ZUlu
cHV0ID09IG51bGwpIHZhbHVlSW5wdXQgPSAiJHZhbHVlIjsKICAgIGlmICh2YWx1ZU91dHB1dCA9
PSBudWxsKSB2YWx1ZU91dHB1dCA9IHZhbHVlSW5wdXQ7CiAgICBpZiAocGlwZWxpbmUgPT0gbnVs
bCkgcGlwZWxpbmUgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CgogICAgdHJ5IHsKICAgICAgd2hp
bGUoaWMubmV4dCgpKSB7CiAgICAgICAgVHVwbGU8T2JqZWN0PiB0dXBsZSA9IG5ldyBUdXBsZTxP
YmplY3Q+KGljLmdldEtleSgpLCBpYy5nZXRWYWx1ZSgpKTsKCiAgICAgICAgaWYgKHJlY3Vyc2Ug
JiYgdHVwbGUudmFsdWUgIT0gbnVsbCkgewogICAgICAgICAgaWYgKHR1cGxlLnZhbHVlIGluc3Rh
bmNlb2YgSURhdGEpIHsKICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBtYXAoKElEYXRhKXR1cGxl
LnZhbHVlLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1
dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MsIHJlY3Vyc2UpOwogICAgICAgICAgfSBlbHNlIGlm
ICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdHVwbGUudmFsdWUgaW5zdGFuY2Vv
ZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgICAgICBJRGF0YVtdIGlhcnkgPSB0dXBsZS52
YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl0dXBsZS52YWx1ZSA6ICgoY29tLndt
LnV0aWwuVGFibGUpdHVwbGUudmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAgICBJRGF0YVtd
IG9hcnkgPSBuZXcgSURhdGFbaWFyeS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0g
MDsgaSA8IGlhcnkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBvYXJ5W2ldID0gbWFwKGlh
cnlbaV0sIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0
LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcywgcmVjdXJzZSk7CiAgICAgICAgICAgIH0KICAgICAg
ICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1
ZSBpbnN0YW5jZW9mIFN0cmluZ1tdW10pIHsKICAgICAgICAgICAgU3RyaW5nW11bXSBpYXJ5ID0g
KFN0cmluZ1tdW10pdHVwbGUudmFsdWU7CiAgICAgICAgICAgIFN0cmluZ1tdW10gb2FyeSA9IG5l
dyBTdHJpbmdbaWFyeS5sZW5ndGhdW107CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg
aWFyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIGlmIChpYXJ5W2ldICE9IG51bGwpIHsK
ICAgICAgICAgICAgICAgIG9hcnlbaV0gPSBuZXcgU3RyaW5nW2lhcnlbaV0ubGVuZ3RoXTsKICAg
ICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgaWFyeVtpXS5sZW5ndGg7IGorKykgewog
ICAgICAgICAgICAgICAgICBUdXBsZTxTdHJpbmc+IHQgPSBtYXAobmV3IFR1cGxlPFN0cmluZz4o
dHVwbGUua2V5LCBpYXJ5W2ldW2pdKSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlP
dXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAgICAgICAg
ICAgICAgb2FyeVtpXVtqXSA9IHQudmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAg
ICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAg
ICAgICBTdHJpbmdbXSBpYXJ5ID0gKFN0cmluZ1tdKXR1cGxlLnZhbHVlOwogICAgICAgICAgICBT
dHJpbmdbXSBvYXJ5ID0gbmV3IFN0cmluZ1tpYXJ5Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAo
aW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIFR1cGxlPFN0
cmluZz4gdCA9IG1hcChuZXcgVHVwbGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2
aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRw
dXQsIHZhbHVlQ2xhc3MpOwogICAgICAgICAgICAgIG9hcnlbaV0gPSB0LnZhbHVlOwogICAgICAg
ICAgICB9CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBp
ZiAodHVwbGUudmFsdWUgaW5zdGFuY2VvZiBPYmplY3RbXSkgewogICAgICAgICAgICBPYmplY3Rb
XSBpYXJ5ID0gKE9iamVjdFtdKXR1cGxlLnZhbHVlOwogICAgICAgICAgICBPYmplY3RbXSBvYXJ5
ID0gbmV3IE9iamVjdFtpYXJ5Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgaWFyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIFR1cGxlPE9iamVjdD4gdCA9IG1h
cChuZXcgVHVwbGU8T2JqZWN0Pih0dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2aWNlLCBwaXBlbGlu
ZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xh
c3MpOwogICAgICAgICAgICAgIG9hcnlbaV0gPSB0LnZhbHVlOwogICAgICAgICAgICB9CiAgICAg
ICAgICAgIHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg
dHVwbGUgPSBtYXAodHVwbGUsIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0
LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgSURhdGFVdGls
LnB1dChvYywgdHVwbGUua2V5LCB0dXBsZS52YWx1ZSk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7
CiAgICAgIGljLmRlc3Ryb3koKTsKICAgICAgb2MuZGVzdHJveSgpOwogICAgfQogIH0gZWxzZSB7
CiAgICBvdXRwdXQgPSBkdXBsaWNhdGUoaW5wdXQsIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91
dHB1dDsKfQoKLy8gd3JhcHBlciBjbGFzcyBmb3Ige2tleSwgdmFsdWV9IHR1cGxlcwpwcm90ZWN0
ZWQgc3RhdGljIGNsYXNzIFR1cGxlPFQ+IHsgCiAgcHVibGljIFN0cmluZyBrZXk7CiAgcHVibGlj
IFQgdmFsdWU7CiAgcHVibGljIFR1cGxlKFN0cmluZyBrZXksIFQgdmFsdWUpIHsgCiAgICB0aGlz
LmtleSA9IGtleTsgCiAgICB0aGlzLnZhbHVlID0gdmFsdWU7IAogIH0KfQoKLy8gY29udmVydHMg
dGhlIGdpdmVuIGVsZW1lbnQgYnkgY2FsbGluZyB0aGUgZ2l2ZW4gc2VydmljZSwgYW5kIHJldHVy
bnMgdGhlIHJlc3VsdApwcm90ZWN0ZWQgc3RhdGljIDxUPiBUdXBsZTxUPiBtYXAoVHVwbGU8VD4g
dHVwbGUsIFN0cmluZyBzZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBT
dHJpbmcga2V5T3V0cHV0LCBTdHJpbmcgdmFsdWVJbnB1dCwgU3RyaW5nIHZhbHVlT3V0cHV0LCBD
bGFzcyB2YWx1ZUNsYXNzKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgaWYgKHR1cGxlLnZh
bHVlID09IG51bGwgfHwgdmFsdWVDbGFzcyA9PSBudWxsIHx8IHZhbHVlQ2xhc3MuaXNJbnN0YW5j
ZSh0dXBsZS52YWx1ZSkpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IHBpcGVsaW5lLmdldEN1
cnNvcigpOwogICAgSURhdGFVdGlsLnB1dChjdXJzb3IsIGtleUlucHV0LCB0dXBsZS5rZXkpOwog
ICAgSURhdGFVdGlsLnB1dChjdXJzb3IsIHZhbHVlSW5wdXQsIHR1cGxlLnZhbHVlKTsKICAgIGN1
cnNvci5kZXN0cm95KCk7CgogICAgcGlwZWxpbmUgPSB0dW5kcmEuc2VydmljZS5pbnZva2Uoc2Vy
dmljZSwgcGlwZWxpbmUpOwoKICAgIC8vIGNsZWFuIHVwIHRoZSBpbnB1dCBwaXBlbGluZQogICAg
Y3Vyc29yID0gcGlwZWxpbmUuZ2V0Q3Vyc29yKCk7CiAgICB0dXBsZS5rZXkgPSBJRGF0YVV0aWwu
Z2V0U3RyaW5nKGN1cnNvciwga2V5T3V0cHV0KTsKICAgIHR1cGxlLnZhbHVlID0gKFQpSURhdGFV
dGlsLmdldChjdXJzb3IsIHZhbHVlT3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29y
LCBrZXlJbnB1dCk7CiAgICBpZiAoIWtleUlucHV0LmVxdWFscyhrZXlPdXRwdXQpKSBJRGF0YVV0
aWwucmVtb3ZlKGN1cnNvciwga2V5T3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29y
LCB2YWx1ZUlucHV0KTsKICAgIGlmICghdmFsdWVJbnB1dC5lcXVhbHModmFsdWVPdXRwdXQpKSBJ
RGF0YVV0aWwucmVtb3ZlKGN1cnNvciwgdmFsdWVPdXRwdXQpOwogICAgY3Vyc29yLmRlc3Ryb3ko
KTsKICB9ICAKICByZXR1cm4gdHVwbGU7Cn0KCi8vIGludm9rZXMgdGhlIGdpdmVuIHNlcnZpY2Ug
Zm9yIGVhY2gge2tleSwgdmFsdWV9IHBhaXIgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1
YmxpYyBzdGF0aWMgdm9pZCBlYWNoKElEYXRhIGlucHV0LCBTdHJpbmcgc2VydmljZSwgSURhdGEg
cGlwZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIHZhbHVlSW5wdXQsIENsYXNzIHZhbHVl
Q2xhc3MsIGJvb2xlYW4gcmVjdXJzZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIG1hcChp
bnB1dCwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBudWxsLCB2YWx1ZUlucHV0LCBudWxs
LCB2YWx1ZUNsYXNzLCByZWN1cnNlKTsKfQoKLy8gd3JhcHBlciBjbGFzcyBmb3IgZnVsbHkgcXVh
bGlmaWVkIElEYXRhIGtleXMKcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBLZXkgewogIHB1YmxpYyBz
dGF0aWMgZmluYWwgU3RyaW5nIFNFUEFSQVRPUiA9ICIvIjsKICBwdWJsaWMgc3RhdGljIGZpbmFs
IGphdmEudXRpbC5yZWdleC5QYXR0ZXJuIElOREVYX1BBVFRFUk4gPSBqYXZhLnV0aWwucmVnZXgu
UGF0dGVybi5jb21waWxlKCJcXFsoLT9cXGQrPylcXF0kIik7CgogIHByb3RlY3RlZCBib29sZWFu
IGhhc0luZGV4ID0gZmFsc2U7CiAgcHJvdGVjdGVkIGludCBpbmRleCA9IDA7CiAgcHJvdGVjdGVk
IFN0cmluZyBrZXkgPSBudWxsOwoKICBwdWJsaWMgS2V5KFN0cmluZyBrZXkpIHsKICAgIGphdmEu
dXRpbC5yZWdleC5NYXRjaGVyIG1hdGNoZXIgPSBJTkRFWF9QQVRURVJOLm1hdGNoZXIoa2V5KTsK
ICAgIFN0cmluZ0J1ZmZlciBidWZmZXIgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICB3aGlsZSht
YXRjaGVyLmZpbmQoKSkgewogICAgICBoYXNJbmRleCA9IHRydWU7CiAgICAgIGluZGV4ID0gSW50
ZWdlci5wYXJzZUludChtYXRjaGVyLmdyb3VwKDEpKTsKICAgICAgbWF0Y2hlci5hcHBlbmRSZXBs
YWNlbWVudChidWZmZXIsICIiKTsKICAgIH0KICAgIG1hdGNoZXIuYXBwZW5kVGFpbChidWZmZXIp
OwogICAgdGhpcy5rZXkgPSBidWZmZXIudG9TdHJpbmcoKTsKICB9CgogIHB1YmxpYyBib29sZWFu
IGhhc0luZGV4KCkgewogICAgcmV0dXJuIGhhc0luZGV4OwogIH0KCiAgcHVibGljIGludCBnZXRJ
bmRleCgpIHsKICAgIHJldHVybiBpbmRleDsKICB9CgogIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmco
KSB7CiAgICByZXR1cm4ga2V5OwogIH0KCiAgcHVibGljIHN0YXRpYyBqYXZhLnV0aWwuUXVldWU8
S2V5PiBwYXJzZShTdHJpbmcga2V5KSB7CiAgICBTdHJpbmdbXSBwYXJ0cyA9IGtleS5zcGxpdChT
RVBBUkFUT1IpOwogICAgamF2YS51dGlsLlF1ZXVlPEtleT4gcXVldWUgPSBuZXcgamF2YS51dGls
LkFycmF5RGVxdWU8S2V5PihwYXJ0cy5sZW5ndGgpOwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDwg
cGFydHMubGVuZ3RoOyBpKyspIHsKICAgICAgcXVldWUuYWRkKG5ldyBLZXkocGFydHNbaV0pKTsK
ICAgIH0KICAgIHJldHVybiBxdWV1ZTsKICB9CgogIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBpc0Z1
bGx5UXVhbGlmaWVkKFN0cmluZyBrZXkpIHsKICAgIHJldHVybiBrZXkgIT0gbnVsbCAmJiAoa2V5
LmNvbnRhaW5zKFNFUEFSQVRPUikgfHwgSU5ERVhfUEFUVEVSTi5tYXRjaGVyKGtleSkuZmluZCgp
KTsKICB9Cn0KCi8vIHJldHVybnMgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4g
a2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgT2JqZWN0IGdl
dChJRGF0YSBpbnB1dCwgU3RyaW5nIGtleSkgewogIE9iamVjdCB2YWx1ZSA9IG51bGw7CiAgaWYg
KGlucHV0ICE9IG51bGwgJiYga2V5ICE9IG51bGwpIHsKICAgIC8vIHRyeSBmaW5kaW5nIGEgdmFs
dWUgdGhhdCBtYXRjaGVzIHRoZSBsaXRlcmFsIGtleQogICAgSURhdGFDdXJzb3IgY3Vyc29yID0g
aW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB0cnkgewogICAgICB2YWx1ZSA9IElEYXRhVXRpbC5nZXQo
Y3Vyc29yLCBrZXkpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3Vyc29yLmRlc3Ryb3koKTsKICAg
IH0KCiAgICAvLyBpZiB2YWx1ZSB3YXNuJ3QgZm91bmQgdXNpbmcgdGhlIGxpdGVyYWwga2V5LCB0
aGUga2V5IGNvdWxkIGJlIGZ1bGx5IHF1YWxpZmllZAogICAgaWYgKHZhbHVlID09IG51bGwgJiYg
S2V5LmlzRnVsbHlRdWFsaWZpZWQoa2V5KSkgdmFsdWUgPSBnZXQoaW5wdXQsIEtleS5wYXJzZShr
ZXkpKTsKICB9CiAgcmV0dXJuIHZhbHVlOwp9CgovLyBnZXRzIGEgdmFsdWUgZnJvbSBhbiBJRGF0
YSBkb2N1bWVudCB3aXRoIGEgZnVsbHkgcXVhbGlmaWVkIGtleQpwcm90ZWN0ZWQgc3RhdGljIE9i
amVjdCBnZXQoSURhdGEgaW5wdXQsIGphdmEudXRpbC5RdWV1ZTxLZXk+IGtleXMpIHsKICBPYmpl
Y3QgdmFsdWUgPSBudWxsOwoKICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBrZXlzICE9IG51bGwgJiYg
a2V5cy5zaXplKCkgPiAwKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJz
b3IoKTsKICAgIEtleSBrZXkgPSBrZXlzLnJlbW92ZSgpOwoKICAgIGlmIChrZXlzLnNpemUoKSA+
IDApIHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9
IElEYXRhVXRpbC5nZXRJRGF0YUFycmF5KGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICAg
IHZhbHVlID0gZ2V0KHR1bmRyYS5saXN0Lm9iamVjdC5nZXQoYXJyYXksIGtleS5nZXRJbmRleCgp
KSwga2V5cyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsdWUgPSBnZXQoSURhdGFVdGlsLmdl
dElEYXRhKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpLCBrZXlzKTsKICAgICAgfQogICAgfSBlbHNl
IHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAgICAgICAgT2JqZWN0W10gYXJyYXkgPSBJ
RGF0YVV0aWwuZ2V0T2JqZWN0QXJyYXkoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSk7CiAgICAgICAg
dmFsdWUgPSB0dW5kcmEubGlzdC5vYmplY3QuZ2V0KGFycmF5LCBrZXkuZ2V0SW5kZXgoKSk7CiAg
ICAgIH0gZWxzZSB7CiAgICAgICAgdmFsdWUgPSBJRGF0YVV0aWwuZ2V0KGN1cnNvciwga2V5LnRv
U3RyaW5nKCkpOwogICAgICB9CiAgICB9CgogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CgogIHJl
dHVybiB2YWx1ZTsKfQoKLy8gc2V0cyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZl
biBrZXkgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgcHV0
KElEYXRhIGlucHV0LCBTdHJpbmcga2V5LCBPYmplY3QgdmFsdWUpIHsKICByZXR1cm4gcHV0KGlu
cHV0LCBrZXkgPT0gbnVsbCA/IG51bGwgOiBLZXkucGFyc2Uoa2V5KSwgdmFsdWUpOwp9CgovLyBz
ZXRzIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGZ1bGx5IHF1YWxpZmllZCBr
ZXkgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnByb3RlY3RlZCBzdGF0aWMgSURhdGEgcHV0
KElEYXRhIGlucHV0LCBqYXZhLnV0aWwuUXVldWU8S2V5PiBrZXlzLCBPYmplY3QgdmFsdWUpIHsK
ICBpZiAoa2V5cyAhPSBudWxsICYmIGtleXMuc2l6ZSgpID4gMCkgewogICAgaWYgKGlucHV0ID09
IG51bGwpIGlucHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwoKICAgIElEYXRhQ3Vyc29yIGN1
cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgS2V5IGtleSA9IGtleXMucmVtb3ZlKCk7Cgog
ICAgaWYgKGtleXMuc2l6ZSgpID4gMCkgewogICAgICBpZiAoa2V5Lmhhc0luZGV4KCkpIHsKICAg
ICAgICBJRGF0YVtdIGFycmF5ID0gSURhdGFVdGlsLmdldElEYXRhQXJyYXkoY3Vyc29yLCBrZXku
dG9TdHJpbmcoKSk7CiAgICAgICAgSURhdGEgY2hpbGQgPSBudWxsOwogICAgICAgIHRyeSB7IGNo
aWxkID0gdHVuZHJhLmxpc3Qub2JqZWN0LmdldChhcnJheSwga2V5LmdldEluZGV4KCkpOyB9IGNh
dGNoKEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiBleCkgeyB9CiAgICAgICAgdmFsdWUg
PSB0dW5kcmEubGlzdC5vYmplY3QucHV0KGFycmF5LCBwdXQoY2hpbGQsIGtleXMsIHZhbHVlKSwg
a2V5LmdldEluZGV4KCksIElEYXRhLmNsYXNzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWx1
ZSA9IHB1dChJRGF0YVV0aWwuZ2V0SURhdGEoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSksIGtleXMs
IHZhbHVlKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChrZXkuaGFzSW5kZXgoKSkgewogICAgICBD
bGFzcyBrbGFzcyA9IE9iamVjdC5jbGFzczsKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAg
ICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgIGtsYXNzID0gU3Ry
aW5nLmNsYXNzOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewog
ICAgICAgICAga2xhc3MgPSBJRGF0YS5jbGFzczsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFs
dWUgPSB0dW5kcmEubGlzdC5vYmplY3QucHV0KElEYXRhVXRpbC5nZXRPYmplY3RBcnJheShjdXJz
b3IsIGtleS50b1N0cmluZygpKSwgdmFsdWUsIGtleS5nZXRJbmRleCgpLCBrbGFzcyk7CiAgICB9
CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwga2V5LnRvU3RyaW5nKCksIHZhbHVlKTsKICAgIGN1
cnNvci5kZXN0cm95KCk7CiAgfQoKICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHJlbmFtZXMgYSBrZXkg
ZnJvbSBzb3VyY2UgdG8gdGFyZ2V0IHdpdGhpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVi
bGljIHN0YXRpYyBJRGF0YSByZW5hbWUoSURhdGEgaW5wdXQsIFN0cmluZyBzb3VyY2UsIFN0cmlu
ZyB0YXJnZXQpIHsKICByZXR1cm4gZHJvcChjb3B5KGlucHV0LCBzb3VyY2UsIHRhcmdldCksIHNv
dXJjZSk7Cn0KCi8vIGNvcGllcyBhIHZhbHVlIGZyb20gc291cmNlIGtleSB0byB0YXJnZXQga2V5
IHdpdGhpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBjb3B5
KElEYXRhIGlucHV0LCBTdHJpbmcgc291cmNlLCBTdHJpbmcgdGFyZ2V0KSB7CiAgaWYgKHNvdXJj
ZS5lcXVhbHModGFyZ2V0KSkgcmV0dXJuIGlucHV0OwogIHJldHVybiBwdXQoaW5wdXQsIHRhcmdl
dCwgZ2V0KGlucHV0LCBzb3VyY2UpKTsKfQoKLy8gcmVtb3ZlcyBhbGwgbnVsbCB2YWx1ZXMgZnJv
bSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBjb21wYWN0KElE
YXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwoKICBp
ZiAoaW5wdXQgIT0gbnVsbCkgewogICAgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwog
ICAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIElEYXRhQ3Vyc29yIG9j
ID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICAgIHRyeSB7CiAgICAgIHdoaWxlKGljLm5leHQoKSkg
ewogICAgICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXkoKTsKICAgICAgICBPYmplY3QgdmFsdWUg
PSBpYy5nZXRWYWx1ZSgpOwoKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgICAg
aWYgKHJlY3Vyc2UpIHsKICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsK
ICAgICAgICAgICAgICB2YWx1ZSA9IGNvbXBhY3QoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAg
ICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10pIHsKICAgICAgICAg
ICAgICBJRGF0YVtdIGFycmF5ID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoKElEYXRhW10p
dmFsdWUpOwogICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBp
KyspIHsKICAgICAgICAgICAgICAgIGFycmF5W2ldID0gY29tcGFjdChhcnJheVtpXSwgcmVjdXJz
ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgICAg
ICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXVtdKSB7CiAgICAgICAgICAg
ICAgU3RyaW5nW11bXSBhcnJheSA9IChTdHJpbmdbXVtdKXZhbHVlOwogICAgICAgICAgICAgIGZv
ciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGFy
cmF5W2ldID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoYXJyYXlbaV0pOwogICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICB2YWx1ZSA9IGFycmF5OwogICAgICAgICAgICB9IGVsc2UgaWYg
KHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRy
YS5saXN0Lm9iamVjdC5jb21wYWN0KChTdHJpbmdbXSl2YWx1ZSk7CiAgICAgICAgICAgIH0gZWxz
ZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3RbXSkgewogICAgICAgICAgICAgIHZhbHVlID0g
dHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoKE9iamVjdFtdKXZhbHVlKTsKICAgICAgICAgICAg
fQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIElEYXRh
VXRpbC5wdXQob2MsIGtleSwgdmFsdWUpOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBp
Yy5kZXN0cm95KCk7CiAgICAgIG9jLmRlc3Ryb3koKTsKICAgIH0KICB9CgogIHJldHVybiBvdXRw
dXQ7Cn0KCi8vIHJldHVybnMgYSBuZXcgSURhdGEgZG9jdW1lbnQsIHdoZXJlIGFsbCBJRGF0YXMg
YXJlIGltcGxlbWVudGVkIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwKLy8gZnVsbHkgcXVh
bGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnB1YmxpYyBz
dGF0aWMgSURhdGEgbm9ybWFsaXplKElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBp
ZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFj
dG9yeS5jcmVhdGUoKTsKICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwoKICB0
cnkgewogICAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXko
KTsKICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICAgIGlmIChyZWN1cnNl
ICYmIHZhbHVlICE9IG51bGwpIHsKICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkg
ewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAg
ICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5j
ZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICBJRGF0YVtdIGlhcnkgPSB2YWx1ZSBp
bnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUp
dmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAgSURhdGFbXSBvYXJ5ID0gbmV3IElEYXRhW2lh
cnkubGVuZ3RoXTsKICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkr
Kykgb2FyeVtpXSA9IG5vcm1hbGl6ZShpYXJ5W2ldLCByZWN1cnNlKTsKICAgICAgICAgIHZhbHVl
ID0gb2FyeTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHV0KG91dHB1dCwga2V5LCB2YWx1ZSk7
CiAgICB9CiAgfSBmaW5hbGx5IHsKICAgIGljLmRlc3Ryb3koKTsKICB9CgogIHJldHVybiBvdXRw
dXQ7Cn0=</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
