<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJl
dHVybiBkb2N1bWVudDsKCiAgZm9yIChpbnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsg
aSsrKSB7CiAgICBpZiAoYW1lbmRtZW50c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhQ3Vyc29y
IGN1cnNvciA9IGFtZW5kbWVudHNbaV0uZ2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImtleSIpOwogICAgICBTdHJpbmcgdmFsdWUgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInZhbHVlIik7CiAgICAgIFN0cmluZyBjb25kaXRp
b24gPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImNvbmRpdGlvbiIpOwogICAgICBjdXJz
b3IuZGVzdHJveSgpOwoKICAgICAga2V5ID0gdHVuZHJhLnN0cmluZy5zdWJzdGl0dXRlKGtleSwg
c2NvcGUpOwogICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSh2YWx1ZSwgc2Nv
cGUpOwoKICAgICAgaWYgKChjb25kaXRpb24gPT0gbnVsbCkgfHwgQ29uZGl0aW9uRXZhbHVhdG9y
LmV2YWx1YXRlKGNvbmRpdGlvbiwgc2NvcGUpKSB7CiAgICAgICAgZG9jdW1lbnQgPSB0dW5kcmEu
c3VwcG9ydC5kb2N1bWVudC5wdXQoZG9jdW1lbnQsIGtleSwgdmFsdWUpOwogICAgICB9CiAgICB9
CiAgfQoKICByZXR1cm4gZG9jdW1lbnQ7Cn0KCi8vIHJldHVybnMgd2hldGhlciB0d28gZG9jdW1l
bnRzIGFyZSBlcXVhbApwdWJsaWMgc3RhdGljIGJvb2xlYW4gZXF1YWwoSURhdGEgeCwgSURhdGEg
eSkgewogIHJldHVybiB0dW5kcmEub2JqZWN0LmVxdWFsKHgsIHkpOwp9CgovLyByZXR1cm5zIGFs
bCB0aGUga2V5cyBpbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgYXMgYSBzdHJpbmcgbGlzdApwdWJsaWMg
c3RhdGljIFN0cmluZ1tdIGtleXNldChJRGF0YSBpbnB1dCkgewogIHJldHVybiBrZXlzZXQoaW5w
dXQsIG51bGwpOwp9CgovLyByZXR1cm5zIHRoZSBrZXlzIHRoYXQgbWF0Y2ggdGhlIGdpdmVuIHJl
Z3VsYXIgZXhwcmVzc2lvbiBwYXR0ZXJuCi8vIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0
cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5c2V0KElEYXRhIGlucHV0LCBTdHJp
bmcgcGF0dGVyblN0cmluZykgewogIGphdmEudXRpbC5yZWdleC5QYXR0ZXJuIHBhdHRlcm4gPSBu
dWxsOwogIGlmIChwYXR0ZXJuU3RyaW5nICE9IG51bGwpIHBhdHRlcm4gPSBqYXZhLnV0aWwucmVn
ZXguUGF0dGVybi5jb21waWxlKHBhdHRlcm5TdHJpbmcpOwoKICBqYXZhLnV0aWwuTGlzdDxTdHJp
bmc+IGtleXMgPSBuZXcgamF2YS51dGlsLkFycmF5TGlzdDxTdHJpbmc+KCk7CiAgaWYgKGlucHV0
ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwog
ICAgd2hpbGUoY3Vyc29yLm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gY3Vyc29yLmdldEtl
eSgpOwoKICAgICAgaWYgKHBhdHRlcm4gPT0gbnVsbCkgewogICAgICAgIGtleXMuYWRkKGtleSk7
CiAgICAgIH0gZWxzZSB7CiAgICAgICAgamF2YS51dGlsLnJlZ2V4Lk1hdGNoZXIgbWF0Y2hlciA9
IHBhdHRlcm4ubWF0Y2hlcihrZXkpOwogICAgICAgIGlmIChtYXRjaGVyLm1hdGNoZXMoKSkga2V5
cy5hZGQoa2V5KTsKICAgICAgfQogICAgfQogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0
dXJuIChTdHJpbmdbXSlrZXlzLnRvQXJyYXkobmV3IFN0cmluZ1swXSk7Cn0KCi8vIHJldHVybnMg
YWxsIHRoZSB2YWx1ZXMgaW4gdGhlIGdpdmVuIGRvY3VtZW50IGFzIGEgc3RyaW5nIGxpc3QKcHVi
bGljIHN0YXRpYyBPYmplY3RbXSB2YWx1ZXNldChJRGF0YSBpbnB1dCkgewogIGphdmEudXRpbC5M
aXN0IHZhbHVlcyA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0KCk7CiAgamF2YS51dGlsLlNldDxD
bGFzczw/Pj4gY2xhc3NlcyA9IG5ldyBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDxDbGFzczw/Pj4o
KTsKCiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0
LmdldEN1cnNvcigpOwogICAgd2hpbGUoY3Vyc29yLm5leHQoKSkgewogICAgICBPYmplY3QgdmFs
dWUgPSBjdXJzb3IuZ2V0VmFsdWUoKTsKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIGNsYXNzZXMu
YWRkKHZhbHVlLmdldENsYXNzKCkpOwogICAgICB2YWx1ZXMuYWRkKHZhbHVlKTsKICAgIH0KICAg
IGN1cnNvci5kZXN0cm95KCk7CiAgfQoKICBDbGFzczw/PiBuZWFyZXN0QW5jZXN0b3IgPSB0dW5k
cmEuc3VwcG9ydC5vYmplY3QubmVhcmVzdEFuY2VzdG9yKGNsYXNzZXMpOwogIGlmIChuZWFyZXN0
QW5jZXN0b3IgPT0gbnVsbCkgbmVhcmVzdEFuY2VzdG9yID0gT2JqZWN0LmNsYXNzOwogIAogIHJl
dHVybiB2YWx1ZXMudG9BcnJheSgoT2JqZWN0W10pamF2YS5sYW5nLnJlZmxlY3QuQXJyYXkubmV3
SW5zdGFuY2UobmVhcmVzdEFuY2VzdG9yLCAwKSk7Cn0KCi8vIG1lcmdlcyBtdWx0aXBsZSBJRGF0
YSBkb2N1bWVudHMgaW50byBhIHNpbmdsZSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIG1l
cmdlKElEYXRhW10gaW5wdXQpIHsKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRl
KCk7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQu
bGVuZ3RoOyBpKyspIHsKICAgICAgSURhdGFVdGlsLm1lcmdlKGlucHV0W2ldLCBvdXRwdXQpOwog
ICAgfQogIH0KICByZXR1cm4gb3V0cHV0Owp9CgovLyBzb3J0cyB0aGUgZ2l2ZW4gSURhdGEgZG9j
dW1lbnQgYnkgaXRzIGtleXMgaW4gbmF0dXJhbCBhc2NlbmRpbmcgb3JkZXIKcHVibGljIHN0YXRp
YyBJRGF0YSBzb3J0KElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQg
PT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIFN0cmluZ1tdIGtleXMgPSBrZXlzZXQoaW5wdXQpOwog
IGphdmEudXRpbC5BcnJheXMuc29ydChrZXlzKTsKCiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0
b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURh
dGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwg
a2V5cy5sZW5ndGg7IGkrKykgewogICAgYm9vbGVhbiByZXN1bHQ7CgogICAgaWYgKGkgPiAwICYm
IGtleXNbaV0uZXF1YWxzKGtleXNbaS0xXSkpIHsKICAgICAgcmVzdWx0ID0gaWMubmV4dChrZXlz
W2ldKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdCA9IGljLmZpcnN0KGtleXNbaV0pOwogICAg
fQoKICAgIGlmIChyZXN1bHQpIHsKICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsK
CiAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYmIHJlY3Vyc2UpIHsKICAgICAgICBpZiAodmFsdWUg
aW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgdmFsdWUgPSBzb3J0KChJRGF0YSl2YWx1ZSwg
cmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwg
dmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgICAgSURhdGFbXSBh
cnJheSA9IHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20u
d20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgICBmb3IgKGludCBqID0g
MDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGFycmF5W2pdID0gc29ydChh
cnJheVtqXSwgcmVjdXJzZSk7CiAgICAgICAgICB9CiAgICAgICAgICB2YWx1ZSA9IGFycmF5Owog
ICAgICAgIH0KICAgICAgfQogICAgICBvYy5pbnNlcnRBZnRlcihrZXlzW2ldLCB2YWx1ZSk7CiAg
ICB9CiAgfQoKICBpYy5kZXN0cm95KCk7CiAgb2MuZGVzdHJveSgpOwoKICByZXR1cm4gb3V0cHV0
Owp9CgovLyB0cmltcyBhbGwgc3RyaW5nIHZhbHVlcywgdGhlbiBjb252ZXJ0cyBlbXB0eSBzdHJp
bmdzIHRvIG51bGxzLCB0aGVuIGNvbXBhY3RzIGJ5IHJlbW92aW5nIGFsbCBudWxsIHZhbHVlcwpw
dWJsaWMgc3RhdGljIElEYXRhIHNxdWVlemUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkg
ewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGEgb3V0cHV0ID0gSURh
dGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7
CiAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHdoaWxlKGljLm5leHQo
KSkgewogICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgT2JqZWN0IHZhbHVlID0gaWMu
Z2V0VmFsdWUoKTsKCiAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICBpZiAodmFsdWUgaW5z
dGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICBTdHJpbmcgc3RyaW5nID0gKFN0cmluZyl2YWx1ZTsK
ICAgICAgICBzdHJpbmcgPSBzdHJpbmcudHJpbSgpOwogICAgICAgIGlmIChzdHJpbmcuZXF1YWxz
KCIiKSkgc3RyaW5nID0gbnVsbDsKICAgICAgICB2YWx1ZSA9IHN0cmluZzsKICAgICAgfSBlbHNl
IGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFsdWUgaW5zdGFuY2VvZiBjb20ud20u
dXRpbC5UYWJsZSkgewogICAgICAgIElEYXRhW10gYXJyYXkgPSB2YWx1ZSBpbnN0YW5jZW9mIElE
YXRhW10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZh
bHVlcygpOwogICAgICAgIGlmIChyZWN1cnNlKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5s
aXN0LmRvY3VtZW50LnNxdWVlemUoYXJyYXksIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAo
YXJyYXkubGVuZ3RoID09IDApIHsKICAgICAgICAgIHZhbHVlID0gbnVsbDsKICAgICAgICB9CiAg
ICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgIGlmIChyZWN1
cnNlKSB7CiAgICAgICAgICB2YWx1ZSA9IHNxdWVlemUoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsK
ICAgICAgICB9IGVsc2UgewogICAgICAgICAgSURhdGFDdXJzb3IgdmMgPSAoKElEYXRhKXZhbHVl
KS5nZXRDdXJzb3IoKTsKICAgICAgICAgIGlmIChJRGF0YVV0aWwuc2l6ZSh2YykgPT0gMCkgdmFs
dWUgPSBudWxsOwogICAgICAgICAgdmMuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgfSBlbHNl
IGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdW10pIHsKICAgICAgICB2YWx1ZSA9IHR1bmRy
YS5zdXBwb3J0LnRhYmxlLm9iamVjdC5zcXVlZXplKChPYmplY3RbXVtdKXZhbHVlKTsKICAgICAg
fSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdKSB7CiAgICAgICAgdmFsdWUgPSB0
dW5kcmEubGlzdC5vYmplY3Quc3F1ZWV6ZSgoT2JqZWN0W10pdmFsdWUpOwogICAgICB9CgogICAg
ICBpZiAodmFsdWUgIT0gbnVsbCkgb2MuaW5zZXJ0QWZ0ZXIoa2V5LCB2YWx1ZSk7CiAgICB9CiAg
fQoKICBpZiAoSURhdGFVdGlsLnNpemUob2MpID09IDApIG91dHB1dCA9IG51bGw7CgogIGljLmRl
c3Ryb3koKTsKICBvYy5kZXN0cm95KCk7CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIGNvbnZlcnRz
IGFsbCBub24tc3RyaW5nIHZhbHVlcyB0byBzdHJpbmdzLCBleGNlcHQgZm9yIElEYXRhLCBJRGF0
YVtdIGFuZCBjb20ud20udXRpbC5UYWJsZSBvYmplY3RzCnB1YmxpYyBzdGF0aWMgSURhdGEgc3Ry
aW5naWZ5KElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVs
bCkgcmV0dXJuIG51bGw7CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsK
ICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogIElEYXRhQ3Vyc29yIG9jID0g
b3V0cHV0LmdldEN1cnNvcigpOwoKICB3aGlsZShpYy5uZXh0KCkpIHsKICAgIFN0cmluZyBrZXkg
PSBpYy5nZXRLZXkoKTsKICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgaWYg
KHZhbHVlICE9IG51bGwpIHsKICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nIHx8IHZh
bHVlIGluc3RhbmNlb2YgU3RyaW5nW10gfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXVtdKSB7
CiAgICAgICAgLy8gZG8gbm90aGluZywgYWxyZWFkeSB2YWx1ZSBpcyBhbHJlYWR5IGEgc3RyaW5n
CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3Rh
bmNlb2YgY29tLndtLnV0aWwuVGFibGUpIHsKICAgICAgICBJRGF0YVtdIGFycmF5ID0gdmFsdWUg
aW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxl
KXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICBpZiAocmVjdXJzZSkgewogICAgICAgICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhcnJheVtp
XSA9IHN0cmluZ2lmeShhcnJheVtpXSwgcmVjdXJzZSk7CiAgICAgICAgICB9CiAgICAgICAgfQog
ICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJ
RGF0YSkgewogICAgICAgIGlmIChyZWN1cnNlKSB7CiAgICAgICAgICB2YWx1ZSA9IHN0cmluZ2lm
eSgoSURhdGEpdmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh2YWx1
ZSBpbnN0YW5jZW9mIE9iamVjdFtdW10pIHsKICAgICAgICBPYmplY3RbXVtdIHRhYmxlID0gKE9i
amVjdFtdW10pdmFsdWU7CiAgICAgICAgU3RyaW5nW11bXSBzdHJpbmdUYWJsZSA9IG5ldyBTdHJp
bmdbdGFibGUubGVuZ3RoXVtdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFibGUubGVu
Z3RoOyBpKyspIHsKICAgICAgICAgIGlmICh0YWJsZVtpXSAhPSBudWxsKSB7CiAgICAgICAgICAg
IHN0cmluZ1RhYmxlW2ldID0gbmV3IFN0cmluZ1t0YWJsZVtpXS5sZW5ndGhdOwogICAgICAgICAg
ICBmb3IgKGludCBqID0gMDsgaiA8IHRhYmxlW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAg
ICAgaWYgKHRhYmxlW2ldW2pdICE9IG51bGwpIHN0cmluZ1RhYmxlW2ldW2pdID0gdGFibGVbaV1b
al0udG9TdHJpbmcoKTsKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgfQogICAg
ICAgIH0KICAgICAgICB2YWx1ZSA9IHN0cmluZ1RhYmxlOwogICAgICB9IGVsc2UgaWYgKHZhbHVl
IGluc3RhbmNlb2YgT2JqZWN0W10pIHsKICAgICAgICBPYmplY3RbXSBhcnJheSA9IChPYmplY3Rb
XSl2YWx1ZTsKICAgICAgICBTdHJpbmdbXSBzdHJpbmdBcnJheSA9IG5ldyBTdHJpbmdbYXJyYXku
bGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7
CiAgICAgICAgICBpZiAoYXJyYXlbaV0gIT0gbnVsbCkgc3RyaW5nQXJyYXlbaV0gPSBhcnJheVtp
XS50b1N0cmluZygpOwogICAgICAgIH0KICAgICAgICB2YWx1ZSA9IHN0cmluZ0FycmF5OwogICAg
ICB9IGVsc2UgewogICAgICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKTsKICAgICAgfQogICAg
fQogICAgb2MuaW5zZXJ0QWZ0ZXIoa2V5LCB2YWx1ZSk7CiAgfQoKICBpYy5kZXN0cm95KCk7CiAg
b2MuZGVzdHJveSgpOwoKICByZXR1cm4gb3V0cHV0Owp9CgovLyBjb252ZXJ0cyBhbGwgbnVsbCB2
YWx1ZXMgdG8gZW1wdHkgc3RyaW5ncwpwdWJsaWMgc3RhdGljIElEYXRhIGJsYW5raWZ5KElEYXRh
IGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51
bGw7CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBJRGF0YUN1cnNv
ciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogIElEYXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1
cnNvcigpOwoKICB3aGlsZShpYy5uZXh0KCkpIHsKICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXko
KTsKICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgaWYgKHZhbHVlID09IG51
bGwpIHsKICAgICAgdmFsdWUgPSAiIjsKICAgIH0gZWxzZSBpZiAocmVjdXJzZSkgewogICAgICBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0
aWwuVGFibGUpIHsKICAgICAgICBJRGF0YVtdIGFycmF5ID0gdmFsdWUgaW5zdGFuY2VvZiBJRGF0
YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxlKXZhbHVlKS5nZXRWYWx1
ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAg
ICAgICAgICBhcnJheVtpXSA9IGJsYW5raWZ5KGFycmF5W2ldLCByZWN1cnNlKTsKICAgICAgICB9
CiAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9m
IElEYXRhKSB7CiAgICAgICAgdmFsdWUgPSBibGFua2lmeSgoSURhdGEpdmFsdWUsIHJlY3Vyc2Up
OwogICAgICB9CiAgICB9CiAgICBvYy5pbnNlcnRBZnRlcihrZXksIHZhbHVlKTsKICB9CgogIGlj
LmRlc3Ryb3koKTsKICBvYy5kZXN0cm95KCk7CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJldHVy
bnMgdGhlIG51bWJlciBvZiB0b3AtbGV2ZWwge2tleSwgdmFsdWV9IHBhaXJzIGluIHRoZSBnaXZl
biBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIGludCBzaXplKElEYXRhIGlucHV0KSB7CiAg
aW50IHNpemUgPSAwOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJz
b3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHNpemUgPSBJRGF0YVV0aWwuc2l6ZShjdXJzb3Ip
OwogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIHNpemU7Cn0KCi8vIHJldHVybnMg
YSBjbG9uZSBvZiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBk
dXBsaWNhdGUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgdGhyb3dzIFNlcnZpY2VFeGNl
cHRpb24gewogIElEYXRhIG91dHB1dCA9IG51bGw7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAg
IElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgdHJ5IHsKICAgICAg
aWYgKHJlY3Vyc2UpIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuZGVlcENsb25lKGlucHV0
KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuY2xvbmUoaW5wdXQp
OwogICAgICB9CiAgICB9IGNhdGNoIChqYXZhLmlvLklPRXhjZXB0aW9uIGV4KSB7CiAgICAgIHR1
bmRyYS5leGNlcHRpb24ucmFpc2UoZXgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3Vyc29yLmRl
c3Ryb3koKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUgdmFs
dWUgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1Ymxp
YyBzdGF0aWMgSURhdGEgZHJvcChJRGF0YSBpbnB1dCwgU3RyaW5nIGtleSkgewogIGlmIChpbnB1
dCAhPSBudWxsICYmIGtleSAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1
dC5nZXRDdXJzb3IoKTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXkpOwogICAgY3Vy
c29yLmRlc3Ryb3koKTsKCiAgICBpZiAodHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5LmlzRnVs
bHlRdWFsaWZpZWQoa2V5KSkgZHJvcChpbnB1dCwgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5
LnBhcnNlKGtleSkpOwogIH0KICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHJlbW92ZXMgdGhlIHZhbHVl
IHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwcm90ZWN0
ZWQgc3RhdGljIElEYXRhIGRyb3AoSURhdGEgaW5wdXQsIGphdmEudXRpbC5RdWV1ZTx0dW5kcmEu
c3VwcG9ydC5kb2N1bWVudC5LZXk+IGtleXMpIHsKICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBrZXlz
ICE9IG51bGwgJiYga2V5cy5zaXplKCkgPiAwKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBp
bnB1dC5nZXRDdXJzb3IoKTsKICAgIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LktleSBrZXkgPSBr
ZXlzLnJlbW92ZSgpOwoKICAgIGlmIChrZXlzLnNpemUoKSA+IDApIHsKICAgICAgaWYgKGtleS5o
YXNJbmRleCgpKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IElEYXRhVXRpbC5nZXRJRGF0YUFy
cmF5KGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICAgIGRyb3AodHVuZHJhLmxpc3Qub2Jq
ZWN0LmdldChhcnJheSwga2V5LmdldEluZGV4KCkpLCBrZXlzKTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICBkcm9wKElEYXRhVXRpbC5nZXRJRGF0YShjdXJzb3IsIGtleS50b1N0cmluZygpKSwga2V5
cyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChrZXkuaGFzSW5kZXgoKSkgewogICAg
ICAgIE9iamVjdFtdIGFycmF5ID0gSURhdGFVdGlsLmdldE9iamVjdEFycmF5KGN1cnNvciwga2V5
LnRvU3RyaW5nKCkpOwogICAgICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCBrZXkudG9TdHJpbmco
KSwgdHVuZHJhLmxpc3Qub2JqZWN0LmRyb3AoYXJyYXksIGtleS5nZXRJbmRleCgpKSk7CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleS50b1N0cmluZygp
KTsKICAgICAgfQogICAgfQogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIGlucHV0
Owp9CgovLyB2aXNpdHMgZWFjaCBlbGVtZW50IGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCwg
Y2FsbHMgdGhlIGdpdmVuIHNlcnZpY2UgdG8gY29udmVydCB0aGUgZWxlbWVudCwgYW5kIGNyZWF0
ZXMgYSBuZXcgSURhdGEgZG9jdW1lbnQgd2l0aCB0aGUgcmVzdWx0aW5nIGVsZW1lbnRzCnB1Ymxp
YyBzdGF0aWMgSURhdGEgbWFwKElEYXRhIGlucHV0LCBTdHJpbmcgc2VydmljZSwgSURhdGEgcGlw
ZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIGtleU91dHB1dCwgU3RyaW5nIHZhbHVlSW5w
dXQsIFN0cmluZyB2YWx1ZU91dHB1dCwgQ2xhc3MgdmFsdWVDbGFzcywgYm9vbGVhbiByZWN1cnNl
KSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsKCiAgaWYg
KGlucHV0ICE9IG51bGwgJiYgc2VydmljZSAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBpYyA9
IGlucHV0LmdldEN1cnNvcigpOwogICAgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwog
ICAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogICAgaWYgKGtleUlucHV0
ID09IG51bGwpIGtleUlucHV0ID0gIiRrZXkiOwogICAgaWYgKGtleU91dHB1dCA9PSBudWxsKSBr
ZXlPdXRwdXQgPSBrZXlJbnB1dDsKICAgIGlmICh2YWx1ZUlucHV0ID09IG51bGwpIHZhbHVlSW5w
dXQgPSAiJHZhbHVlIjsKICAgIGlmICh2YWx1ZU91dHB1dCA9PSBudWxsKSB2YWx1ZU91dHB1dCA9
IHZhbHVlSW5wdXQ7CiAgICBpZiAocGlwZWxpbmUgPT0gbnVsbCkgcGlwZWxpbmUgPSBJRGF0YUZh
Y3RvcnkuY3JlYXRlKCk7CgogICAgdHJ5IHsKICAgICAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICAg
ICAgVHVwbGU8T2JqZWN0PiB0dXBsZSA9IG5ldyBUdXBsZTxPYmplY3Q+KGljLmdldEtleSgpLCBp
Yy5nZXRWYWx1ZSgpKTsKCiAgICAgICAgaWYgKHJlY3Vyc2UgJiYgdHVwbGUudmFsdWUgIT0gbnVs
bCkgewogICAgICAgICAgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAg
ICAgICAgdHVwbGUudmFsdWUgPSBtYXAoKElEYXRhKXR1cGxlLnZhbHVlLCBzZXJ2aWNlLCBwaXBl
bGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVl
Q2xhc3MsIHJlY3Vyc2UpOwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5j
ZW9mIElEYXRhW10gfHwgdHVwbGUudmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkg
ewogICAgICAgICAgICBJRGF0YVtdIGlhcnkgPSB0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIElEYXRh
W10gPyAoSURhdGFbXSl0dXBsZS52YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdHVwbGUudmFs
dWUpLmdldFZhbHVlcygpOwogICAgICAgICAgICBJRGF0YVtdIG9hcnkgPSBuZXcgSURhdGFbaWFy
eS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3RoOyBp
KyspIHsKICAgICAgICAgICAgICBvYXJ5W2ldID0gbWFwKGlhcnlbaV0sIHNlcnZpY2UsIHBpcGVs
aW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVD
bGFzcywgcmVjdXJzZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBv
YXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1td
W10pIHsKICAgICAgICAgICAgU3RyaW5nW11bXSBpYXJ5ID0gKFN0cmluZ1tdW10pdHVwbGUudmFs
dWU7CiAgICAgICAgICAgIFN0cmluZ1tdW10gb2FyeSA9IG5ldyBTdHJpbmdbaWFyeS5sZW5ndGhd
W107CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgewog
ICAgICAgICAgICAgIGlmIChpYXJ5W2ldICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG9hcnlb
aV0gPSBuZXcgU3RyaW5nW2lhcnlbaV0ubGVuZ3RoXTsKICAgICAgICAgICAgICAgIGZvciAoaW50
IGogPSAwOyBqIDwgaWFyeVtpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICBUdXBs
ZTxTdHJpbmc+IHQgPSBtYXAobmV3IFR1cGxlPFN0cmluZz4odHVwbGUua2V5LCBpYXJ5W2ldW2pd
KSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZh
bHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAgICAgICAgICAgICAgb2FyeVtpXVtqXSA9IHQu
dmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg
ICAgICAgICAgIHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUu
dmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAgICAgICBTdHJpbmdbXSBpYXJ5ID0g
KFN0cmluZ1tdKXR1cGxlLnZhbHVlOwogICAgICAgICAgICBTdHJpbmdbXSBvYXJ5ID0gbmV3IFN0
cmluZ1tpYXJ5Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5s
ZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIFR1cGxlPFN0cmluZz4gdCA9IG1hcChuZXcgVHVw
bGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5w
dXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwogICAg
ICAgICAgICAgIG9hcnlbaV0gPSB0LnZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1
cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5zdGFu
Y2VvZiBPYmplY3RbXSkgewogICAgICAgICAgICBPYmplY3RbXSBpYXJ5ID0gKE9iamVjdFtdKXR1
cGxlLnZhbHVlOwogICAgICAgICAgICBPYmplY3RbXSBvYXJ5ID0gbmV3IE9iamVjdFtpYXJ5Lmxl
bmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykg
ewogICAgICAgICAgICAgIFR1cGxlPE9iamVjdD4gdCA9IG1hcChuZXcgVHVwbGU8T2JqZWN0Pih0
dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1
dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwogICAgICAgICAgICAgIG9h
cnlbaV0gPSB0LnZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0g
b2FyeTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdHVwbGUgPSBtYXAodHVwbGUsIHNl
cnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91
dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgSURhdGFVdGlsLnB1dChvYywgdHVwbGUua2V5LCB0
dXBsZS52YWx1ZSk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGljLmRlc3Ryb3koKTsK
ICAgICAgb2MuZGVzdHJveSgpOwogICAgfQogIH0gZWxzZSB7CiAgICBvdXRwdXQgPSBkdXBsaWNh
dGUoaW5wdXQsIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gd3JhcHBlciBj
bGFzcyBmb3Ige2tleSwgdmFsdWV9IHR1cGxlcwpwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIFR1cGxl
PFQ+IHsgCiAgcHVibGljIFN0cmluZyBrZXk7CiAgcHVibGljIFQgdmFsdWU7CiAgcHVibGljIFR1
cGxlKFN0cmluZyBrZXksIFQgdmFsdWUpIHsgCiAgICB0aGlzLmtleSA9IGtleTsgCiAgICB0aGlz
LnZhbHVlID0gdmFsdWU7IAogIH0KfQoKLy8gY29udmVydHMgdGhlIGdpdmVuIGVsZW1lbnQgYnkg
Y2FsbGluZyB0aGUgZ2l2ZW4gc2VydmljZSwgYW5kIHJldHVybnMgdGhlIHJlc3VsdApwcm90ZWN0
ZWQgc3RhdGljIDxUPiBUdXBsZTxUPiBtYXAoVHVwbGU8VD4gdHVwbGUsIFN0cmluZyBzZXJ2aWNl
LCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBTdHJpbmcga2V5T3V0cHV0LCBTdHJp
bmcgdmFsdWVJbnB1dCwgU3RyaW5nIHZhbHVlT3V0cHV0LCBDbGFzcyB2YWx1ZUNsYXNzKSB0aHJv
d3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgaWYgKHR1cGxlLnZhbHVlID09IG51bGwgfHwgdmFsdWVD
bGFzcyA9PSBudWxsIHx8IHZhbHVlQ2xhc3MuaXNJbnN0YW5jZSh0dXBsZS52YWx1ZSkpIHsKICAg
IElEYXRhQ3Vyc29yIGN1cnNvciA9IHBpcGVsaW5lLmdldEN1cnNvcigpOwogICAgSURhdGFVdGls
LnB1dChjdXJzb3IsIGtleUlucHV0LCB0dXBsZS5rZXkpOwogICAgSURhdGFVdGlsLnB1dChjdXJz
b3IsIHZhbHVlSW5wdXQsIHR1cGxlLnZhbHVlKTsKICAgIGN1cnNvci5kZXN0cm95KCk7CgogICAg
cGlwZWxpbmUgPSB0dW5kcmEuc2VydmljZS5pbnZva2Uoc2VydmljZSwgcGlwZWxpbmUpOwoKICAg
IC8vIGNsZWFuIHVwIHRoZSBpbnB1dCBwaXBlbGluZQogICAgY3Vyc29yID0gcGlwZWxpbmUuZ2V0
Q3Vyc29yKCk7CiAgICB0dXBsZS5rZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwga2V5
T3V0cHV0KTsKICAgIHR1cGxlLnZhbHVlID0gKFQpSURhdGFVdGlsLmdldChjdXJzb3IsIHZhbHVl
T3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXlJbnB1dCk7CiAgICBpZiAo
IWtleUlucHV0LmVxdWFscyhrZXlPdXRwdXQpKSBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5
T3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCB2YWx1ZUlucHV0KTsKICAgIGlm
ICghdmFsdWVJbnB1dC5lcXVhbHModmFsdWVPdXRwdXQpKSBJRGF0YVV0aWwucmVtb3ZlKGN1cnNv
ciwgdmFsdWVPdXRwdXQpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9ICAKICByZXR1cm4gdHVw
bGU7Cn0KCi8vIGludm9rZXMgdGhlIGdpdmVuIHNlcnZpY2UgZm9yIGVhY2gge2tleSwgdmFsdWV9
IHBhaXIgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgdm9pZCBlYWNo
KElEYXRhIGlucHV0LCBTdHJpbmcgc2VydmljZSwgSURhdGEgcGlwZWxpbmUsIFN0cmluZyBrZXlJ
bnB1dCwgU3RyaW5nIHZhbHVlSW5wdXQsIENsYXNzIHZhbHVlQ2xhc3MsIGJvb2xlYW4gcmVjdXJz
ZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIG1hcChpbnB1dCwgc2VydmljZSwgcGlwZWxp
bmUsIGtleUlucHV0LCBudWxsLCB2YWx1ZUlucHV0LCBudWxsLCB2YWx1ZUNsYXNzLCByZWN1cnNl
KTsKfQoKLy8gcmVuYW1lcyBhIGtleSBmcm9tIHNvdXJjZSB0byB0YXJnZXQgd2l0aGluIHRoZSBn
aXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIHJlbmFtZShJRGF0YSBpbnB1
dCwgU3RyaW5nIHNvdXJjZSwgU3RyaW5nIHRhcmdldCkgewogIGlmICghc291cmNlLmVxdWFscyh0
YXJnZXQpKSBpbnB1dCA9IGRyb3AoY29weShpbnB1dCwgc291cmNlLCB0YXJnZXQpLCBzb3VyY2Up
OwogIHJldHVybiBpbnB1dDsKfQoKLy8gY29waWVzIGEgdmFsdWUgZnJvbSBzb3VyY2Uga2V5IHRv
IHRhcmdldCBrZXkgd2l0aGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGlj
IElEYXRhIGNvcHkoSURhdGEgaW5wdXQsIFN0cmluZyBzb3VyY2UsIFN0cmluZyB0YXJnZXQpIHsK
ICBpZiAoc291cmNlLmVxdWFscyh0YXJnZXQpKSByZXR1cm4gaW5wdXQ7CiAgcmV0dXJuIHR1bmRy
YS5zdXBwb3J0LmRvY3VtZW50LnB1dChpbnB1dCwgdGFyZ2V0LCB0dW5kcmEuc3VwcG9ydC5kb2N1
bWVudC5nZXQoaW5wdXQsIHNvdXJjZSkpOwp9CgovLyByZW1vdmVzIGFsbCBudWxsIHZhbHVlcyBm
cm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIGNvbXBhY3Qo
SURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIElEYXRhIG91dHB1dCA9IG51bGw7Cgog
IGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7
CiAgICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogICAgSURhdGFDdXJzb3Ig
b2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogICAgdHJ5IHsKICAgICAgd2hpbGUoaWMubmV4dCgp
KSB7CiAgICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgICAgIE9iamVjdCB2YWx1
ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAg
ICBpZiAocmVjdXJzZSkgewogICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkg
ewogICAgICAgICAgICAgIHZhbHVlID0gY29tcGFjdCgoSURhdGEpdmFsdWUsIHJlY3Vyc2UpOwog
ICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBp
bnN0YW5jZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSB0dW5k
cmEubGlzdC5kb2N1bWVudC5jb21wYWN0KHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0
YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCksIHJlY3Vy
c2UpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0W11bXSkg
ewogICAgICAgICAgICAgIHZhbHVlID0gdHVuZHJhLnN1cHBvcnQudGFibGUub2JqZWN0LmNvbXBh
Y3QoKE9iamVjdFtdW10pdmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3Rh
bmNlb2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0Lm9iamVj
dC5jb21wYWN0KChPYmplY3RbXSl2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAg
ICAgICB9CgogICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSBJRGF0YVV0aWwucHV0KG9jLCBrZXks
IHZhbHVlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgpOwogICAg
ICBvYy5kZXN0cm95KCk7CiAgICB9CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyByZXR1cm5z
IGEgbmV3IElEYXRhIGRvY3VtZW50LCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3
aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsCi8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSBy
ZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwdWJsaWMgc3RhdGljIElEYXRhIG5vcm1h
bGl6ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwp
IHJldHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAg
SURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKCiAgdHJ5IHsKICAgIHdoaWxlKGlj
Lm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgIE9iamVjdCB2
YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAg
IGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSkgewog
ICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSl2YWx1ZSku
Z2V0SURhdGEoKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0
aWwuY29kZXIuVmFsdWVzQ29kYWJsZSkgewogICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGls
LmNvZGVyLlZhbHVlc0NvZGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgIH0gZWxzZSBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVbXSkgewog
ICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJs
ZVtdKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2Yg
Y29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IG5v
cm1hbGl6ZSgoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKXZhbHVlLCByZWN1cnNl
KTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSkgewogICAgICAg
ICAgdmFsdWUgPSBub3JtYWxpemUoKElEYXRhW10pdmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0g
ZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgICAg
dmFsdWUgPSBub3JtYWxpemUoKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCks
IHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiB2YWx1ZSBpbnN0YW5jZW9m
IElEYXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoSURhdGEpdmFsdWUsIHJlY3Vy
c2UpOwogICAgICAgIH0KICAgICAgfQogICAgICB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5wdXQo
b3V0cHV0LCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGZpbmFsbHkgewogICAgaWMuZGVzdHJveSgp
OwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gbm9ybWFsaXplcyBhbiBJRGF0YVtdLCB3aGVy
ZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxs
Ci8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVj
dHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKElEYXRhW10gaW5wdXQsIGJv
b2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURh
dGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3IgKGludCBpID0gMDsg
aSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3JtYWxpemUoaW5wdXRb
aV0sIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29udmVydHMgYW4gSURh
dGFDb2RhYmxlW10gdG8gYW4gSURhdGFbXSBhbmQgbm9ybWFsaXplcywgd2hlcmUgYWxsIElEYXRh
cyBhcmUgaW1wbGVtZW50ZWQgCi8vIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwgZnVsbHkg
cXVhbGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnByb3Rl
Y3RlZCBzdGF0aWMgSURhdGFbXSBub3JtYWxpemUoY29tLndtLnV0aWwuY29kZXIuSURhdGFDb2Rh
YmxlW10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1
cm4gbnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBm
b3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBu
b3JtYWxpemUoaW5wdXRbaV0uZ2V0SURhdGEoKSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBv
dXRwdXQ7Cn0KCi8vIGNvbnZlcnRzIGEgVmFsdWVzQ29kYWJsZVtdIHRvIGFuIElEYXRhW10gYW5k
IG5vcm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVkIAovLyB3aXRoIHRo
ZSBzYW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3
aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXpl
KGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSBpbnB1dCwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YVtdIG91dHB1dCA9
IG5ldyBJRGF0YVtpbnB1dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQubGVu
Z3RoOyBpKyspIHsKICAgIG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtpXS5nZXRWYWx1ZXMo
KSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJlbW92ZXMgYWxsIGtl
eXMgZXhjZXB0IHRob3NlIHNwZWNpZmllZCBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApw
dWJsaWMgc3RhdGljIHZvaWQgY2xlYXIoSURhdGEgZG9jdW1lbnQsIFN0cmluZ1tdIGtleXMpIHsK
ICBpZiAoZG9jdW1lbnQgPT0gbnVsbCkgcmV0dXJuOwoKICBJRGF0YSBzYXZlZCA9IG51bGw7CiAg
aWYgKGtleXMgIT0gbnVsbCkgewogICAgc2F2ZWQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAg
ICBmb3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0IHZh
bHVlID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsKICAg
ICAgaWYgKHZhbHVlICE9IG51bGwpIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LnB1dChzYXZlZCwg
a2V5c1tpXSwgdmFsdWUpOwogICAgfQogIH0KCiAgSURhdGFDdXJzb3IgY3Vyc29yID0gZG9jdW1l
bnQuZ2V0Q3Vyc29yKCk7CiAgY3Vyc29yLmZpcnN0KCk7CiAgd2hpbGUoY3Vyc29yLmRlbGV0ZSgp
KTsKICBjdXJzb3IuZGVzdHJveSgpOwoKICBpZiAoa2V5cyAhPSBudWxsKSBJRGF0YVV0aWwubWVy
Z2Uoc2F2ZWQsIGRvY3VtZW50KTsKfQoKLy8gY29udmVydHMgYW4gSURhdGEgZG9jdW1lbnQgdG8g
YW4gSURhdGFbXSBkb2N1bWVudCBsaXN0IHdpdGggZWFjaAovLyBpdGVtIHJlcHJlc2VudGluZyBl
YWNoIGtleSB2YWx1ZSB0dXBsZSBmcm9tIHRoZSBnaXZlbiBkb2N1bWVudApwdWJsaWMgc3RhdGlj
IElEYXRhW10gcGl2b3QoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1
dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5wdXQuZ2V0
Q3Vyc29yKCk7CiAgamF2YS51dGlsLkxpc3Q8SURhdGE+IHBpdm90ID0gbmV3IGphdmEudXRpbC5B
cnJheUxpc3Q8SURhdGE+KCk7CgogIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgIFN0cmluZyBr
ZXkgPSBjdXJzb3IuZ2V0S2V5KCk7CiAgICBPYmplY3QgdmFsdWUgPSBjdXJzb3IuZ2V0VmFsdWUo
KTsKCiAgICBpZiAocmVjdXJzZSAmJiB2YWx1ZSAhPSBudWxsKSB7CiAgICAgIGlmICh2YWx1ZSBp
bnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgdmFsdWUgPSBwaXZvdCgoSURhdGEpdmFsdWUsIHJl
Y3Vyc2UpOwogICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1
ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9
IHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRp
bC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CgogICAgICAgIGphdmEudXRpbC5MaXN0PElEYXRh
W10+IGxpc3Q9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0PElEYXRhW10+KGFycmF5Lmxlbmd0aCk7
CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAg
ICAgIGxpc3QuYWRkKHBpdm90KGFycmF5W2ldLCByZWN1cnNlKSk7CiAgICAgICAgfQoKICAgICAg
ICB2YWx1ZSA9IGxpc3QudG9BcnJheShuZXcgSURhdGFbMF1bMF0pOwogICAgICB9CiAgICB9Cgog
ICAgSURhdGEgaXRlbSA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgIElEYXRhQ3Vyc29yIGlj
ID0gaXRlbS5nZXRDdXJzb3IoKTsKICAgIElEYXRhVXRpbC5wdXQoaWMsICJrZXkiLCBrZXkpOwog
ICAgSURhdGFVdGlsLnB1dChpYywgInZhbHVlIiwgdmFsdWUpOwogICAgaWMuZGVzdHJveSgpOwoK
ICAgIHBpdm90LmFkZChpdGVtKTsKICB9CgogIHJldHVybiBwaXZvdC50b0FycmF5KG5ldyBJRGF0
YVswXSk7Cn0KCi8vIHBlcmZvcm1zIHZhcmlhYmxlIHN1YnN0aXR1dGlvbiBvbiBhbGwgZWxlbWVu
dHMgb2YgdGhlIGdpdmVuIElEYXRhIGlucHV0IGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEg
c3Vic3RpdHV0ZShJRGF0YSBpbnB1dCwgSURhdGEgc2NvcGUsIGJvb2xlYW4gcmVjdXJzZSkgewog
IHJldHVybiBzdWJzdGl0dXRlKGlucHV0LCBzY29wZSwgbnVsbCwgcmVjdXJzZSk7Cn0KCi8vIHBl
cmZvcm1zIHZhcmlhYmxlIHN1YnN0aXR1dGlvbiBvbiBhbGwgZWxlbWVudHMgb2YgdGhlIGdpdmVu
IElEYXRhIGlucHV0IGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgc3Vic3RpdHV0ZShJRGF0
YSBpbnB1dCwgSURhdGEgc2NvcGUsIFN0cmluZyBkZWZhdWx0VmFsdWUsIGJvb2xlYW4gcmVjdXJz
ZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKICBpZiAoc2NvcGUgPT0gbnVs
bCkgc2NvcGUgPSBpbnB1dDsKCiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgp
OwoKICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogIElEYXRhQ3Vyc29yIG9j
ID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICB0cnkgewogICAgd2hpbGUoaWMubmV4dCgpKSB7CiAg
ICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXkoKTsKICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0
VmFsdWUoKTsKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICBpZiAocmVjdXJzZSAm
JiB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IHN1YnN0aXR1dGUo
KElEYXRhKXZhbHVlLCBzY29wZSwgZGVmYXVsdFZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVs
c2UgaWYgKHJlY3Vyc2UgJiYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0
YW5jZW9mIGNvbS53bS51dGlsLlRhYmxlKSkgewogICAgICAgICAgSURhdGFbXSBpYXJ5ID0gdmFs
dWUgaW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRh
YmxlKXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0
YVtpYXJ5Lmxlbmd0aF07CiAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3Ro
OyBpKyspIG9hcnlbaV0gPSBzdWJzdGl0dXRlKGlhcnlbaV0sIHNjb3BlLCBkZWZhdWx0VmFsdWUs
IHJlY3Vyc2UpOwogICAgICAgICAgdmFsdWUgPSBvYXJ5OwogICAgICAgIH0gZWxzZSBpZiAodmFs
dWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgIHZhbHVlID0gdHVuZHJhLnN0cmluZy5z
dWJzdGl0dXRlKChTdHJpbmcpdmFsdWUsIHNjb3BlLCBkZWZhdWx0VmFsdWUpOwogICAgICAgIH0g
ZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAgICAgdmFsdWUgPSB0
dW5kcmEubGlzdC5zdHJpbmcuc3Vic3RpdHV0ZSgoU3RyaW5nW10pdmFsdWUsIHNjb3BlLCBkZWZh
dWx0VmFsdWUpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXVtd
KSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChTdHJp
bmdbXVtdKXZhbHVlLCBzY29wZSwgZGVmYXVsdFZhbHVlKTsKICAgICAgICB9CiAgICAgIH0KICAg
ICAgSURhdGFVdGlsLnB1dChvYywga2V5LCB2YWx1ZSk7CiAgICB9CiAgfSBmaW5hbGx5IHsKICAg
IGljLmRlc3Ryb3koKTsKICAgIG9jLmRlc3Ryb3koKTsKICB9CgogIHJldHVybiBvdXRwdXQ7Cn0K
Ci8vIHBhcnNlcyBhbiBJRGF0YSBYTUwgaW5wdXQgc3RyZWFtIHRvIGFuIElEYXRhIG9iamVjdApw
dWJsaWMgc3RhdGljIElEYXRhIHBhcnNlKGphdmEuaW8uSW5wdXRTdHJlYW0gaW4pIHRocm93cyBq
YXZhLmlvLklPRXhjZXB0aW9uIHsKICBjb20ud20udXRpbC5jb2Rlci5YTUxDb2RlcldyYXBwZXIg
Y29kZWMgPSBuZXcgY29tLndtLnV0aWwuY29kZXIuWE1MQ29kZXJXcmFwcGVyKCk7CiAgcmV0dXJu
IGNvZGVjLmRlY29kZShpbik7Cn0KCi8vIHBhcnNlcyBhbiBJRGF0YSBYTUwgc3RyaW5nLCBieXRl
IGFycmF5IG9yIGlucHV0IHN0cmVhbSB0byBhbiBJRGF0YSBvYmplY3QKcHVibGljIHN0YXRpYyBJ
RGF0YSBwYXJzZShPYmplY3QgY29udGVudCwgU3RyaW5nIGVuY29kaW5nKSB0aHJvd3MgamF2YS5p
by5JT0V4Y2VwdGlvbiB7CiAgcmV0dXJuIHBhcnNlKChqYXZhLmlvLklucHV0U3RyZWFtKXR1bmRy
YS5vYmplY3QuY29udmVydChjb250ZW50LCBlbmNvZGluZywgInN0cmVhbSIpKTsKfQoKLy8gZW1p
dHMgYW4gSURhdGEgb2JqZWN0IGFzIGEgYW4gSURhdGEgWE1MIHN0cmluZywgYnl0ZSBhcnJheSBv
ciBzdHJlYW0KcHVibGljIHN0YXRpYyBPYmplY3QgZW1pdChJRGF0YSBkb2N1bWVudCwgU3RyaW5n
IGVuY29kaW5nLCBTdHJpbmcgbW9kZSkgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogIGNv
bS53bS51dGlsLmNvZGVyLklEYXRhWE1MQ29kZXIgY29kZWMgPSBudWxsOwogIGlmIChlbmNvZGlu
ZyA9PSBudWxsKSB7CiAgICBjb2RlYyA9IG5ldyBjb20ud20udXRpbC5jb2Rlci5JRGF0YVhNTENv
ZGVyKCk7CiAgfSBlbHNlIHsKICAgIGNvZGVjID0gbmV3IGNvbS53bS51dGlsLmNvZGVyLklEYXRh
WE1MQ29kZXIoZW5jb2RpbmcpOwogIH0KCiAgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0g
b3V0ID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgY29kZWMuZW5jb2Rl
KG91dCwgZG9jdW1lbnQpOwoKICByZXR1cm4gdHVuZHJhLm9iamVjdC5jb252ZXJ0KG91dC50b0J5
dGVBcnJheSgpLCBlbmNvZGluZywgbW9kZSk7Cn0=</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
    <value>permafrost.tundra.flow.ConditionEvaluator</value>
    <value>permafrost.tundra.lang.BooleanHelper</value>
  </array>
</Values>
