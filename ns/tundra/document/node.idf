<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJl
dHVybiBkb2N1bWVudDsKCiAgZm9yIChpbnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsg
aSsrKSB7CiAgICBpZiAoYW1lbmRtZW50c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhQ3Vyc29y
IGN1cnNvciA9IGFtZW5kbWVudHNbaV0uZ2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImtleSIpOwogICAgICBTdHJpbmcgdmFsdWUgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInZhbHVlIik7CiAgICAgIFN0cmluZyBjb25kaXRp
b24gPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImNvbmRpdGlvbiIpOwogICAgICBjdXJz
b3IuZGVzdHJveSgpOwoKICAgICAga2V5ID0gdHVuZHJhLnN0cmluZy5zdWJzdGl0dXRlKGtleSwg
c2NvcGUpOwogICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSh2YWx1ZSwgc2Nv
cGUpOwoKICAgICAgaWYgKChjb25kaXRpb24gPT0gbnVsbCkgfHwgdHVuZHJhLmNvbmRpdGlvbi5l
dmFsdWF0ZShjb25kaXRpb24sIHNjb3BlKSkgewogICAgICAgIGRvY3VtZW50ID0gdHVuZHJhLnN1
cHBvcnQuZG9jdW1lbnQucHV0KGRvY3VtZW50LCBrZXksIHZhbHVlKTsKICAgICAgfQogICAgfQog
IH0KCiAgcmV0dXJuIGRvY3VtZW50Owp9CgovLyByZXR1cm5zIHdoZXRoZXIgdHdvIGRvY3VtZW50
cyBhcmUgZXF1YWwKcHVibGljIHN0YXRpYyBib29sZWFuIGVxdWFsKElEYXRhIHgsIElEYXRhIHkp
IHsKICByZXR1cm4gdHVuZHJhLm9iamVjdC5lcXVhbCh4LCB5KTsKfQoKLy8gcmV0dXJucyBhbGwg
dGhlIGtleXMgaW4gdGhlIGdpdmVuIGRvY3VtZW50IGFzIGEgc3RyaW5nIGxpc3QKcHVibGljIHN0
YXRpYyBTdHJpbmdbXSBrZXlzZXQoSURhdGEgaW5wdXQpIHsKICByZXR1cm4ga2V5c2V0KGlucHV0
LCBudWxsKTsKfQoKLy8gcmV0dXJucyB0aGUga2V5cyB0aGF0IG1hdGNoIHRoZSBnaXZlbiByZWd1
bGFyIGV4cHJlc3Npb24gcGF0dGVybgovLyBpbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgYXMgYSBzdHJp
bmcgbGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXNldChJRGF0YSBpbnB1dCwgU3RyaW5n
IHBhdHRlcm5TdHJpbmcpIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwYXR0ZXJuID0gbnVs
bDsKICBpZiAocGF0dGVyblN0cmluZyAhPSBudWxsKSBwYXR0ZXJuID0gamF2YS51dGlsLnJlZ2V4
LlBhdHRlcm4uY29tcGlsZShwYXR0ZXJuU3RyaW5nKTsKCiAgamF2YS51dGlsLkxpc3Q8U3RyaW5n
PiBrZXlzID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAh
PSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAg
IHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGN1cnNvci5nZXRLZXko
KTsKCiAgICAgIGlmIChwYXR0ZXJuID09IG51bGwpIHsKICAgICAgICBrZXlzLmFkZChrZXkpOwog
ICAgICB9IGVsc2UgewogICAgICAgIGphdmEudXRpbC5yZWdleC5NYXRjaGVyIG1hdGNoZXIgPSBw
YXR0ZXJuLm1hdGNoZXIoa2V5KTsKICAgICAgICBpZiAobWF0Y2hlci5tYXRjaGVzKCkpIGtleXMu
YWRkKGtleSk7CiAgICAgIH0KICAgIH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVy
biAoU3RyaW5nW10pa2V5cy50b0FycmF5KG5ldyBTdHJpbmdbMF0pOwp9CgovLyByZXR1cm5zIGFs
bCB0aGUgdmFsdWVzIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1Ymxp
YyBzdGF0aWMgT2JqZWN0W10gdmFsdWVzZXQoSURhdGEgaW5wdXQpIHsKICBqYXZhLnV0aWwuTGlz
dCB2YWx1ZXMgPSBuZXcgamF2YS51dGlsLkFycmF5TGlzdCgpOwogIGphdmEudXRpbC5TZXQ8Q2xh
c3M8Pz4+IGNsYXNzZXMgPSBuZXcgamF2YS51dGlsLkxpbmtlZEhhc2hTZXQ8Q2xhc3M8Pz4+KCk7
CgogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5n
ZXRDdXJzb3IoKTsKICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAgT2JqZWN0IHZhbHVl
ID0gY3Vyc29yLmdldFZhbHVlKCk7CiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSBjbGFzc2VzLmFk
ZCh2YWx1ZS5nZXRDbGFzcygpKTsKICAgICAgdmFsdWVzLmFkZCh2YWx1ZSk7CiAgICB9CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogIH0KCiAgQ2xhc3M8Pz4gbmVhcmVzdEFuY2VzdG9yID0gdHVuZHJh
LnN1cHBvcnQub2JqZWN0Lm5lYXJlc3RBbmNlc3RvcihjbGFzc2VzKTsKICBpZiAobmVhcmVzdEFu
Y2VzdG9yID09IG51bGwpIG5lYXJlc3RBbmNlc3RvciA9IE9iamVjdC5jbGFzczsKICAKICByZXR1
cm4gdmFsdWVzLnRvQXJyYXkoKE9iamVjdFtdKWphdmEubGFuZy5yZWZsZWN0LkFycmF5Lm5ld0lu
c3RhbmNlKG5lYXJlc3RBbmNlc3RvciwgMCkpOwp9CgovLyBtZXJnZXMgbXVsdGlwbGUgSURhdGEg
ZG9jdW1lbnRzIGludG8gYSBzaW5nbGUgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBtZXJn
ZShJRGF0YVtdIGlucHV0KSB7CiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgp
OwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxl
bmd0aDsgaSsrKSB7CiAgICAgIElEYXRhVXRpbC5tZXJnZShpbnB1dFtpXSwgb3V0cHV0KTsKICAg
IH0KICB9CiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gc29ydHMgdGhlIGdpdmVuIElEYXRhIGRvY3Vt
ZW50IGJ5IGl0cyBrZXlzIGluIG5hdHVyYWwgYXNjZW5kaW5nIG9yZGVyCnB1YmxpYyBzdGF0aWMg
SURhdGEgc29ydChJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09
IG51bGwpIHJldHVybiBudWxsOwoKICBTdHJpbmdbXSBrZXlzID0ga2V5c2V0KGlucHV0KTsKICBq
YXZhLnV0aWwuQXJyYXlzLnNvcnQoa2V5cyk7CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9y
eS5jcmVhdGUoKTsKICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwogIElEYXRh
Q3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICBmb3IgKGludCBpID0gMDsgaSA8IGtl
eXMubGVuZ3RoOyBpKyspIHsKICAgIGJvb2xlYW4gcmVzdWx0OwoKICAgIGlmIChpID4gMCAmJiBr
ZXlzW2ldLmVxdWFscyhrZXlzW2ktMV0pKSB7CiAgICAgIHJlc3VsdCA9IGljLm5leHQoa2V5c1tp
XSk7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQgPSBpYy5maXJzdChrZXlzW2ldKTsKICAgIH0K
CiAgICBpZiAocmVzdWx0KSB7CiAgICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7Cgog
ICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJiByZWN1cnNlKSB7CiAgICAgICAgaWYgKHZhbHVlIGlu
c3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAgIHZhbHVlID0gc29ydCgoSURhdGEpdmFsdWUsIHJl
Y3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZh
bHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpIHsKICAgICAgICAgIElEYXRhW10gYXJy
YXkgPSB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29tLndt
LnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAgZm9yIChpbnQgaiA9IDA7
IGogPCBhcnJheS5sZW5ndGg7IGorKykgewogICAgICAgICAgICBhcnJheVtqXSA9IHNvcnQoYXJy
YXlbal0sIHJlY3Vyc2UpOwogICAgICAgICAgfQogICAgICAgICAgdmFsdWUgPSBhcnJheTsKICAg
ICAgICB9CiAgICAgIH0KICAgICAgb2MuaW5zZXJ0QWZ0ZXIoa2V5c1tpXSwgdmFsdWUpOwogICAg
fQogIH0KCiAgaWMuZGVzdHJveSgpOwogIG9jLmRlc3Ryb3koKTsKCiAgcmV0dXJuIG91dHB1dDsK
fQoKLy8gdHJpbXMgYWxsIHN0cmluZyB2YWx1ZXMsIHRoZW4gY29udmVydHMgZW1wdHkgc3RyaW5n
cyB0byBudWxscywgdGhlbiBjb21wYWN0cyBieSByZW1vdmluZyBhbGwgbnVsbCB2YWx1ZXMKcHVi
bGljIHN0YXRpYyBJRGF0YSBzcXVlZXplKElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsK
ICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhIG91dHB1dCA9IElEYXRh
RmFjdG9yeS5jcmVhdGUoKTsKICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwog
IElEYXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICB3aGlsZShpYy5uZXh0KCkp
IHsKICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXkoKTsKICAgIE9iamVjdCB2YWx1ZSA9IGljLmdl
dFZhbHVlKCk7CgogICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgaWYgKHZhbHVlIGluc3Rh
bmNlb2YgU3RyaW5nKSB7CiAgICAgICAgU3RyaW5nIHN0cmluZyA9IChTdHJpbmcpdmFsdWU7CiAg
ICAgICAgc3RyaW5nID0gc3RyaW5nLnRyaW0oKTsKICAgICAgICBpZiAoc3RyaW5nLmVxdWFscygi
IikpIHN0cmluZyA9IG51bGw7CiAgICAgICAgdmFsdWUgPSBzdHJpbmc7CiAgICAgIH0gZWxzZSBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0
aWwuVGFibGUpIHsKICAgICAgICBJRGF0YVtdIGFycmF5ID0gdmFsdWUgaW5zdGFuY2VvZiBJRGF0
YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxlKXZhbHVlKS5nZXRWYWx1
ZXMoKTsKICAgICAgICBpZiAocmVjdXJzZSkgewogICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlz
dC5kb2N1bWVudC5zcXVlZXplKGFycmF5LCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKGFy
cmF5Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICB2YWx1ZSA9IG51bGw7CiAgICAgICAgfQogICAg
ICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICBpZiAocmVjdXJz
ZSkgewogICAgICAgICAgdmFsdWUgPSBzcXVlZXplKChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgIElEYXRhQ3Vyc29yIHZjID0gKChJRGF0YSl2YWx1ZSku
Z2V0Q3Vyc29yKCk7CiAgICAgICAgICBpZiAoSURhdGFVdGlsLnNpemUodmMpID09IDApIHZhbHVl
ID0gbnVsbDsKICAgICAgICAgIHZjLmRlc3Ryb3koKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3RbXVtdKSB7CiAgICAgICAgdmFsdWUgPSB0dW5kcmEu
c3VwcG9ydC50YWJsZS5vYmplY3Quc3F1ZWV6ZSgoT2JqZWN0W11bXSl2YWx1ZSk7CiAgICAgIH0g
ZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3RbXSkgewogICAgICAgIHZhbHVlID0gdHVu
ZHJhLmxpc3Qub2JqZWN0LnNxdWVlemUoKE9iamVjdFtdKXZhbHVlKTsKICAgICAgfQoKICAgICAg
aWYgKHZhbHVlICE9IG51bGwpIG9jLmluc2VydEFmdGVyKGtleSwgdmFsdWUpOwogICAgfQogIH0K
CiAgaWYgKElEYXRhVXRpbC5zaXplKG9jKSA9PSAwKSBvdXRwdXQgPSBudWxsOwoKICBpYy5kZXN0
cm95KCk7CiAgb2MuZGVzdHJveSgpOwoKICByZXR1cm4gb3V0cHV0Owp9CgovLyBjb252ZXJ0cyBh
bGwgbm9uLXN0cmluZyB2YWx1ZXMgdG8gc3RyaW5ncywgZXhjZXB0IGZvciBJRGF0YSwgSURhdGFb
XSBhbmQgY29tLndtLnV0aWwuVGFibGUgb2JqZWN0cwpwdWJsaWMgc3RhdGljIElEYXRhIHN0cmlu
Z2lmeShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwp
IHJldHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAg
SURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNvciBvYyA9IG91
dHB1dC5nZXRDdXJzb3IoKTsKCiAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICBTdHJpbmcga2V5ID0g
aWMuZ2V0S2V5KCk7CiAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoKICAgIGlmICh2
YWx1ZSAhPSBudWxsKSB7CiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZyB8fCB2YWx1
ZSBpbnN0YW5jZW9mIFN0cmluZ1tdIHx8IHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewog
ICAgICAgIC8vIGRvIG5vdGhpbmcsIGFscmVhZHkgdmFsdWUgaXMgYWxyZWFkeSBhIHN0cmluZwog
ICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5j
ZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IHZhbHVlIGlu
c3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2
YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgaWYgKHJlY3Vyc2UpIHsKICAgICAgICAgIGZvciAo
aW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYXJyYXlbaV0g
PSBzdHJpbmdpZnkoYXJyYXlbaV0sIHJlY3Vyc2UpOwogICAgICAgICAgfQogICAgICAgIH0KICAg
ICAgICB2YWx1ZSA9IGFycmF5OwogICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURh
dGEpIHsKICAgICAgICBpZiAocmVjdXJzZSkgewogICAgICAgICAgdmFsdWUgPSBzdHJpbmdpZnko
KElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFsdWUg
aW5zdGFuY2VvZiBPYmplY3RbXVtdKSB7CiAgICAgICAgT2JqZWN0W11bXSB0YWJsZSA9IChPYmpl
Y3RbXVtdKXZhbHVlOwogICAgICAgIFN0cmluZ1tdW10gc3RyaW5nVGFibGUgPSBuZXcgU3RyaW5n
W3RhYmxlLmxlbmd0aF1bXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHRhYmxlLmxlbmd0
aDsgaSsrKSB7CiAgICAgICAgICBpZiAodGFibGVbaV0gIT0gbnVsbCkgewogICAgICAgICAgICBz
dHJpbmdUYWJsZVtpXSA9IG5ldyBTdHJpbmdbdGFibGVbaV0ubGVuZ3RoXTsKICAgICAgICAgICAg
Zm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZVtpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAg
IGlmICh0YWJsZVtpXVtqXSAhPSBudWxsKSBzdHJpbmdUYWJsZVtpXVtqXSA9IHRhYmxlW2ldW2pd
LnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH0gICAgICAgICAgICAKICAgICAgICAgIH0KICAgICAg
ICB9CiAgICAgICAgdmFsdWUgPSBzdHJpbmdUYWJsZTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSBp
bnN0YW5jZW9mIE9iamVjdFtdKSB7CiAgICAgICAgT2JqZWN0W10gYXJyYXkgPSAoT2JqZWN0W10p
dmFsdWU7CiAgICAgICAgU3RyaW5nW10gc3RyaW5nQXJyYXkgPSBuZXcgU3RyaW5nW2FycmF5Lmxl
bmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewog
ICAgICAgICAgaWYgKGFycmF5W2ldICE9IG51bGwpIHN0cmluZ0FycmF5W2ldID0gYXJyYXlbaV0u
dG9TdHJpbmcoKTsKICAgICAgICB9CiAgICAgICAgdmFsdWUgPSBzdHJpbmdBcnJheTsKICAgICAg
fSBlbHNlIHsKICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7CiAgICAgIH0KICAgIH0K
ICAgIG9jLmluc2VydEFmdGVyKGtleSwgdmFsdWUpOwogIH0KCiAgaWMuZGVzdHJveSgpOwogIG9j
LmRlc3Ryb3koKTsKCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29udmVydHMgYWxsIG51bGwgdmFs
dWVzIHRvIGVtcHR5IHN0cmluZ3MKcHVibGljIHN0YXRpYyBJRGF0YSBibGFua2lmeShJRGF0YSBp
bnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxs
OwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgSURhdGFDdXJzb3Ig
aWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNvciBvYyA9IG91dHB1dC5nZXRDdXJz
b3IoKTsKCiAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7
CiAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoKICAgIGlmICh2YWx1ZSA9PSBudWxs
KSB7CiAgICAgIHZhbHVlID0gIiI7CiAgICB9IGVsc2UgaWYgKHJlY3Vyc2UpIHsKICAgICAgaWYg
KHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGls
LlRhYmxlKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IHZhbHVlIGluc3RhbmNlb2YgSURhdGFb
XSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVz
KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAg
ICAgICAgYXJyYXlbaV0gPSBibGFua2lmeShhcnJheVtpXSwgcmVjdXJzZSk7CiAgICAgICAgfQog
ICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJ
RGF0YSkgewogICAgICAgIHZhbHVlID0gYmxhbmtpZnkoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsK
ICAgICAgfQogICAgfQogICAgb2MuaW5zZXJ0QWZ0ZXIoa2V5LCB2YWx1ZSk7CiAgfQoKICBpYy5k
ZXN0cm95KCk7CiAgb2MuZGVzdHJveSgpOwoKICByZXR1cm4gb3V0cHV0Owp9CgovLyByZXR1cm5z
IHRoZSBudW1iZXIgb2YgdG9wLWxldmVsIHtrZXksIHZhbHVlfSBwYWlycyBpbiB0aGUgZ2l2ZW4g
SURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBpbnQgc2l6ZShJRGF0YSBpbnB1dCkgewogIGlu
dCBzaXplID0gMDsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29y
ID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBzaXplID0gSURhdGFVdGlsLnNpemUoY3Vyc29yKTsK
ICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVybiBzaXplOwp9CgovLyByZXR1cm5zIGEg
Y2xvbmUgb2YgdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgZHVw
bGljYXRlKElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHRocm93cyBTZXJ2aWNlRXhjZXB0
aW9uIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJ
RGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHRyeSB7CiAgICAgIGlm
IChyZWN1cnNlKSB7CiAgICAgICAgb3V0cHV0ID0gSURhdGFVdGlsLmRlZXBDbG9uZShpbnB1dCk7
CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3V0cHV0ID0gSURhdGFVdGlsLmNsb25lKGlucHV0KTsK
ICAgICAgfQogICAgfSBjYXRjaCAoamF2YS5pby5JT0V4Y2VwdGlvbiBleCkgewogICAgICB0dW5k
cmEuZXhjZXB0aW9uLnJhaXNlKGV4KTsKICAgIH0gZmluYWxseSB7CiAgICAgIGN1cnNvci5kZXN0
cm95KCk7CiAgICB9CiAgfQogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJlbW92ZXMgdGhlIHZhbHVl
IHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMg
c3RhdGljIElEYXRhIGRyb3AoSURhdGEgaW5wdXQsIFN0cmluZyBrZXkpIHsKICBpZiAoaW5wdXQg
IT0gbnVsbCAmJiBrZXkgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5wdXQu
Z2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5KTsKICAgIGN1cnNv
ci5kZXN0cm95KCk7CgogICAgaWYgKHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LktleS5pc0Z1bGx5
UXVhbGlmaWVkKGtleSkpIGRyb3AoaW5wdXQsIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LktleS5w
YXJzZShrZXkpKTsKICB9CiAgcmV0dXJuIGlucHV0Owp9CgovLyByZW1vdmVzIHRoZSB2YWx1ZSB3
aXRoIHRoZSBnaXZlbiBrZXkgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHJvdGVjdGVk
IHN0YXRpYyBJRGF0YSBkcm9wKElEYXRhIGlucHV0LCBqYXZhLnV0aWwuUXVldWU8dHVuZHJhLnN1
cHBvcnQuZG9jdW1lbnQuS2V5PiBrZXlzKSB7CiAgaWYgKGlucHV0ICE9IG51bGwgJiYga2V5cyAh
PSBudWxsICYmIGtleXMuc2l6ZSgpID4gMCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5w
dXQuZ2V0Q3Vyc29yKCk7CiAgICB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkga2V5ID0ga2V5
cy5yZW1vdmUoKTsKCiAgICBpZiAoa2V5cy5zaXplKCkgPiAwKSB7CiAgICAgIGlmIChrZXkuaGFz
SW5kZXgoKSkgewogICAgICAgIElEYXRhW10gYXJyYXkgPSBJRGF0YVV0aWwuZ2V0SURhdGFBcnJh
eShjdXJzb3IsIGtleS50b1N0cmluZygpKTsKICAgICAgICBkcm9wKHR1bmRyYS5saXN0Lm9iamVj
dC5nZXQoYXJyYXksIGtleS5nZXRJbmRleCgpKSwga2V5cyk7CiAgICAgIH0gZWxzZSB7CiAgICAg
ICAgZHJvcChJRGF0YVV0aWwuZ2V0SURhdGEoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSksIGtleXMp
OwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoa2V5Lmhhc0luZGV4KCkpIHsKICAgICAg
ICBPYmplY3RbXSBhcnJheSA9IElEYXRhVXRpbC5nZXRPYmplY3RBcnJheShjdXJzb3IsIGtleS50
b1N0cmluZygpKTsKICAgICAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwga2V5LnRvU3RyaW5nKCks
IHR1bmRyYS5saXN0Lm9iamVjdC5kcm9wKGFycmF5LCBrZXkuZ2V0SW5kZXgoKSkpOwogICAgICB9
IGVsc2UgewogICAgICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSk7
CiAgICAgIH0KICAgIH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVybiBpbnB1dDsK
fQoKLy8gdmlzaXRzIGVhY2ggZWxlbWVudCBpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQsIGNh
bGxzIHRoZSBnaXZlbiBzZXJ2aWNlIHRvIGNvbnZlcnQgdGhlIGVsZW1lbnQsIGFuZCBjcmVhdGVz
IGEgbmV3IElEYXRhIGRvY3VtZW50IHdpdGggdGhlIHJlc3VsdGluZyBlbGVtZW50cwpwdWJsaWMg
c3RhdGljIElEYXRhIG1hcChJRGF0YSBpbnB1dCwgU3RyaW5nIHNlcnZpY2UsIElEYXRhIHBpcGVs
aW5lLCBTdHJpbmcga2V5SW5wdXQsIFN0cmluZyBrZXlPdXRwdXQsIFN0cmluZyB2YWx1ZUlucHV0
LCBTdHJpbmcgdmFsdWVPdXRwdXQsIENsYXNzIHZhbHVlQ2xhc3MsIGJvb2xlYW4gcmVjdXJzZSkg
dGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIElEYXRhIG91dHB1dCA9IG51bGw7CgogIGlmIChp
bnB1dCAhPSBudWxsICYmIHNlcnZpY2UgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgaWMgPSBp
bnB1dC5nZXRDdXJzb3IoKTsKICAgIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAg
IElEYXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICAgIGlmIChrZXlJbnB1dCA9
PSBudWxsKSBrZXlJbnB1dCA9ICIka2V5IjsKICAgIGlmIChrZXlPdXRwdXQgPT0gbnVsbCkga2V5
T3V0cHV0ID0ga2V5SW5wdXQ7CiAgICBpZiAodmFsdWVJbnB1dCA9PSBudWxsKSB2YWx1ZUlucHV0
ID0gIiR2YWx1ZSI7CiAgICBpZiAodmFsdWVPdXRwdXQgPT0gbnVsbCkgdmFsdWVPdXRwdXQgPSB2
YWx1ZUlucHV0OwogICAgaWYgKHBpcGVsaW5lID09IG51bGwpIHBpcGVsaW5lID0gSURhdGFGYWN0
b3J5LmNyZWF0ZSgpOwoKICAgIHRyeSB7CiAgICAgIHdoaWxlKGljLm5leHQoKSkgewogICAgICAg
IFR1cGxlPE9iamVjdD4gdHVwbGUgPSBuZXcgVHVwbGU8T2JqZWN0PihpYy5nZXRLZXkoKSwgaWMu
Z2V0VmFsdWUoKSk7CgogICAgICAgIGlmIChyZWN1cnNlICYmIHR1cGxlLnZhbHVlICE9IG51bGwp
IHsKICAgICAgICAgIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAg
ICAgIHR1cGxlLnZhbHVlID0gbWFwKChJRGF0YSl0dXBsZS52YWx1ZSwgc2VydmljZSwgcGlwZWxp
bmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNs
YXNzLCByZWN1cnNlKTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5zdGFuY2Vv
ZiBJRGF0YVtdIHx8IHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpIHsK
ICAgICAgICAgICAgSURhdGFbXSBpYXJ5ID0gdHVwbGUudmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtd
ID8gKElEYXRhW10pdHVwbGUudmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxlKXR1cGxlLnZhbHVl
KS5nZXRWYWx1ZXMoKTsKICAgICAgICAgICAgSURhdGFbXSBvYXJ5ID0gbmV3IElEYXRhW2lhcnku
bGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsr
KSB7CiAgICAgICAgICAgICAgb2FyeVtpXSA9IG1hcChpYXJ5W2ldLCBzZXJ2aWNlLCBwaXBlbGlu
ZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xh
c3MsIHJlY3Vyc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0gb2Fy
eTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXVtd
KSB7CiAgICAgICAgICAgIFN0cmluZ1tdW10gaWFyeSA9IChTdHJpbmdbXVtdKXR1cGxlLnZhbHVl
OwogICAgICAgICAgICBTdHJpbmdbXVtdIG9hcnkgPSBuZXcgU3RyaW5nW2lhcnkubGVuZ3RoXVtd
OwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3RoOyBpKyspIHsKICAg
ICAgICAgICAgICBpZiAoaWFyeVtpXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBvYXJ5W2ld
ID0gbmV3IFN0cmluZ1tpYXJ5W2ldLmxlbmd0aF07CiAgICAgICAgICAgICAgICBmb3IgKGludCBq
ID0gMDsgaiA8IGlhcnlbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgVHVwbGU8
U3RyaW5nPiB0ID0gbWFwKG5ldyBUdXBsZTxTdHJpbmc+KHR1cGxlLmtleSwgaWFyeVtpXVtqXSks
IHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1
ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgICAgIG9hcnlbaV1bal0gPSB0LnZh
bHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg
ICAgICAgICB0dXBsZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZh
bHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgICAgU3RyaW5nW10gaWFyeSA9IChT
dHJpbmdbXSl0dXBsZS52YWx1ZTsKICAgICAgICAgICAgU3RyaW5nW10gb2FyeSA9IG5ldyBTdHJp
bmdbaWFyeS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVu
Z3RoOyBpKyspIHsKICAgICAgICAgICAgICBUdXBsZTxTdHJpbmc+IHQgPSBtYXAobmV3IFR1cGxl
PFN0cmluZz4odHVwbGUua2V5LCBpYXJ5W2ldKSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0
LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAg
ICAgICAgICBvYXJ5W2ldID0gdC52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0dXBs
ZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNl
b2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgT2JqZWN0W10gaWFyeSA9IChPYmplY3RbXSl0dXBs
ZS52YWx1ZTsKICAgICAgICAgICAgT2JqZWN0W10gb2FyeSA9IG5ldyBPYmplY3RbaWFyeS5sZW5n
dGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3RoOyBpKyspIHsK
ICAgICAgICAgICAgICBUdXBsZTxPYmplY3Q+IHQgPSBtYXAobmV3IFR1cGxlPE9iamVjdD4odHVw
bGUua2V5LCBpYXJ5W2ldKSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQs
IHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAgICAgICAgICBvYXJ5
W2ldID0gdC52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0dXBsZS52YWx1ZSA9IG9h
cnk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHR1cGxlID0gbWFwKHR1cGxlLCBzZXJ2
aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRw
dXQsIHZhbHVlQ2xhc3MpOwogICAgICAgIElEYXRhVXRpbC5wdXQob2MsIHR1cGxlLmtleSwgdHVw
bGUudmFsdWUpOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBpYy5kZXN0cm95KCk7CiAg
ICAgIG9jLmRlc3Ryb3koKTsKICAgIH0KICB9IGVsc2UgewogICAgb3V0cHV0ID0gZHVwbGljYXRl
KGlucHV0LCByZWN1cnNlKTsKICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHdyYXBwZXIgY2xh
c3MgZm9yIHtrZXksIHZhbHVlfSB0dXBsZXMKcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBUdXBsZTxU
PiB7IAogIHB1YmxpYyBTdHJpbmcga2V5OwogIHB1YmxpYyBUIHZhbHVlOwogIHB1YmxpYyBUdXBs
ZShTdHJpbmcga2V5LCBUIHZhbHVlKSB7IAogICAgdGhpcy5rZXkgPSBrZXk7IAogICAgdGhpcy52
YWx1ZSA9IHZhbHVlOyAKICB9Cn0KCi8vIGNvbnZlcnRzIHRoZSBnaXZlbiBlbGVtZW50IGJ5IGNh
bGxpbmcgdGhlIGdpdmVuIHNlcnZpY2UsIGFuZCByZXR1cm5zIHRoZSByZXN1bHQKcHJvdGVjdGVk
IHN0YXRpYyA8VD4gVHVwbGU8VD4gbWFwKFR1cGxlPFQ+IHR1cGxlLCBTdHJpbmcgc2VydmljZSwg
SURhdGEgcGlwZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIGtleU91dHB1dCwgU3RyaW5n
IHZhbHVlSW5wdXQsIFN0cmluZyB2YWx1ZU91dHB1dCwgQ2xhc3MgdmFsdWVDbGFzcykgdGhyb3dz
IFNlcnZpY2VFeGNlcHRpb24gewogIGlmICh0dXBsZS52YWx1ZSA9PSBudWxsIHx8IHZhbHVlQ2xh
c3MgPT0gbnVsbCB8fCB2YWx1ZUNsYXNzLmlzSW5zdGFuY2UodHVwbGUudmFsdWUpKSB7CiAgICBJ
RGF0YUN1cnNvciBjdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsKICAgIElEYXRhVXRpbC5w
dXQoY3Vyc29yLCBrZXlJbnB1dCwgdHVwbGUua2V5KTsKICAgIElEYXRhVXRpbC5wdXQoY3Vyc29y
LCB2YWx1ZUlucHV0LCB0dXBsZS52YWx1ZSk7CiAgICBjdXJzb3IuZGVzdHJveSgpOwoKICAgIHBp
cGVsaW5lID0gdHVuZHJhLnNlcnZpY2UuaW52b2tlKHNlcnZpY2UsIHBpcGVsaW5lKTsKCiAgICAv
LyBjbGVhbiB1cCB0aGUgaW5wdXQgcGlwZWxpbmUKICAgIGN1cnNvciA9IHBpcGVsaW5lLmdldEN1
cnNvcigpOwogICAgdHVwbGUua2V5ID0gSURhdGFVdGlsLmdldFN0cmluZyhjdXJzb3IsIGtleU91
dHB1dCk7CiAgICB0dXBsZS52YWx1ZSA9IChUKUlEYXRhVXRpbC5nZXQoY3Vyc29yLCB2YWx1ZU91
dHB1dCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5SW5wdXQpOwogICAgaWYgKCFr
ZXlJbnB1dC5lcXVhbHMoa2V5T3V0cHV0KSkgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleU91
dHB1dCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwgdmFsdWVJbnB1dCk7CiAgICBpZiAo
IXZhbHVlSW5wdXQuZXF1YWxzKHZhbHVlT3V0cHV0KSkgSURhdGFVdGlsLnJlbW92ZShjdXJzb3Is
IHZhbHVlT3V0cHV0KTsKICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfSAgCiAgcmV0dXJuIHR1cGxl
Owp9CgovLyBpbnZva2VzIHRoZSBnaXZlbiBzZXJ2aWNlIGZvciBlYWNoIHtrZXksIHZhbHVlfSBw
YWlyIGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIHZvaWQgZWFjaChJ
RGF0YSBpbnB1dCwgU3RyaW5nIHNlcnZpY2UsIElEYXRhIHBpcGVsaW5lLCBTdHJpbmcga2V5SW5w
dXQsIFN0cmluZyB2YWx1ZUlucHV0LCBDbGFzcyB2YWx1ZUNsYXNzLCBib29sZWFuIHJlY3Vyc2Up
IHRocm93cyBTZXJ2aWNlRXhjZXB0aW9uIHsKICBtYXAoaW5wdXQsIHNlcnZpY2UsIHBpcGVsaW5l
LCBrZXlJbnB1dCwgbnVsbCwgdmFsdWVJbnB1dCwgbnVsbCwgdmFsdWVDbGFzcywgcmVjdXJzZSk7
Cn0KCi8vIHJlbmFtZXMgYSBrZXkgZnJvbSBzb3VyY2UgdG8gdGFyZ2V0IHdpdGhpbiB0aGUgZ2l2
ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSByZW5hbWUoSURhdGEgaW5wdXQs
IFN0cmluZyBzb3VyY2UsIFN0cmluZyB0YXJnZXQpIHsKICBpZiAoIXNvdXJjZS5lcXVhbHModGFy
Z2V0KSkgaW5wdXQgPSBkcm9wKGNvcHkoaW5wdXQsIHNvdXJjZSwgdGFyZ2V0KSwgc291cmNlKTsK
ICByZXR1cm4gaW5wdXQ7Cn0KCi8vIGNvcGllcyBhIHZhbHVlIGZyb20gc291cmNlIGtleSB0byB0
YXJnZXQga2V5IHdpdGhpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJ
RGF0YSBjb3B5KElEYXRhIGlucHV0LCBTdHJpbmcgc291cmNlLCBTdHJpbmcgdGFyZ2V0KSB7CiAg
aWYgKHNvdXJjZS5lcXVhbHModGFyZ2V0KSkgcmV0dXJuIGlucHV0OwogIHJldHVybiB0dW5kcmEu
c3VwcG9ydC5kb2N1bWVudC5wdXQoaW5wdXQsIHRhcmdldCwgdHVuZHJhLnN1cHBvcnQuZG9jdW1l
bnQuZ2V0KGlucHV0LCBzb3VyY2UpKTsKfQoKLy8gcmVtb3ZlcyBhbGwgbnVsbCB2YWx1ZXMgZnJv
bSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBjb21wYWN0KElE
YXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwoKICBp
ZiAoaW5wdXQgIT0gbnVsbCkgewogICAgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwog
ICAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIElEYXRhQ3Vyc29yIG9j
ID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICAgIHRyeSB7CiAgICAgIHdoaWxlKGljLm5leHQoKSkg
ewogICAgICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXkoKTsKICAgICAgICBPYmplY3QgdmFsdWUg
PSBpYy5nZXRWYWx1ZSgpOwoKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgICAg
aWYgKHJlY3Vyc2UpIHsKICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsK
ICAgICAgICAgICAgICB2YWx1ZSA9IGNvbXBhY3QoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAg
ICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFsdWUgaW5z
dGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgICAgICAgIHZhbHVlID0gdHVuZHJh
Lmxpc3QuZG9jdW1lbnQuY29tcGFjdCh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFb
XSl2YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpLCByZWN1cnNl
KTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdW10pIHsK
ICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5zdXBwb3J0LnRhYmxlLm9iamVjdC5jb21wYWN0
KChPYmplY3RbXVtdKXZhbHVlKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5j
ZW9mIE9iamVjdFtdKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlzdC5vYmplY3Qu
Y29tcGFjdCgoT2JqZWN0W10pdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAg
ICAgfQoKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgSURhdGFVdGlsLnB1dChvYywga2V5LCB2
YWx1ZSk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGljLmRlc3Ryb3koKTsKICAgICAg
b2MuZGVzdHJveSgpOwogICAgfQogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmV0dXJucyBh
IG5ldyBJRGF0YSBkb2N1bWVudCwgd2hlcmUgYWxsIElEYXRhcyBhcmUgaW1wbGVtZW50ZWQgd2l0
aCB0aGUgc2FtZSBjbGFzcywgYW5kIGFsbAovLyBmdWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVw
bGFjZWQgd2l0aCBhIG5lc3RlZCBzdHJ1Y3R1cmUKcHVibGljIHN0YXRpYyBJRGF0YSBub3JtYWxp
emUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSBy
ZXR1cm4gbnVsbDsKCiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElE
YXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CgogIHRyeSB7CiAgICB3aGlsZShpYy5u
ZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgICBPYmplY3QgdmFs
dWUgPSBpYy5nZXRWYWx1ZSgpOwoKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGUpIHsKICAg
ICAgICAgIHZhbHVlID0gKChjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGUpdmFsdWUpLmdl
dElEYXRhKCk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGls
LmNvZGVyLlZhbHVlc0NvZGFibGUpIHsKICAgICAgICAgIHZhbHVlID0gKChjb20ud20udXRpbC5j
b2Rlci5WYWx1ZXNDb2RhYmxlKXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICB9IGVsc2UgaWYg
KHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxlW10pIHsKICAg
ICAgICAgIHZhbHVlID0gbm9ybWFsaXplKChjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVb
XSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNv
bS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSkgewogICAgICAgICAgdmFsdWUgPSBub3Jt
YWxpemUoKGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSl2YWx1ZSwgcmVjdXJzZSk7
CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10pIHsKICAgICAgICAg
IHZhbHVlID0gbm9ybWFsaXplKChJRGF0YVtdKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVs
c2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpIHsKICAgICAgICAgIHZh
bHVlID0gbm9ybWFsaXplKCgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpLCBy
ZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHJlY3Vyc2UgJiYgdmFsdWUgaW5zdGFuY2VvZiBJ
RGF0YSkgewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKElEYXRhKXZhbHVlLCByZWN1cnNl
KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91
dHB1dCwga2V5LCB2YWx1ZSk7CiAgICB9CiAgfSBmaW5hbGx5IHsKICAgIGljLmRlc3Ryb3koKTsK
ICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIG5vcm1hbGl6ZXMgYW4gSURhdGFbXSwgd2hlcmUg
YWxsIElEYXRhcyBhcmUgaW1wbGVtZW50ZWQgd2l0aCB0aGUgc2FtZSBjbGFzcywgYW5kIGFsbAov
LyBmdWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVwbGFjZWQgd2l0aCBhIG5lc3RlZCBzdHJ1Y3R1
cmUKcHJvdGVjdGVkIHN0YXRpYyBJRGF0YVtdIG5vcm1hbGl6ZShJRGF0YVtdIGlucHV0LCBib29s
ZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRh
W10gb3V0cHV0ID0gbmV3IElEYXRhW2lucHV0Lmxlbmd0aF07CiAgZm9yIChpbnQgaSA9IDA7IGkg
PCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgb3V0cHV0W2ldID0gbm9ybWFsaXplKGlucHV0W2ld
LCByZWN1cnNlKTsKICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIGNvbnZlcnRzIGFuIElEYXRh
Q29kYWJsZVtdIHRvIGFuIElEYXRhW10gYW5kIG5vcm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMg
YXJlIGltcGxlbWVudGVkIAovLyB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1
YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0
ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJs
ZVtdIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJu
IG51bGw7CgogIElEYXRhW10gb3V0cHV0ID0gbmV3IElEYXRhW2lucHV0Lmxlbmd0aF07CiAgZm9y
IChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgb3V0cHV0W2ldID0gbm9y
bWFsaXplKGlucHV0W2ldLmdldElEYXRhKCksIHJlY3Vyc2UpOwogIH0KICAKICByZXR1cm4gb3V0
cHV0Owp9CgovLyBjb252ZXJ0cyBhIFZhbHVlc0NvZGFibGVbXSB0byBhbiBJRGF0YVtdIGFuZCBu
b3JtYWxpemVzLCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCAKLy8gd2l0aCB0aGUg
c2FtZSBjbGFzcywgYW5kIGFsbCBmdWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVwbGFjZWQgd2l0
aCBhIG5lc3RlZCBzdHJ1Y3R1cmUKcHJvdGVjdGVkIHN0YXRpYyBJRGF0YVtdIG5vcm1hbGl6ZShj
b20ud20udXRpbC5jb2Rlci5WYWx1ZXNDb2RhYmxlW10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkg
ewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBu
ZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0
aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3JtYWxpemUoaW5wdXRbaV0uZ2V0VmFsdWVzKCks
IHJlY3Vyc2UpOwogIH0KICAKICByZXR1cm4gb3V0cHV0Owp9CgovLyByZW1vdmVzIGFsbCBrZXlz
IGV4Y2VwdCB0aG9zZSBzcGVjaWZpZWQgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVi
bGljIHN0YXRpYyB2b2lkIGNsZWFyKElEYXRhIGRvY3VtZW50LCBTdHJpbmdbXSBrZXlzKSB7CiAg
aWYgKGRvY3VtZW50ID09IG51bGwpIHJldHVybjsKCiAgSURhdGEgc2F2ZWQgPSBudWxsOwogIGlm
IChrZXlzICE9IG51bGwpIHsKICAgIHNhdmVkID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogICAg
Zm9yIChpbnQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIE9iamVjdCB2YWx1
ZSA9IHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LmdldChkb2N1bWVudCwga2V5c1tpXSk7CiAgICAg
IGlmICh2YWx1ZSAhPSBudWxsKSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5wdXQoc2F2ZWQsIGtl
eXNbaV0sIHZhbHVlKTsKICAgIH0KICB9CgogIElEYXRhQ3Vyc29yIGN1cnNvciA9IGRvY3VtZW50
LmdldEN1cnNvcigpOwogIGN1cnNvci5maXJzdCgpOwogIHdoaWxlKGN1cnNvci5kZWxldGUoKSk7
CiAgY3Vyc29yLmRlc3Ryb3koKTsKCiAgaWYgKGtleXMgIT0gbnVsbCkgSURhdGFVdGlsLm1lcmdl
KHNhdmVkLCBkb2N1bWVudCk7Cn0KCi8vIGNvbnZlcnRzIGFuIElEYXRhIGRvY3VtZW50IHRvIGFu
IElEYXRhW10gZG9jdW1lbnQgbGlzdCB3aXRoIGVhY2gKLy8gaXRlbSByZXByZXNlbnRpbmcgZWFj
aCBrZXkgdmFsdWUgdHVwbGUgZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJ
RGF0YVtdIHBpdm90KElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQg
PT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1
cnNvcigpOwogIGphdmEudXRpbC5MaXN0PElEYXRhPiBwaXZvdCA9IG5ldyBqYXZhLnV0aWwuQXJy
YXlMaXN0PElEYXRhPigpOwoKICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICBTdHJpbmcga2V5
ID0gY3Vyc29yLmdldEtleSgpOwogICAgT2JqZWN0IHZhbHVlID0gY3Vyc29yLmdldFZhbHVlKCk7
CgogICAgaWYgKHJlY3Vyc2UgJiYgdmFsdWUgIT0gbnVsbCkgewogICAgICBpZiAodmFsdWUgaW5z
dGFuY2VvZiBJRGF0YSkgewogICAgICAgIHZhbHVlID0gcGl2b3QoKElEYXRhKXZhbHVlLCByZWN1
cnNlKTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFsdWUg
aW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgIElEYXRhW10gYXJyYXkgPSB2
YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29tLndtLnV0aWwu
VGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwoKICAgICAgICBqYXZhLnV0aWwuTGlzdDxJRGF0YVtd
PiBsaXN0PSBuZXcgamF2YS51dGlsLkFycmF5TGlzdDxJRGF0YVtdPihhcnJheS5sZW5ndGgpOwoK
ICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg
ICBsaXN0LmFkZChwaXZvdChhcnJheVtpXSwgcmVjdXJzZSkpOwogICAgICAgIH0KCiAgICAgICAg
dmFsdWUgPSBsaXN0LnRvQXJyYXkobmV3IElEYXRhWzBdWzBdKTsKICAgICAgfQogICAgfQoKICAg
IElEYXRhIGl0ZW0gPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBpYyA9
IGl0ZW0uZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGljLCAia2V5Iiwga2V5KTsKICAg
IElEYXRhVXRpbC5wdXQoaWMsICJ2YWx1ZSIsIHZhbHVlKTsKICAgIGljLmRlc3Ryb3koKTsKCiAg
ICBwaXZvdC5hZGQoaXRlbSk7CiAgfQoKICByZXR1cm4gcGl2b3QudG9BcnJheShuZXcgSURhdGFb
MF0pOwp9CgovLyBwZXJmb3JtcyB2YXJpYWJsZSBzdWJzdGl0dXRpb24gb24gYWxsIGVsZW1lbnRz
IG9mIHRoZSBnaXZlbiBJRGF0YSBpbnB1dCBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIHN1
YnN0aXR1dGUoSURhdGEgaW5wdXQsIElEYXRhIHNjb3BlLCBib29sZWFuIHJlY3Vyc2UpIHsKICBy
ZXR1cm4gc3Vic3RpdHV0ZShpbnB1dCwgc2NvcGUsIG51bGwsIHJlY3Vyc2UpOwp9CgovLyBwZXJm
b3JtcyB2YXJpYWJsZSBzdWJzdGl0dXRpb24gb24gYWxsIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBJ
RGF0YSBpbnB1dCBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIHN1YnN0aXR1dGUoSURhdGEg
aW5wdXQsIElEYXRhIHNjb3BlLCBTdHJpbmcgZGVmYXVsdFZhbHVlLCBib29sZWFuIHJlY3Vyc2Up
IHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CiAgaWYgKHNjb3BlID09IG51bGwp
IHNjb3BlID0gaW5wdXQ7CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsK
CiAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNvciBvYyA9
IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgdHJ5IHsKICAgIHdoaWxlKGljLm5leHQoKSkgewogICAg
ICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZh
bHVlKCk7CiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgaWYgKHJlY3Vyc2UgJiYg
dmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgdmFsdWUgPSBzdWJzdGl0dXRlKChJ
RGF0YSl2YWx1ZSwgc2NvcGUsIGRlZmF1bHRWYWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNl
IGlmIChyZWN1cnNlICYmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFsdWUgaW5zdGFu
Y2VvZiBjb20ud20udXRpbC5UYWJsZSkpIHsKICAgICAgICAgIElEYXRhW10gaWFyeSA9IHZhbHVl
IGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJs
ZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgICBJRGF0YVtdIG9hcnkgPSBuZXcgSURhdGFb
aWFyeS5sZW5ndGhdOwogICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsg
aSsrKSBvYXJ5W2ldID0gc3Vic3RpdHV0ZShpYXJ5W2ldLCBzY29wZSwgZGVmYXVsdFZhbHVlLCBy
ZWN1cnNlKTsKICAgICAgICAgIHZhbHVlID0gb2FyeTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVl
IGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vi
c3RpdHV0ZSgoU3RyaW5nKXZhbHVlLCBzY29wZSwgZGVmYXVsdFZhbHVlKTsKICAgICAgICB9IGVs
c2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgIHZhbHVlID0gdHVu
ZHJhLmxpc3Quc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZ1tdKXZhbHVlLCBzY29wZSwgZGVmYXVs
dFZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkg
ewogICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlzdC5zdHJpbmcuc3Vic3RpdHV0ZSgoU3RyaW5n
W11bXSl2YWx1ZSwgc2NvcGUsIGRlZmF1bHRWYWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAg
IElEYXRhVXRpbC5wdXQob2MsIGtleSwgdmFsdWUpOwogICAgfQogIH0gZmluYWxseSB7CiAgICBp
Yy5kZXN0cm95KCk7CiAgICBvYy5kZXN0cm95KCk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9Cgov
LyBwYXJzZXMgYW4gSURhdGEgWE1MIGlucHV0IHN0cmVhbSB0byBhbiBJRGF0YSBvYmplY3QKcHVi
bGljIHN0YXRpYyBJRGF0YSBwYXJzZShqYXZhLmlvLklucHV0U3RyZWFtIGluKSB0aHJvd3MgamF2
YS5pby5JT0V4Y2VwdGlvbiB7CiAgY29tLndtLnV0aWwuY29kZXIuWE1MQ29kZXJXcmFwcGVyIGNv
ZGVjID0gbmV3IGNvbS53bS51dGlsLmNvZGVyLlhNTENvZGVyV3JhcHBlcigpOwogIHJldHVybiBj
b2RlYy5kZWNvZGUoaW4pOwp9CgovLyBwYXJzZXMgYW4gSURhdGEgWE1MIHN0cmluZywgYnl0ZSBh
cnJheSBvciBpbnB1dCBzdHJlYW0gdG8gYW4gSURhdGEgb2JqZWN0CnB1YmxpYyBzdGF0aWMgSURh
dGEgcGFyc2UoT2JqZWN0IGNvbnRlbnQsIFN0cmluZyBlbmNvZGluZykgdGhyb3dzIGphdmEuaW8u
SU9FeGNlcHRpb24gewogIHJldHVybiBwYXJzZSgoamF2YS5pby5JbnB1dFN0cmVhbSl0dW5kcmEu
b2JqZWN0LmNvbnZlcnQoY29udGVudCwgZW5jb2RpbmcsICJzdHJlYW0iKSk7Cn0KCi8vIGVtaXRz
IGFuIElEYXRhIG9iamVjdCBhcyBhIGFuIElEYXRhIFhNTCBzdHJpbmcsIGJ5dGUgYXJyYXkgb3Ig
c3RyZWFtCnB1YmxpYyBzdGF0aWMgT2JqZWN0IGVtaXQoSURhdGEgZG9jdW1lbnQsIFN0cmluZyBl
bmNvZGluZywgU3RyaW5nIG1vZGUpIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICBjb20u
d20udXRpbC5jb2Rlci5JRGF0YVhNTENvZGVyIGNvZGVjID0gbnVsbDsKICBpZiAoZW5jb2Rpbmcg
PT0gbnVsbCkgewogICAgY29kZWMgPSBuZXcgY29tLndtLnV0aWwuY29kZXIuSURhdGFYTUxDb2Rl
cigpOwogIH0gZWxzZSB7CiAgICBjb2RlYyA9IG5ldyBjb20ud20udXRpbC5jb2Rlci5JRGF0YVhN
TENvZGVyKGVuY29kaW5nKTsKICB9CgogIGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtIG91
dCA9IG5ldyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogIGNvZGVjLmVuY29kZShv
dXQsIGRvY3VtZW50KTsKCiAgcmV0dXJuIHR1bmRyYS5vYmplY3QuY29udmVydChvdXQudG9CeXRl
QXJyYXkoKSwgZW5jb2RpbmcsIG1vZGUpOwp9</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
