<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJldHVybiBkb2N1bWVudDsKCiAgZm9yIChp
bnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoYW1lbmRtZW50
c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhIGFtZW5kbWVudCA9IHN1YnN0aXR1dGUoYW1lbmRt
ZW50c1tpXSwgc2NvcGUsIHRydWUpOwogICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBhbWVuZG1l
bnQuZ2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1
cnNvciwgImtleSIpOwogICAgICBPYmplY3QgdmFsdWUgPSBJRGF0YVV0aWwuZ2V0KGN1cnNvciwg
InZhbHVlIik7CiAgICAgIGN1cnNvci5kZXN0cm95KCk7CiAgICAgIGRvY3VtZW50ID0gdHVuZHJh
LnN1cHBvcnQuZG9jdW1lbnQucHV0KGRvY3VtZW50LCBrZXksIHZhbHVlKTsKICAgIH0KICB9Cgog
IHJldHVybiBkb2N1bWVudDsKfQoKLy8gcmV0dXJucyB3aGV0aGVyIHR3byBkb2N1bWVudHMgYXJl
IGVxdWFsCnB1YmxpYyBzdGF0aWMgYm9vbGVhbiBlcXVhbChJRGF0YSB4LCBJRGF0YSB5KSB7CiAg
cmV0dXJuIHR1bmRyYS5vYmplY3QuZXF1YWwoeCwgeSk7Cn0KCi8vIHJldHVybnMgYWxsIHRoZSBr
ZXlzIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMg
U3RyaW5nW10ga2V5c2V0KElEYXRhIGlucHV0KSB7CiAgamF2YS51dGlsLkxpc3Q8U3RyaW5nPiBr
ZXlzID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAhPSBu
dWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdo
aWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAga2V5cy5hZGQoY3Vyc29yLmdldEtleSgpKTsKICAg
IH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVybiAoU3RyaW5nW10pa2V5cy50b0Fy
cmF5KG5ldyBTdHJpbmdbMF0pOwp9CgovLyByZXR1cm5zIGFsbCB0aGUgdmFsdWVzIGluIHRoZSBn
aXZlbiBkb2N1bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgT2JqZWN0W10gdmFs
dWVzZXQoSURhdGEgaW5wdXQpIHsKICBqYXZhLnV0aWwuTGlzdDxPYmplY3Q+IHZhbHVlcyA9IG5l
dyBqYXZhLnV0aWwuQXJyYXlMaXN0PE9iamVjdD4oKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewog
ICAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB3aGlsZShjdXJz
b3IubmV4dCgpKSB7CiAgICAgIHZhbHVlcy5hZGQoY3Vyc29yLmdldFZhbHVlKCkpOwogICAgfQog
ICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIChPYmplY3RbXSl2YWx1ZXMudG9BcnJh
eShuZXcgT2JqZWN0WzBdKTsKfQoKLy8gbWVyZ2VzIG11bHRpcGxlIElEYXRhIGRvY3VtZW50cyBp
bnRvIGEgc2luZ2xlIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgbWVyZ2UoSURhdGFbXSBp
bnB1dCkgewogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBpZiAoaW5w
dXQgIT0gbnVsbCkgewogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykg
ewogICAgICBJRGF0YVV0aWwubWVyZ2UoaW5wdXRbaV0sIG91dHB1dCk7CiAgICB9CiAgfQogIHJl
dHVybiBvdXRwdXQ7Cn0KCi8vIHNvcnRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCBieSBpdHMg
a2V5cyBpbiBuYXR1cmFsIGFzY2VuZGluZyBvcmRlcgpwdWJsaWMgc3RhdGljIElEYXRhIHNvcnQo
SURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1
cm4gbnVsbDsKCiAgU3RyaW5nW10ga2V5cyA9IGtleXNldChpbnB1dCk7CiAgamF2YS51dGlsLkFy
cmF5cy5zb3J0KGtleXMpOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7
CiAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNvciBvYyA9
IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgZm9yIChpbnQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsg
aSsrKSB7CiAgICBib29sZWFuIHJlc3VsdDsKCiAgICBpZiAoaSA+IDAgJiYga2V5c1tpXS5lcXVh
bHMoa2V5c1tpLTFdKSkgewogICAgICByZXN1bHQgPSBpYy5uZXh0KGtleXNbaV0pOwogICAgfSBl
bHNlIHsKICAgICAgcmVzdWx0ID0gaWMuZmlyc3Qoa2V5c1tpXSk7CiAgICB9CgogICAgaWYgKHJl
c3VsdCkgewogICAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoKICAgICAgaWYgKHZh
bHVlICE9IG51bGwgJiYgcmVjdXJzZSkgewogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElE
YXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IHNvcnQoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAg
ICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5j
ZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICBJRGF0YVtdIGFycmF5ID0gdmFsdWUg
aW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxl
KXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgYXJyYXku
bGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgYXJyYXlbal0gPSBzb3J0KGFycmF5W2pdLCByZWN1
cnNlKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgICAgfQogICAg
ICB9CiAgICAgIG9jLmluc2VydEFmdGVyKGtleXNbaV0sIHZhbHVlKTsKICAgIH0KICB9CgogIGlj
LmRlc3Ryb3koKTsKICBvYy5kZXN0cm95KCk7CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHRyaW1z
IGFsbCBzdHJpbmcgdmFsdWVzLCB0aGVuIGNvbnZlcnRzIGVtcHR5IHN0cmluZ3MgdG8gbnVsbHMs
IHRoZW4gY29tcGFjdHMgYnkgcmVtb3ZpbmcgYWxsIG51bGwgdmFsdWVzCnB1YmxpYyBzdGF0aWMg
SURhdGEgc3F1ZWV6ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0
ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3Jl
YXRlKCk7CiAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNv
ciBvYyA9IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICBTdHJp
bmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoK
ICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmlu
ZykgewogICAgICAgIFN0cmluZyBzdHJpbmcgPSAoU3RyaW5nKXZhbHVlOwogICAgICAgIHN0cmlu
ZyA9IHN0cmluZy50cmltKCk7CiAgICAgICAgaWYgKHN0cmluZy5lcXVhbHMoIiIpKSBzdHJpbmcg
PSBudWxsOwoKICAgICAgICB2YWx1ZSA9IHN0cmluZzsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSBp
bnN0YW5jZW9mIFN0cmluZ1tdKSB7CiAgICAgICAgU3RyaW5nW10gYXJyYXkgPSAoU3RyaW5nW10p
dmFsdWU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewog
ICAgICAgICAgaWYgKGFycmF5W2ldICE9IG51bGwpIHsKICAgICAgICAgICAgYXJyYXlbaV0gPSBh
cnJheVtpXS50cmltKCk7CiAgICAgICAgICAgIGlmIChhcnJheVtpXS5lcXVhbHMoIiIpKSBhcnJh
eVtpXSA9IG51bGw7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YWx1ZSA9IGFycmF5
OwogICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAg
IFN0cmluZ1tdW10gYXJyYXkgPSAoU3RyaW5nW11bXSl2YWx1ZTsKICAgICAgICBmb3IgKGludCBp
ID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBmb3IgKGludCBqID0gMDsg
aiA8IGFycmF5W2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGlmIChhcnJheVtpXVtqXSAh
PSBudWxsKSB7CiAgICAgICAgICAgICAgYXJyYXlbaV1bal0gPSBhcnJheVtpXVtqXS50cmltKCk7
CiAgICAgICAgICAgICAgaWYgKGFycmF5W2ldW2pdLmVxdWFscygiIikpIGFycmF5W2ldW2pdID0g
bnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFsdWUg
PSBhcnJheTsKICAgICAgfSBlbHNlIGlmIChyZWN1cnNlICYmIHZhbHVlIGluc3RhbmNlb2YgSURh
dGEpIHsKICAgICAgICB2YWx1ZSA9IHNxdWVlemUoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAg
ICAgfSBlbHNlIGlmIChyZWN1cnNlICYmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFs
dWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkpIHsKICAgICAgICBJRGF0YVtdIGFycmF5
ID0gdmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51
dGlsLlRhYmxlKXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8
IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhcnJheVtpXSA9IHNxdWVlemUoYXJyYXlb
aV0sIHJlY3Vyc2UpOwogICAgICAgIH0KCiAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgfQoK
ICAgICAgb2MuaW5zZXJ0QWZ0ZXIoa2V5LCB2YWx1ZSk7CiAgICB9CiAgfQoKICBpYy5kZXN0cm95
KCk7CiAgb2MuZGVzdHJveSgpOwoKICByZXR1cm4gY29tcGFjdChvdXRwdXQsIHJlY3Vyc2UpOwp9
CgovLyByZXR1cm5zIHRoZSBudW1iZXIgb2YgdG9wLWxldmVsIHtrZXksIHZhbHVlfSBwYWlycyBp
biB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBpbnQgc2l6ZShJRGF0YSBp
bnB1dCkgewogIGludCBzaXplID0gMDsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFD
dXJzb3IgY3Vyc29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBzaXplID0gSURhdGFVdGlsLnNp
emUoY3Vyc29yKTsKICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVybiBzaXplOwp9Cgov
LyByZXR1cm5zIGEgY2xvbmUgb2YgdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0
aWMgSURhdGEgZHVwbGljYXRlKElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHRocm93cyBT
ZXJ2aWNlRXhjZXB0aW9uIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwogIGlmIChpbnB1dCAhPSBu
dWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHRy
eSB7CiAgICAgIGlmIChyZWN1cnNlKSB7CiAgICAgICAgb3V0cHV0ID0gSURhdGFVdGlsLmRlZXBD
bG9uZShpbnB1dCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3V0cHV0ID0gSURhdGFVdGlsLmNs
b25lKGlucHV0KTsKICAgICAgfQogICAgfSBjYXRjaCAoamF2YS5pby5JT0V4Y2VwdGlvbiBleCkg
ewogICAgICB0dW5kcmEuZXhjZXB0aW9uLnJhaXNlKGV4KTsKICAgIH0gZmluYWxseSB7CiAgICAg
IGN1cnNvci5kZXN0cm95KCk7CiAgICB9CiAgfQogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJlbW92
ZXMgdGhlIHZhbHVlIHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1
bWVudApwdWJsaWMgc3RhdGljIElEYXRhIGRyb3AoSURhdGEgaW5wdXQsIFN0cmluZyBrZXkpIHsK
ICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBrZXkgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vy
c29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5
KTsKICAgIGN1cnNvci5kZXN0cm95KCk7CgogICAgaWYgKHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50
LktleS5pc0Z1bGx5UXVhbGlmaWVkKGtleSkpIGRyb3AoaW5wdXQsIHR1bmRyYS5zdXBwb3J0LmRv
Y3VtZW50LktleS5wYXJzZShrZXkpKTsKICB9CiAgcmV0dXJuIGlucHV0Owp9CgovLyByZW1vdmVz
IHRoZSB2YWx1ZSB3aXRoIHRoZSBnaXZlbiBrZXkgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1l
bnQKcHJvdGVjdGVkIHN0YXRpYyBJRGF0YSBkcm9wKElEYXRhIGlucHV0LCBqYXZhLnV0aWwuUXVl
dWU8dHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5PiBrZXlzKSB7CiAgaWYgKGlucHV0ICE9IG51
bGwgJiYga2V5cyAhPSBudWxsICYmIGtleXMuc2l6ZSgpID4gMCkgewogICAgSURhdGFDdXJzb3Ig
Y3Vyc29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5L
ZXkga2V5ID0ga2V5cy5yZW1vdmUoKTsKCiAgICBpZiAoa2V5cy5zaXplKCkgPiAwKSB7CiAgICAg
IGlmIChrZXkuaGFzSW5kZXgoKSkgewogICAgICAgIElEYXRhW10gYXJyYXkgPSBJRGF0YVV0aWwu
Z2V0SURhdGFBcnJheShjdXJzb3IsIGtleS50b1N0cmluZygpKTsKICAgICAgICBkcm9wKHR1bmRy
YS5saXN0Lm9iamVjdC5nZXQoYXJyYXksIGtleS5nZXRJbmRleCgpKSwga2V5cyk7CiAgICAgIH0g
ZWxzZSB7CiAgICAgICAgZHJvcChJRGF0YVV0aWwuZ2V0SURhdGEoY3Vyc29yLCBrZXkudG9TdHJp
bmcoKSksIGtleXMpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoa2V5Lmhhc0luZGV4
KCkpIHsKICAgICAgICBPYmplY3RbXSBhcnJheSA9IElEYXRhVXRpbC5nZXRPYmplY3RBcnJheShj
dXJzb3IsIGtleS50b1N0cmluZygpKTsKICAgICAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwga2V5
LnRvU3RyaW5nKCksIHR1bmRyYS5saXN0Lm9iamVjdC5kcm9wKGFycmF5LCBrZXkuZ2V0SW5kZXgo
KSkpOwogICAgICB9IGVsc2UgewogICAgICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXku
dG9TdHJpbmcoKSk7CiAgICAgIH0KICAgIH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJl
dHVybiBpbnB1dDsKfQoKLy8gdmlzaXRzIGVhY2ggZWxlbWVudCBpbiB0aGUgZ2l2ZW4gSURhdGEg
ZG9jdW1lbnQsIGNhbGxzIHRoZSBnaXZlbiBzZXJ2aWNlIHRvIGNvbnZlcnQgdGhlIGVsZW1lbnQs
IGFuZCBjcmVhdGVzIGEgbmV3IElEYXRhIGRvY3VtZW50IHdpdGggdGhlIHJlc3VsdGluZyBlbGVt
ZW50cwpwdWJsaWMgc3RhdGljIElEYXRhIG1hcChJRGF0YSBpbnB1dCwgU3RyaW5nIHNlcnZpY2Us
IElEYXRhIHBpcGVsaW5lLCBTdHJpbmcga2V5SW5wdXQsIFN0cmluZyBrZXlPdXRwdXQsIFN0cmlu
ZyB2YWx1ZUlucHV0LCBTdHJpbmcgdmFsdWVPdXRwdXQsIENsYXNzIHZhbHVlQ2xhc3MsIGJvb2xl
YW4gcmVjdXJzZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIElEYXRhIG91dHB1dCA9IG51
bGw7CgogIGlmIChpbnB1dCAhPSBudWxsICYmIHNlcnZpY2UgIT0gbnVsbCkgewogICAgSURhdGFD
dXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIG91dHB1dCA9IElEYXRhRmFjdG9yeS5j
cmVhdGUoKTsKICAgIElEYXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICAgIGlm
IChrZXlJbnB1dCA9PSBudWxsKSBrZXlJbnB1dCA9ICIka2V5IjsKICAgIGlmIChrZXlPdXRwdXQg
PT0gbnVsbCkga2V5T3V0cHV0ID0ga2V5SW5wdXQ7CiAgICBpZiAodmFsdWVJbnB1dCA9PSBudWxs
KSB2YWx1ZUlucHV0ID0gIiR2YWx1ZSI7CiAgICBpZiAodmFsdWVPdXRwdXQgPT0gbnVsbCkgdmFs
dWVPdXRwdXQgPSB2YWx1ZUlucHV0OwogICAgaWYgKHBpcGVsaW5lID09IG51bGwpIHBpcGVsaW5l
ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwoKICAgIHRyeSB7CiAgICAgIHdoaWxlKGljLm5leHQo
KSkgewogICAgICAgIFR1cGxlPE9iamVjdD4gdHVwbGUgPSBuZXcgVHVwbGU8T2JqZWN0PihpYy5n
ZXRLZXkoKSwgaWMuZ2V0VmFsdWUoKSk7CgogICAgICAgIGlmIChyZWN1cnNlICYmIHR1cGxlLnZh
bHVlICE9IG51bGwpIHsKICAgICAgICAgIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIElEYXRh
KSB7CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0gbWFwKChJRGF0YSl0dXBsZS52YWx1ZSwgc2Vy
dmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0
cHV0LCB2YWx1ZUNsYXNzLCByZWN1cnNlKTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFs
dWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0
aWwuVGFibGUpIHsKICAgICAgICAgICAgSURhdGFbXSBpYXJ5ID0gdHVwbGUudmFsdWUgaW5zdGFu
Y2VvZiBJRGF0YVtdID8gKElEYXRhW10pdHVwbGUudmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxl
KXR1cGxlLnZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICAgICAgSURhdGFbXSBvYXJ5ID0gbmV3
IElEYXRhW2lhcnkubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5
Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgb2FyeVtpXSA9IG1hcChpYXJ5W2ldLCBzZXJ2
aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRw
dXQsIHZhbHVlQ2xhc3MsIHJlY3Vyc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1cGxl
LnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5zdGFuY2Vv
ZiBTdHJpbmdbXVtdKSB7CiAgICAgICAgICAgIFN0cmluZ1tdW10gaWFyeSA9IChTdHJpbmdbXVtd
KXR1cGxlLnZhbHVlOwogICAgICAgICAgICBTdHJpbmdbXVtdIG9hcnkgPSBuZXcgU3RyaW5nW2lh
cnkubGVuZ3RoXVtdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3Ro
OyBpKyspIHsKICAgICAgICAgICAgICBpZiAoaWFyeVtpXSAhPSBudWxsKSB7CiAgICAgICAgICAg
ICAgICBvYXJ5W2ldID0gbmV3IFN0cmluZ1tpYXJ5W2ldLmxlbmd0aF07CiAgICAgICAgICAgICAg
ICBmb3IgKGludCBqID0gMDsgaiA8IGlhcnlbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAg
ICAgICAgVHVwbGU8U3RyaW5nPiB0ID0gbWFwKG5ldyBUdXBsZTxTdHJpbmc+KHR1cGxlLmtleSwg
aWFyeVtpXVtqXSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1
ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgICAgIG9hcnlb
aV1bal0gPSB0LnZhbHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgfQogICAgICAgICAgICB0dXBsZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9IGVsc2Ug
aWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgICAgU3RyaW5n
W10gaWFyeSA9IChTdHJpbmdbXSl0dXBsZS52YWx1ZTsKICAgICAgICAgICAgU3RyaW5nW10gb2Fy
eSA9IG5ldyBTdHJpbmdbaWFyeS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg
aSA8IGlhcnkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBUdXBsZTxTdHJpbmc+IHQgPSBt
YXAobmV3IFR1cGxlPFN0cmluZz4odHVwbGUua2V5LCBpYXJ5W2ldKSwgc2VydmljZSwgcGlwZWxp
bmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNs
YXNzKTsKICAgICAgICAgICAgICBvYXJ5W2ldID0gdC52YWx1ZTsKICAgICAgICAgICAgfQogICAg
ICAgICAgICB0dXBsZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZh
bHVlIGluc3RhbmNlb2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgT2JqZWN0W10gaWFyeSA9IChP
YmplY3RbXSl0dXBsZS52YWx1ZTsKICAgICAgICAgICAgT2JqZWN0W10gb2FyeSA9IG5ldyBPYmpl
Y3RbaWFyeS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVu
Z3RoOyBpKyspIHsKICAgICAgICAgICAgICBUdXBsZTxPYmplY3Q+IHQgPSBtYXAobmV3IFR1cGxl
PE9iamVjdD4odHVwbGUua2V5LCBpYXJ5W2ldKSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0
LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAg
ICAgICAgICBvYXJ5W2ldID0gdC52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0dXBs
ZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHR1cGxlID0gbWFw
KHR1cGxlLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1
dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwogICAgICAgIElEYXRhVXRpbC5wdXQob2MsIHR1
cGxlLmtleSwgdHVwbGUudmFsdWUpOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBpYy5k
ZXN0cm95KCk7CiAgICAgIG9jLmRlc3Ryb3koKTsKICAgIH0KICB9IGVsc2UgewogICAgb3V0cHV0
ID0gZHVwbGljYXRlKGlucHV0LCByZWN1cnNlKTsKICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8v
IHdyYXBwZXIgY2xhc3MgZm9yIHtrZXksIHZhbHVlfSB0dXBsZXMKcHJvdGVjdGVkIHN0YXRpYyBj
bGFzcyBUdXBsZTxUPiB7IAogIHB1YmxpYyBTdHJpbmcga2V5OwogIHB1YmxpYyBUIHZhbHVlOwog
IHB1YmxpYyBUdXBsZShTdHJpbmcga2V5LCBUIHZhbHVlKSB7IAogICAgdGhpcy5rZXkgPSBrZXk7
IAogICAgdGhpcy52YWx1ZSA9IHZhbHVlOyAKICB9Cn0KCi8vIGNvbnZlcnRzIHRoZSBnaXZlbiBl
bGVtZW50IGJ5IGNhbGxpbmcgdGhlIGdpdmVuIHNlcnZpY2UsIGFuZCByZXR1cm5zIHRoZSByZXN1
bHQKcHJvdGVjdGVkIHN0YXRpYyA8VD4gVHVwbGU8VD4gbWFwKFR1cGxlPFQ+IHR1cGxlLCBTdHJp
bmcgc2VydmljZSwgSURhdGEgcGlwZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIGtleU91
dHB1dCwgU3RyaW5nIHZhbHVlSW5wdXQsIFN0cmluZyB2YWx1ZU91dHB1dCwgQ2xhc3MgdmFsdWVD
bGFzcykgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIGlmICh0dXBsZS52YWx1ZSA9PSBudWxs
IHx8IHZhbHVlQ2xhc3MgPT0gbnVsbCB8fCB2YWx1ZUNsYXNzLmlzSW5zdGFuY2UodHVwbGUudmFs
dWUpKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsKICAg
IElEYXRhVXRpbC5wdXQoY3Vyc29yLCBrZXlJbnB1dCwgdHVwbGUua2V5KTsKICAgIElEYXRhVXRp
bC5wdXQoY3Vyc29yLCB2YWx1ZUlucHV0LCB0dXBsZS52YWx1ZSk7CiAgICBjdXJzb3IuZGVzdHJv
eSgpOwoKICAgIHBpcGVsaW5lID0gdHVuZHJhLnNlcnZpY2UuaW52b2tlKHNlcnZpY2UsIHBpcGVs
aW5lKTsKCiAgICAvLyBjbGVhbiB1cCB0aGUgaW5wdXQgcGlwZWxpbmUKICAgIGN1cnNvciA9IHBp
cGVsaW5lLmdldEN1cnNvcigpOwogICAgdHVwbGUua2V5ID0gSURhdGFVdGlsLmdldFN0cmluZyhj
dXJzb3IsIGtleU91dHB1dCk7CiAgICB0dXBsZS52YWx1ZSA9IChUKUlEYXRhVXRpbC5nZXQoY3Vy
c29yLCB2YWx1ZU91dHB1dCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5SW5wdXQp
OwogICAgaWYgKCFrZXlJbnB1dC5lcXVhbHMoa2V5T3V0cHV0KSkgSURhdGFVdGlsLnJlbW92ZShj
dXJzb3IsIGtleU91dHB1dCk7CiAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwgdmFsdWVJbnB1
dCk7CiAgICBpZiAoIXZhbHVlSW5wdXQuZXF1YWxzKHZhbHVlT3V0cHV0KSkgSURhdGFVdGlsLnJl
bW92ZShjdXJzb3IsIHZhbHVlT3V0cHV0KTsKICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfSAgCiAg
cmV0dXJuIHR1cGxlOwp9CgovLyBpbnZva2VzIHRoZSBnaXZlbiBzZXJ2aWNlIGZvciBlYWNoIHtr
ZXksIHZhbHVlfSBwYWlyIGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGlj
IHZvaWQgZWFjaChJRGF0YSBpbnB1dCwgU3RyaW5nIHNlcnZpY2UsIElEYXRhIHBpcGVsaW5lLCBT
dHJpbmcga2V5SW5wdXQsIFN0cmluZyB2YWx1ZUlucHV0LCBDbGFzcyB2YWx1ZUNsYXNzLCBib29s
ZWFuIHJlY3Vyc2UpIHRocm93cyBTZXJ2aWNlRXhjZXB0aW9uIHsKICBtYXAoaW5wdXQsIHNlcnZp
Y2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwgbnVsbCwgdmFsdWVJbnB1dCwgbnVsbCwgdmFsdWVDbGFz
cywgcmVjdXJzZSk7Cn0KCi8vIHJlbmFtZXMgYSBrZXkgZnJvbSBzb3VyY2UgdG8gdGFyZ2V0IHdp
dGhpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSByZW5hbWUo
SURhdGEgaW5wdXQsIFN0cmluZyBzb3VyY2UsIFN0cmluZyB0YXJnZXQpIHsKICBpZiAoIXNvdXJj
ZS5lcXVhbHModGFyZ2V0KSkgaW5wdXQgPSBkcm9wKGNvcHkoaW5wdXQsIHNvdXJjZSwgdGFyZ2V0
KSwgc291cmNlKTsKICByZXR1cm4gaW5wdXQ7Cn0KCi8vIGNvcGllcyBhIHZhbHVlIGZyb20gc291
cmNlIGtleSB0byB0YXJnZXQga2V5IHdpdGhpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVi
bGljIHN0YXRpYyBJRGF0YSBjb3B5KElEYXRhIGlucHV0LCBTdHJpbmcgc291cmNlLCBTdHJpbmcg
dGFyZ2V0KSB7CiAgaWYgKHNvdXJjZS5lcXVhbHModGFyZ2V0KSkgcmV0dXJuIGlucHV0OwogIHJl
dHVybiB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5wdXQoaW5wdXQsIHRhcmdldCwgdHVuZHJhLnN1
cHBvcnQuZG9jdW1lbnQuZ2V0KGlucHV0LCBzb3VyY2UpKTsKfQoKLy8gcmVtb3ZlcyBhbGwgbnVs
bCB2YWx1ZXMgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0
YSBjb21wYWN0KElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBJRGF0YSBvdXRwdXQg
PSBudWxsOwoKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgb3V0cHV0ID0gSURhdGFGYWN0b3J5
LmNyZWF0ZSgpOwogICAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIElE
YXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNvcigpOwoKICAgIHRyeSB7CiAgICAgIHdoaWxl
KGljLm5leHQoKSkgewogICAgICAgIFN0cmluZyBrZXkgPSBpYy5nZXRLZXkoKTsKICAgICAgICBP
YmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoKICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkg
ewogICAgICAgICAgaWYgKHJlY3Vyc2UpIHsKICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNl
b2YgSURhdGEpIHsKICAgICAgICAgICAgICB2YWx1ZSA9IGNvbXBhY3QoKElEYXRhKXZhbHVlLCBy
ZWN1cnNlKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10p
IHsKICAgICAgICAgICAgICBJRGF0YVtdIGFycmF5ID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBh
Y3QoKElEYXRhW10pdmFsdWUpOwogICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJy
YXkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGFycmF5W2ldID0gY29tcGFjdChhcnJh
eVtpXSwgcmVjdXJzZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhbHVlID0gYXJy
YXk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXVtdKSB7
CiAgICAgICAgICAgICAgU3RyaW5nW11bXSBhcnJheSA9IChTdHJpbmdbXVtdKXZhbHVlOwogICAg
ICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAg
ICAgICAgICAgIGFycmF5W2ldID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoYXJyYXlbaV0p
OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YWx1ZSA9IGFycmF5OwogICAgICAgICAg
ICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgICAgICB2
YWx1ZSA9IHR1bmRyYS5saXN0Lm9iamVjdC5jb21wYWN0KChTdHJpbmdbXSl2YWx1ZSk7CiAgICAg
ICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBPYmplY3RbXSkgewogICAgICAgICAg
ICAgIHZhbHVlID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoKE9iamVjdFtdKXZhbHVlKTsK
ICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbHVlICE9
IG51bGwpIElEYXRhVXRpbC5wdXQob2MsIGtleSwgdmFsdWUpOwogICAgICB9CiAgICB9IGZpbmFs
bHkgewogICAgICBpYy5kZXN0cm95KCk7CiAgICAgIG9jLmRlc3Ryb3koKTsKICAgIH0KICB9Cgog
IHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJldHVybnMgYSBuZXcgSURhdGEgZG9jdW1lbnQsIHdoZXJl
IGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVkIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwK
Ly8gZnVsbHkgcXVhbGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0
dXJlCnB1YmxpYyBzdGF0aWMgSURhdGEgbm9ybWFsaXplKElEYXRhIGlucHV0LCBib29sZWFuIHJl
Y3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhIG91dHB1
dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1
cnNvcigpOwoKICB0cnkgewogICAgd2hpbGUoaWMubmV4dCgpKSB7CiAgICAgIFN0cmluZyBrZXkg
PSBpYy5nZXRLZXkoKTsKICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICAg
IGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29tLndt
LnV0aWwuY29kZXIuSURhdGFDb2RhYmxlKSB7CiAgICAgICAgICB2YWx1ZSA9ICgoY29tLndtLnV0
aWwuY29kZXIuSURhdGFDb2RhYmxlKXZhbHVlKS5nZXRJRGF0YSgpOwogICAgICAgIH0gZWxzZSBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5WYWx1ZXNDb2RhYmxlKSB7CiAg
ICAgICAgICB2YWx1ZSA9ICgoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZSl2YWx1ZSku
Z2V0VmFsdWVzKCk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51
dGlsLmNvZGVyLklEYXRhQ29kYWJsZVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgo
Y29tLndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxlW10pdmFsdWUsIHJlY3Vyc2UpOwogICAgICAg
IH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5WYWx1ZXNDb2Rh
YmxlW10pIHsKICAgICAgICAgIHZhbHVlID0gbm9ybWFsaXplKChjb20ud20udXRpbC5jb2Rlci5W
YWx1ZXNDb2RhYmxlW10pdmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUg
aW5zdGFuY2VvZiBJRGF0YVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoSURhdGFb
XSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNv
bS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoKGNvbS53bS51
dGlsLlRhYmxlKXZhbHVlKS5nZXRWYWx1ZXMoKSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlm
IChyZWN1cnNlICYmIHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAgIHZhbHVlID0g
bm9ybWFsaXplKChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfQogICAgICB9CiAgICAg
IHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LnB1dChvdXRwdXQsIGtleSwgdmFsdWUpOwogICAgfQog
IH0gZmluYWxseSB7CiAgICBpYy5kZXN0cm95KCk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9Cgov
LyBub3JtYWxpemVzIGFuIElEYXRhW10sIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVk
IHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwKLy8gZnVsbHkgcXVhbGlmaWVkIGtleXMgYXJl
IHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnByb3RlY3RlZCBzdGF0aWMgSURhdGFb
XSBub3JtYWxpemUoSURhdGFbXSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0
ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YVtdIG91dHB1dCA9IG5ldyBJRGF0YVtpbnB1
dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHsKICAg
IG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtpXSwgcmVjdXJzZSk7CiAgfQoKICByZXR1cm4g
b3V0cHV0Owp9CgovLyBjb252ZXJ0cyBhbiBJRGF0YUNvZGFibGVbXSB0byBhbiBJRGF0YVtdIGFu
ZCBub3JtYWxpemVzLCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCAKLy8gd2l0aCB0
aGUgc2FtZSBjbGFzcywgYW5kIGFsbCBmdWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVwbGFjZWQg
d2l0aCBhIG5lc3RlZCBzdHJ1Y3R1cmUKcHJvdGVjdGVkIHN0YXRpYyBJRGF0YVtdIG5vcm1hbGl6
ZShjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVbXSBpbnB1dCwgYm9vbGVhbiByZWN1cnNl
KSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YVtdIG91dHB1dCA9
IG5ldyBJRGF0YVtpbnB1dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQubGVu
Z3RoOyBpKyspIHsKICAgIG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtpXS5nZXRJRGF0YSgp
LCByZWN1cnNlKTsKICB9CiAgCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29udmVydHMgYSBWYWx1
ZXNDb2RhYmxlW10gdG8gYW4gSURhdGFbXSBhbmQgbm9ybWFsaXplcywgd2hlcmUgYWxsIElEYXRh
cyBhcmUgaW1wbGVtZW50ZWQgCi8vIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwgZnVsbHkg
cXVhbGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnByb3Rl
Y3RlZCBzdGF0aWMgSURhdGFbXSBub3JtYWxpemUoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29k
YWJsZVtdIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0
dXJuIG51bGw7CgogIElEYXRhW10gb3V0cHV0ID0gbmV3IElEYXRhW2lucHV0Lmxlbmd0aF07CiAg
Zm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgb3V0cHV0W2ldID0g
bm9ybWFsaXplKGlucHV0W2ldLmdldFZhbHVlcygpLCByZWN1cnNlKTsKICB9CiAgCiAgcmV0dXJu
IG91dHB1dDsKfQoKLy8gcmVtb3ZlcyBhbGwga2V5cyBleGNlcHQgdGhvc2Ugc3BlY2lmaWVkIGZy
b20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgdm9pZCBjbGVhcihJRGF0
YSBkb2N1bWVudCwgU3RyaW5nW10ga2V5cykgewogIGlmIChkb2N1bWVudCA9PSBudWxsKSByZXR1
cm47CgogIElEYXRhIHNhdmVkID0gbnVsbDsKICBpZiAoa2V5cyAhPSBudWxsKSB7CiAgICBzYXZl
ZCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwga2V5cy5s
ZW5ndGg7IGkrKykgewogICAgICBPYmplY3QgdmFsdWUgPSB0dW5kcmEuc3VwcG9ydC5kb2N1bWVu
dC5nZXQoZG9jdW1lbnQsIGtleXNbaV0pOwogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgdHVuZHJh
LnN1cHBvcnQuZG9jdW1lbnQucHV0KHNhdmVkLCBrZXlzW2ldLCB2YWx1ZSk7CiAgICB9CiAgfQoK
ICBJRGF0YUN1cnNvciBjdXJzb3IgPSBkb2N1bWVudC5nZXRDdXJzb3IoKTsKICBjdXJzb3IuZmly
c3QoKTsKICB3aGlsZShjdXJzb3IuZGVsZXRlKCkpOwogIGN1cnNvci5kZXN0cm95KCk7CgogIGlm
IChrZXlzICE9IG51bGwpIElEYXRhVXRpbC5tZXJnZShzYXZlZCwgZG9jdW1lbnQpOwp9CgovLyBw
ZXJmb3JtcyB2YXJpYWJsZSBzdWJzdGl0dXRpb24gb24gYWxsIGVsZW1lbnRzIG9mIHRoZSBnaXZl
biBJRGF0YSBpbnB1dCBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIHN1YnN0aXR1dGUoSURh
dGEgaW5wdXQsIElEYXRhIHNjb3BlLCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0g
bnVsbCkgcmV0dXJuIG51bGw7CiAgaWYgKHNjb3BlID09IG51bGwpIHNjb3BlID0gaW5wdXQ7Cgog
IElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKCiAgSURhdGFDdXJzb3IgaWMg
PSBpbnB1dC5nZXRDdXJzb3IoKTsKICBJRGF0YUN1cnNvciBvYyA9IG91dHB1dC5nZXRDdXJzb3Io
KTsKCiAgdHJ5IHsKICAgIHdoaWxlKGljLm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaWMu
Z2V0S2V5KCk7CiAgICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CiAgICAgIGlmICh2
YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgaWYgKHJlY3Vyc2UgJiYgdmFsdWUgaW5zdGFuY2VvZiBJ
RGF0YSkgewogICAgICAgICAgdmFsdWUgPSBzdWJzdGl0dXRlKChJRGF0YSl2YWx1ZSwgc2NvcGUs
IHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiAodmFsdWUgaW5zdGFuY2Vv
ZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpKSB7CiAgICAg
ICAgICBJRGF0YVtdIGlhcnkgPSB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl2
YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAg
SURhdGFbXSBvYXJ5ID0gbmV3IElEYXRhW2lhcnkubGVuZ3RoXTsKICAgICAgICAgIGZvciAoaW50
IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgb2FyeVtpXSA9IHN1YnN0aXR1dGUoaWFyeVtp
XSwgc2NvcGUsIHJlY3Vyc2UpOwogICAgICAgICAgdmFsdWUgPSBvYXJ5OwogICAgICAgIH0gZWxz
ZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgIHZhbHVlID0gdHVuZHJh
LnN0cmluZy5zdWJzdGl0dXRlKChTdHJpbmcpdmFsdWUsIHNjb3BlKTsKICAgICAgICB9IGVsc2Ug
aWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW10pIHsKICAgICAgICAgIHZhbHVlID0gdHVuZHJh
Lmxpc3Quc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZ1tdKXZhbHVlLCBzY29wZSk7CiAgICAgICAg
fSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdW10pIHsKICAgICAgICAgIHZhbHVl
ID0gdHVuZHJhLmxpc3Quc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZ1tdW10pdmFsdWUsIHNjb3Bl
KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgSURhdGFVdGlsLnB1dChvYywga2V5LCB2YWx1ZSk7
CiAgICB9CiAgfSBmaW5hbGx5IHsKICAgIGljLmRlc3Ryb3koKTsKICAgIG9jLmRlc3Ryb3koKTsK
ICB9CgogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHBhcnNlcyBhbiBJRGF0YSBYTUwgaW5wdXQgc3Ry
ZWFtIHRvIGFuIElEYXRhIG9iamVjdApwdWJsaWMgc3RhdGljIElEYXRhIHBhcnNlKGphdmEuaW8u
SW5wdXRTdHJlYW0gaW4pIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICBjb20ud20udXRp
bC5jb2Rlci5YTUxDb2RlcldyYXBwZXIgY29kZWMgPSBuZXcgY29tLndtLnV0aWwuY29kZXIuWE1M
Q29kZXJXcmFwcGVyKCk7CiAgcmV0dXJuIGNvZGVjLmRlY29kZShpbik7Cn0KCi8vIHBhcnNlcyBh
biBJRGF0YSBYTUwgc3RyaW5nLCBieXRlIGFycmF5IG9yIGlucHV0IHN0cmVhbSB0byBhbiBJRGF0
YSBvYmplY3QKcHVibGljIHN0YXRpYyBJRGF0YSBwYXJzZShPYmplY3QgY29udGVudCwgU3RyaW5n
IGVuY29kaW5nKSB0aHJvd3MgamF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgcmV0dXJuIHBhcnNlKChq
YXZhLmlvLklucHV0U3RyZWFtKXR1bmRyYS5vYmplY3QuY29udmVydChjb250ZW50LCBlbmNvZGlu
ZywgInN0cmVhbSIpKTsKfQoKLy8gZW1pdHMgYW4gSURhdGEgb2JqZWN0IGFzIGEgYW4gSURhdGEg
WE1MIHN0cmluZywgYnl0ZSBhcnJheSBvciBzdHJlYW0KcHVibGljIHN0YXRpYyBPYmplY3QgZW1p
dChJRGF0YSBkb2N1bWVudCwgU3RyaW5nIGVuY29kaW5nLCBTdHJpbmcgbW9kZSkgdGhyb3dzIGph
dmEuaW8uSU9FeGNlcHRpb24gewogIGNvbS53bS51dGlsLmNvZGVyLklEYXRhWE1MQ29kZXIgY29k
ZWMgPSBudWxsOwogIGlmIChlbmNvZGluZyA9PSBudWxsKSB7CiAgICBjb2RlYyA9IG5ldyBjb20u
d20udXRpbC5jb2Rlci5JRGF0YVhNTENvZGVyKCk7CiAgfSBlbHNlIHsKICAgIGNvZGVjID0gbmV3
IGNvbS53bS51dGlsLmNvZGVyLklEYXRhWE1MQ29kZXIoZW5jb2RpbmcpOwogIH0KCiAgamF2YS5p
by5CeXRlQXJyYXlPdXRwdXRTdHJlYW0gb3V0ID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0
U3RyZWFtKCk7CiAgY29kZWMuZW5jb2RlKG91dCwgZG9jdW1lbnQpOwoKICByZXR1cm4gdHVuZHJh
Lm9iamVjdC5jb252ZXJ0KG91dC50b0J5dGVBcnJheSgpLCBlbmNvZGluZywgbW9kZSk7Cn0=</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
