<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJldHVybiBkb2N1bWVudDsKCiAgZm9yIChp
bnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoYW1lbmRtZW50
c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhIGFtZW5kbWVudCA9IHN1YnN0aXR1dGUoYW1lbmRt
ZW50c1tpXSwgc2NvcGUsIHRydWUpOwogICAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBhbWVuZG1l
bnQuZ2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1
cnNvciwgImtleSIpOwogICAgICBPYmplY3QgdmFsdWUgPSBJRGF0YVV0aWwuZ2V0KGN1cnNvciwg
InZhbHVlIik7CiAgICAgIGN1cnNvci5kZXN0cm95KCk7CiAgICAgIGRvY3VtZW50ID0gdHVuZHJh
LnN1cHBvcnQuZG9jdW1lbnQucHV0KGRvY3VtZW50LCBrZXksIHZhbHVlKTsKICAgIH0KICB9Cgog
IHJldHVybiBkb2N1bWVudDsKfQoKLy8gcmV0dXJucyB3aGV0aGVyIHR3byBkb2N1bWVudHMgYXJl
IGVxdWFsCnB1YmxpYyBzdGF0aWMgYm9vbGVhbiBlcXVhbChJRGF0YSB4LCBJRGF0YSB5KSB7CiAg
cmV0dXJuIHR1bmRyYS5vYmplY3QuZXF1YWwoeCwgeSk7Cn0KCi8vIHJldHVybnMgYWxsIHRoZSBr
ZXlzIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMg
U3RyaW5nW10ga2V5c2V0KElEYXRhIGlucHV0KSB7CiAgamF2YS51dGlsLkxpc3Q8U3RyaW5nPiBr
ZXlzID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAhPSBu
dWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdo
aWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAga2V5cy5hZGQoY3Vyc29yLmdldEtleSgpKTsKICAg
IH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVybiAoU3RyaW5nW10pa2V5cy50b0Fy
cmF5KG5ldyBTdHJpbmdbMF0pOwp9CgovLyByZXR1cm5zIGFsbCB0aGUgdmFsdWVzIGluIHRoZSBn
aXZlbiBkb2N1bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgT2JqZWN0W10gdmFs
dWVzZXQoSURhdGEgaW5wdXQpIHsKICBqYXZhLnV0aWwuTGlzdDxPYmplY3Q+IHZhbHVlcyA9IG5l
dyBqYXZhLnV0aWwuQXJyYXlMaXN0PE9iamVjdD4oKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewog
ICAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB3aGlsZShjdXJz
b3IubmV4dCgpKSB7CiAgICAgIHZhbHVlcy5hZGQoY3Vyc29yLmdldFZhbHVlKCkpOwogICAgfQog
ICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIChPYmplY3RbXSl2YWx1ZXMudG9BcnJh
eShuZXcgT2JqZWN0WzBdKTsKfQoKLy8gbWVyZ2VzIG11bHRpcGxlIElEYXRhIGRvY3VtZW50cyBp
bnRvIGEgc2luZ2xlIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgbWVyZ2UoSURhdGFbXSBp
bnB1dCkgewogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBpZiAoaW5w
dXQgIT0gbnVsbCkgewogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykg
ewogICAgICBJRGF0YVV0aWwubWVyZ2UoaW5wdXRbaV0sIG91dHB1dCk7CiAgICB9CiAgfQogIHJl
dHVybiBvdXRwdXQ7Cn0KCnB1YmxpYyBzdGF0aWMgSURhdGEgc29ydChJRGF0YSBpbnB1dCwgYm9v
bGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBTdHJp
bmdbXSBrZXlzID0ga2V5c2V0KGlucHV0KTsKICBqYXZhLnV0aWwuQXJyYXlzLnNvcnQoa2V5cyk7
CgogIElEYXRhIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBJRGF0YUN1cnNvciBp
YyA9IGlucHV0LmdldEN1cnNvcigpOwogIElEYXRhQ3Vyc29yIG9jID0gb3V0cHV0LmdldEN1cnNv
cigpOwoKICBmb3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIGJvb2xl
YW4gcmVzdWx0OwoKICAgIGlmIChpID4gMCAmJiBrZXlzW2ldLmVxdWFscyhrZXlzW2ktMV0pKSB7
CiAgICAgIHJlc3VsdCA9IGljLm5leHQoa2V5c1tpXSk7CiAgICB9IGVsc2UgewogICAgICByZXN1
bHQgPSBpYy5maXJzdChrZXlzW2ldKTsKICAgIH0KCiAgICBpZiAocmVzdWx0KSB7CiAgICAgIE9i
amVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJiBy
ZWN1cnNlKSB7CiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAg
IHZhbHVlID0gc29ydCgoSURhdGEpdmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAo
dmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwu
VGFibGUpIHsKICAgICAgICAgIElEYXRhW10gYXJyYXkgPSB2YWx1ZSBpbnN0YW5jZW9mIElEYXRh
W10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVl
cygpOwogICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBhcnJheS5sZW5ndGg7IGorKykgewog
ICAgICAgICAgICBhcnJheVtqXSA9IHNvcnQoYXJyYXlbal0sIHJlY3Vyc2UpOwogICAgICAgICAg
fQogICAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgICB9CiAgICAgIH0KICAgICAgb2MuaW5z
ZXJ0QWZ0ZXIoa2V5c1tpXSwgdmFsdWUpOwogICAgfQogIH0KCiAgaWMuZGVzdHJveSgpOwogIG9j
LmRlc3Ryb3koKTsKCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmV0dXJucyB0aGUgbnVtYmVyIG9m
IHRvcC1sZXZlbCB7a2V5LCB2YWx1ZX0gcGFpcnMgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50
CnB1YmxpYyBzdGF0aWMgaW50IHNpemUoSURhdGEgaW5wdXQpIHsKICBpbnQgc2l6ZSA9IDA7CiAg
aWYgKGlucHV0ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1
cnNvcigpOwogICAgc2l6ZSA9IElEYXRhVXRpbC5zaXplKGN1cnNvcik7CiAgICBjdXJzb3IuZGVz
dHJveSgpOwogIH0KICByZXR1cm4gc2l6ZTsKfQoKLy8gcmV0dXJucyBhIGNsb25lIG9mIHRoZSBn
aXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIGR1cGxpY2F0ZShJRGF0YSBp
bnB1dCwgYm9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgSURhdGEg
b3V0cHV0ID0gbnVsbDsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vy
c29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB0cnkgewogICAgICBpZiAocmVjdXJzZSkgewog
ICAgICAgIG91dHB1dCA9IElEYXRhVXRpbC5kZWVwQ2xvbmUoaW5wdXQpOwogICAgICB9IGVsc2Ug
ewogICAgICAgIG91dHB1dCA9IElEYXRhVXRpbC5jbG9uZShpbnB1dCk7CiAgICAgIH0KICAgIH0g
Y2F0Y2ggKGphdmEuaW8uSU9FeGNlcHRpb24gZXgpIHsKICAgICAgdHVuZHJhLmV4Y2VwdGlvbi5y
YWlzZShleCk7CiAgICB9IGZpbmFsbHkgewogICAgICBjdXJzb3IuZGVzdHJveSgpOwogICAgfQog
IH0KICByZXR1cm4gb3V0cHV0Owp9CgovLyByZW1vdmVzIHRoZSB2YWx1ZSB3aXRoIHRoZSBnaXZl
biBrZXkgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBk
cm9wKElEYXRhIGlucHV0LCBTdHJpbmcga2V5KSB7CiAgaWYgKGlucHV0ICE9IG51bGwgJiYga2V5
ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwog
ICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleSk7CiAgICBjdXJzb3IuZGVzdHJveSgpOwoK
ICAgIGlmICh0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkuaXNGdWxseVF1YWxpZmllZChrZXkp
KSBkcm9wKGlucHV0LCB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkucGFyc2Uoa2V5KSk7CiAg
fQogIHJldHVybiBpbnB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUgdmFsdWUgd2l0aCB0aGUgZ2l2ZW4g
a2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnByb3RlY3RlZCBzdGF0aWMgSURhdGEg
ZHJvcChJRGF0YSBpbnB1dCwgamF2YS51dGlsLlF1ZXVlPHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50
LktleT4ga2V5cykgewogIGlmIChpbnB1dCAhPSBudWxsICYmIGtleXMgIT0gbnVsbCAmJiBrZXlz
LnNpemUoKSA+IDApIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigp
OwogICAgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5IGtleSA9IGtleXMucmVtb3ZlKCk7Cgog
ICAgaWYgKGtleXMuc2l6ZSgpID4gMCkgewogICAgICBpZiAoa2V5Lmhhc0luZGV4KCkpIHsKICAg
ICAgICBJRGF0YVtdIGFycmF5ID0gSURhdGFVdGlsLmdldElEYXRhQXJyYXkoY3Vyc29yLCBrZXku
dG9TdHJpbmcoKSk7CiAgICAgICAgZHJvcCh0dW5kcmEubGlzdC5vYmplY3QuZ2V0KGFycmF5LCBr
ZXkuZ2V0SW5kZXgoKSksIGtleXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGRyb3AoSURhdGFV
dGlsLmdldElEYXRhKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpLCBrZXlzKTsKICAgICAgfQogICAg
fSBlbHNlIHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAgICAgICAgT2JqZWN0W10gYXJy
YXkgPSBJRGF0YVV0aWwuZ2V0T2JqZWN0QXJyYXkoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSk7CiAg
ICAgICAgSURhdGFVdGlsLnB1dChjdXJzb3IsIGtleS50b1N0cmluZygpLCB0dW5kcmEubGlzdC5v
YmplY3QuZHJvcChhcnJheSwga2V5LmdldEluZGV4KCkpKTsKICAgICAgfSBlbHNlIHsKICAgICAg
ICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICB9CiAgICB9
CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHZpc2l0cyBl
YWNoIGVsZW1lbnQgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50LCBjYWxscyB0aGUgZ2l2ZW4g
c2VydmljZSB0byBjb252ZXJ0IHRoZSBlbGVtZW50LCBhbmQgY3JlYXRlcyBhIG5ldyBJRGF0YSBk
b2N1bWVudCB3aXRoIHRoZSByZXN1bHRpbmcgZWxlbWVudHMKcHVibGljIHN0YXRpYyBJRGF0YSBt
YXAoSURhdGEgaW5wdXQsIFN0cmluZyBzZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtl
eUlucHV0LCBTdHJpbmcga2V5T3V0cHV0LCBTdHJpbmcgdmFsdWVJbnB1dCwgU3RyaW5nIHZhbHVl
T3V0cHV0LCBDbGFzcyB2YWx1ZUNsYXNzLCBib29sZWFuIHJlY3Vyc2UpIHRocm93cyBTZXJ2aWNl
RXhjZXB0aW9uIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwoKICBpZiAoaW5wdXQgIT0gbnVsbCAm
JiBzZXJ2aWNlICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29y
KCk7CiAgICBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBv
YyA9IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgICBpZiAoa2V5SW5wdXQgPT0gbnVsbCkga2V5SW5w
dXQgPSAiJGtleSI7CiAgICBpZiAoa2V5T3V0cHV0ID09IG51bGwpIGtleU91dHB1dCA9IGtleUlu
cHV0OwogICAgaWYgKHZhbHVlSW5wdXQgPT0gbnVsbCkgdmFsdWVJbnB1dCA9ICIkdmFsdWUiOwog
ICAgaWYgKHZhbHVlT3V0cHV0ID09IG51bGwpIHZhbHVlT3V0cHV0ID0gdmFsdWVJbnB1dDsKICAg
IGlmIChwaXBlbGluZSA9PSBudWxsKSBwaXBlbGluZSA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsK
CiAgICB0cnkgewogICAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgICBUdXBsZTxPYmplY3Q+
IHR1cGxlID0gbmV3IFR1cGxlPE9iamVjdD4oaWMuZ2V0S2V5KCksIGljLmdldFZhbHVlKCkpOwoK
ICAgICAgICBpZiAocmVjdXJzZSAmJiB0dXBsZS52YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICBp
ZiAodHVwbGUudmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgICB0dXBsZS52YWx1
ZSA9IG1hcCgoSURhdGEpdHVwbGUudmFsdWUsIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwg
a2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcywgcmVjdXJzZSk7
CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB0
dXBsZS52YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICAgIElE
YXRhW10gaWFyeSA9IHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXR1
cGxlLnZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl0dXBsZS52YWx1ZSkuZ2V0VmFsdWVzKCk7
CiAgICAgICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0YVtpYXJ5Lmxlbmd0aF07CiAgICAg
ICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAg
ICAgIG9hcnlbaV0gPSBtYXAoaWFyeVtpXSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBr
ZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzLCByZWN1cnNlKTsK
ICAgICAgICAgICAgfQogICAgICAgICAgICB0dXBsZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9
IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAgICAg
ICBTdHJpbmdbXVtdIGlhcnkgPSAoU3RyaW5nW11bXSl0dXBsZS52YWx1ZTsKICAgICAgICAgICAg
U3RyaW5nW11bXSBvYXJ5ID0gbmV3IFN0cmluZ1tpYXJ5Lmxlbmd0aF1bXTsKICAgICAgICAgICAg
Zm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYg
KGlhcnlbaV0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgb2FyeVtpXSA9IG5ldyBTdHJpbmdb
aWFyeVtpXS5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBpYXJ5
W2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIFR1cGxlPFN0cmluZz4gdCA9IG1h
cChuZXcgVHVwbGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV1bal0pLCBzZXJ2aWNlLCBwaXBl
bGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVl
Q2xhc3MpOwogICAgICAgICAgICAgICAgICBvYXJ5W2ldW2pdID0gdC52YWx1ZTsKICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUu
dmFsdWUgPSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9m
IFN0cmluZ1tdKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGlhcnkgPSAoU3RyaW5nW10pdHVwbGUu
dmFsdWU7CiAgICAgICAgICAgIFN0cmluZ1tdIG9hcnkgPSBuZXcgU3RyaW5nW2lhcnkubGVuZ3Ro
XTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAg
ICAgICAgICAgICAgVHVwbGU8U3RyaW5nPiB0ID0gbWFwKG5ldyBUdXBsZTxTdHJpbmc+KHR1cGxl
LmtleSwgaWFyeVtpXSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2
YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgb2FyeVtp
XSA9IHQudmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5
OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdKSB7
CiAgICAgICAgICAgIE9iamVjdFtdIGlhcnkgPSAoT2JqZWN0W10pdHVwbGUudmFsdWU7CiAgICAg
ICAgICAgIE9iamVjdFtdIG9hcnkgPSBuZXcgT2JqZWN0W2lhcnkubGVuZ3RoXTsKICAgICAgICAg
ICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg
VHVwbGU8T2JqZWN0PiB0ID0gbWFwKG5ldyBUdXBsZTxPYmplY3Q+KHR1cGxlLmtleSwgaWFyeVtp
XSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2
YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgb2FyeVtpXSA9IHQudmFsdWU7
CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5OwogICAgICAgICAg
fQogICAgICAgIH0KICAgICAgICB0dXBsZSA9IG1hcCh0dXBsZSwgc2VydmljZSwgcGlwZWxpbmUs
IGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNz
KTsKICAgICAgICBJRGF0YVV0aWwucHV0KG9jLCB0dXBsZS5rZXksIHR1cGxlLnZhbHVlKTsKICAg
ICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgpOwogICAgICBvYy5kZXN0cm95
KCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIG91dHB1dCA9IGR1cGxpY2F0ZShpbnB1dCwgcmVjdXJz
ZSk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyB3cmFwcGVyIGNsYXNzIGZvciB7a2V5LCB2
YWx1ZX0gdHVwbGVzCnByb3RlY3RlZCBzdGF0aWMgY2xhc3MgVHVwbGU8VD4geyAKICBwdWJsaWMg
U3RyaW5nIGtleTsKICBwdWJsaWMgVCB2YWx1ZTsKICBwdWJsaWMgVHVwbGUoU3RyaW5nIGtleSwg
VCB2YWx1ZSkgeyAKICAgIHRoaXMua2V5ID0ga2V5OyAKICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsg
CiAgfQp9CgovLyBjb252ZXJ0cyB0aGUgZ2l2ZW4gZWxlbWVudCBieSBjYWxsaW5nIHRoZSBnaXZl
biBzZXJ2aWNlLCBhbmQgcmV0dXJucyB0aGUgcmVzdWx0CnByb3RlY3RlZCBzdGF0aWMgPFQ+IFR1
cGxlPFQ+IG1hcChUdXBsZTxUPiB0dXBsZSwgU3RyaW5nIHNlcnZpY2UsIElEYXRhIHBpcGVsaW5l
LCBTdHJpbmcga2V5SW5wdXQsIFN0cmluZyBrZXlPdXRwdXQsIFN0cmluZyB2YWx1ZUlucHV0LCBT
dHJpbmcgdmFsdWVPdXRwdXQsIENsYXNzIHZhbHVlQ2xhc3MpIHRocm93cyBTZXJ2aWNlRXhjZXB0
aW9uIHsKICBpZiAodHVwbGUudmFsdWUgPT0gbnVsbCB8fCB2YWx1ZUNsYXNzID09IG51bGwgfHwg
dmFsdWVDbGFzcy5pc0luc3RhbmNlKHR1cGxlLnZhbHVlKSkgewogICAgSURhdGFDdXJzb3IgY3Vy
c29yID0gcGlwZWxpbmUuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwga2V5
SW5wdXQsIHR1cGxlLmtleSk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgdmFsdWVJbnB1dCwg
dHVwbGUudmFsdWUpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKCiAgICBwaXBlbGluZSA9IHR1bmRy
YS5zZXJ2aWNlLmludm9rZShzZXJ2aWNlLCBwaXBlbGluZSk7CgogICAgLy8gY2xlYW4gdXAgdGhl
IGlucHV0IHBpcGVsaW5lCiAgICBjdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsKICAgIHR1
cGxlLmtleSA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCBrZXlPdXRwdXQpOwogICAgdHVw
bGUudmFsdWUgPSAoVClJRGF0YVV0aWwuZ2V0KGN1cnNvciwgdmFsdWVPdXRwdXQpOwogICAgSURh
dGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleUlucHV0KTsKICAgIGlmICgha2V5SW5wdXQuZXF1YWxz
KGtleU91dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXlPdXRwdXQpOwogICAgSURh
dGFVdGlsLnJlbW92ZShjdXJzb3IsIHZhbHVlSW5wdXQpOwogICAgaWYgKCF2YWx1ZUlucHV0LmVx
dWFscyh2YWx1ZU91dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCB2YWx1ZU91dHB1dCk7
CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0gIAogIHJldHVybiB0dXBsZTsKfQoKLy8gaW52b2tl
cyB0aGUgZ2l2ZW4gc2VydmljZSBmb3IgZWFjaCB7a2V5LCB2YWx1ZX0gcGFpciBpbiB0aGUgZ2l2
ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyB2b2lkIGVhY2goSURhdGEgaW5wdXQsIFN0
cmluZyBzZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBTdHJpbmcgdmFs
dWVJbnB1dCwgQ2xhc3MgdmFsdWVDbGFzcywgYm9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2Vydmlj
ZUV4Y2VwdGlvbiB7CiAgbWFwKGlucHV0LCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIG51
bGwsIHZhbHVlSW5wdXQsIG51bGwsIHZhbHVlQ2xhc3MsIHJlY3Vyc2UpOwp9CgovLyByZW5hbWVz
IGEga2V5IGZyb20gc291cmNlIHRvIHRhcmdldCB3aXRoaW4gdGhlIGdpdmVuIElEYXRhIGRvY3Vt
ZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgcmVuYW1lKElEYXRhIGlucHV0LCBTdHJpbmcgc291cmNl
LCBTdHJpbmcgdGFyZ2V0KSB7CiAgaWYgKCFzb3VyY2UuZXF1YWxzKHRhcmdldCkpIGlucHV0ID0g
ZHJvcChjb3B5KGlucHV0LCBzb3VyY2UsIHRhcmdldCksIHNvdXJjZSk7CiAgcmV0dXJuIGlucHV0
Owp9CgovLyBjb3BpZXMgYSB2YWx1ZSBmcm9tIHNvdXJjZSBrZXkgdG8gdGFyZ2V0IGtleSB3aXRo
aW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgY29weShJRGF0
YSBpbnB1dCwgU3RyaW5nIHNvdXJjZSwgU3RyaW5nIHRhcmdldCkgewogIGlmIChzb3VyY2UuZXF1
YWxzKHRhcmdldCkpIHJldHVybiBpbnB1dDsKICByZXR1cm4gdHVuZHJhLnN1cHBvcnQuZG9jdW1l
bnQucHV0KGlucHV0LCB0YXJnZXQsIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LmdldChpbnB1dCwg
c291cmNlKSk7Cn0KCi8vIHJlbW92ZXMgYWxsIG51bGwgdmFsdWVzIGZyb20gdGhlIGdpdmVuIElE
YXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgY29tcGFjdChJRGF0YSBpbnB1dCwgYm9v
bGVhbiByZWN1cnNlKSB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsKCiAgaWYgKGlucHV0ICE9IG51
bGwpIHsKICAgIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgIElEYXRhQ3Vyc29y
IGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YUN1cnNvciBvYyA9IG91dHB1dC5nZXRD
dXJzb3IoKTsKCiAgICB0cnkgewogICAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgICBTdHJp
bmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUo
KTsKCiAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICAgIGlmIChyZWN1cnNlKSB7
CiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgICAgICAg
dmFsdWUgPSBjb21wYWN0KChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgICAgIH0gZWxz
ZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdKSB7CiAgICAgICAgICAgICAgSURhdGFbXSBh
cnJheSA9IHR1bmRyYS5saXN0Lm9iamVjdC5jb21wYWN0KChJRGF0YVtdKXZhbHVlKTsKICAgICAg
ICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg
ICAgICAgICBhcnJheVtpXSA9IGNvbXBhY3QoYXJyYXlbaV0sIHJlY3Vyc2UpOwogICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICB2YWx1ZSA9IGFycmF5OwogICAgICAgICAgICB9IGVsc2UgaWYg
KHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAgICAgICAgIFN0cmluZ1tdW10g
YXJyYXkgPSAoU3RyaW5nW11bXSl2YWx1ZTsKICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg
aSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBhcnJheVtpXSA9IHR1bmRy
YS5saXN0Lm9iamVjdC5jb21wYWN0KGFycmF5W2ldKTsKICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5j
ZW9mIFN0cmluZ1tdKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlzdC5vYmplY3Qu
Y29tcGFjdCgoU3RyaW5nW10pdmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGlu
c3RhbmNlb2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0Lm9i
amVjdC5jb21wYWN0KChPYmplY3RbXSl2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0K
ICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSBJRGF0YVV0aWwucHV0KG9jLCBr
ZXksIHZhbHVlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgpOwog
ICAgICBvYy5kZXN0cm95KCk7CiAgICB9CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyByZXR1
cm5zIGEgbmV3IElEYXRhIGRvY3VtZW50LCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRl
ZCB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsCi8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFy
ZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwdWJsaWMgc3RhdGljIElEYXRhIG5v
cm1hbGl6ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51
bGwpIHJldHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7
CiAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKCiAgdHJ5IHsKICAgIHdoaWxl
KGljLm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgIE9iamVj
dCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAg
ICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSkg
ewogICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSl2YWx1
ZSkuZ2V0SURhdGEoKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29tLndt
LnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZSkgewogICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51
dGlsLmNvZGVyLlZhbHVlc0NvZGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgIH0gZWxz
ZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVbXSkg
ewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29k
YWJsZVtdKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNl
b2YgY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKSB7CiAgICAgICAgICB2YWx1ZSA9
IG5vcm1hbGl6ZSgoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKXZhbHVlLCByZWN1
cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSkgewogICAg
ICAgICAgdmFsdWUgPSBub3JtYWxpemUoKElEYXRhW10pdmFsdWUsIHJlY3Vyc2UpOwogICAgICAg
IH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAg
ICAgdmFsdWUgPSBub3JtYWxpemUoKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVz
KCksIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiB2YWx1ZSBpbnN0YW5j
ZW9mIElEYXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoSURhdGEpdmFsdWUsIHJl
Y3Vyc2UpOwogICAgICAgIH0KICAgICAgfQogICAgICB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5w
dXQob3V0cHV0LCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGZpbmFsbHkgewogICAgaWMuZGVzdHJv
eSgpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gbm9ybWFsaXplcyBhbiBJRGF0YVtdLCB3
aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQg
YWxsCi8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0
cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKElEYXRhW10gaW5wdXQs
IGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAg
SURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3IgKGludCBpID0g
MDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3JtYWxpemUoaW5w
dXRbaV0sIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29udmVydHMgYW4g
SURhdGFDb2RhYmxlW10gdG8gYW4gSURhdGFbXSBhbmQgbm9ybWFsaXplcywgd2hlcmUgYWxsIElE
YXRhcyBhcmUgaW1wbGVtZW50ZWQgCi8vIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwgZnVs
bHkgcXVhbGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnBy
b3RlY3RlZCBzdGF0aWMgSURhdGFbXSBub3JtYWxpemUoY29tLndtLnV0aWwuY29kZXIuSURhdGFD
b2RhYmxlW10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSBy
ZXR1cm4gbnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsK
ICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0g
PSBub3JtYWxpemUoaW5wdXRbaV0uZ2V0SURhdGEoKSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVy
biBvdXRwdXQ7Cn0KCi8vIGNvbnZlcnRzIGEgVmFsdWVzQ29kYWJsZVtdIHRvIGFuIElEYXRhW10g
YW5kIG5vcm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVkIAovLyB3aXRo
IHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNl
ZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFs
aXplKGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSBpbnB1dCwgYm9vbGVhbiByZWN1
cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YVtdIG91dHB1
dCA9IG5ldyBJRGF0YVtpbnB1dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQu
bGVuZ3RoOyBpKyspIHsKICAgIG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtpXS5nZXRWYWx1
ZXMoKSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJlbW92ZXMgYWxs
IGtleXMgZXhjZXB0IHRob3NlIHNwZWNpZmllZCBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVu
dApwdWJsaWMgc3RhdGljIHZvaWQgY2xlYXIoSURhdGEgZG9jdW1lbnQsIFN0cmluZ1tdIGtleXMp
IHsKICBpZiAoZG9jdW1lbnQgPT0gbnVsbCkgcmV0dXJuOwoKICBJRGF0YSBzYXZlZCA9IG51bGw7
CiAgaWYgKGtleXMgIT0gbnVsbCkgewogICAgc2F2ZWQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7
CiAgICBmb3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0
IHZhbHVlID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsK
ICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LnB1dChzYXZl
ZCwga2V5c1tpXSwgdmFsdWUpOwogICAgfQogIH0KCiAgSURhdGFDdXJzb3IgY3Vyc29yID0gZG9j
dW1lbnQuZ2V0Q3Vyc29yKCk7CiAgY3Vyc29yLmZpcnN0KCk7CiAgd2hpbGUoY3Vyc29yLmRlbGV0
ZSgpKTsKICBjdXJzb3IuZGVzdHJveSgpOwoKICBpZiAoa2V5cyAhPSBudWxsKSBJRGF0YVV0aWwu
bWVyZ2Uoc2F2ZWQsIGRvY3VtZW50KTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUgc3Vic3RpdHV0
aW9uIG9uIGFsbCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9jdW1lbnQKcHVi
bGljIHN0YXRpYyBJRGF0YSBzdWJzdGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBzY29wZSwgYm9v
bGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwogIGlmIChz
Y29wZSA9PSBudWxsKSBzY29wZSA9IGlucHV0OwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3Rv
cnkuY3JlYXRlKCk7CgogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURh
dGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHRyeSB7CiAgICB3aGlsZShpYy5u
ZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgICBPYmplY3QgdmFs
dWUgPSBpYy5nZXRWYWx1ZSgpOwogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgIGlm
IChyZWN1cnNlICYmIHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAgIHZhbHVlID0g
c3Vic3RpdHV0ZSgoSURhdGEpdmFsdWUsIHNjb3BlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2Ug
aWYgKHJlY3Vyc2UgJiYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5j
ZW9mIGNvbS53bS51dGlsLlRhYmxlKSkgewogICAgICAgICAgSURhdGFbXSBpYXJ5ID0gdmFsdWUg
aW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxl
KXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0YVtp
YXJ5Lmxlbmd0aF07CiAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3RoOyBp
KyspIG9hcnlbaV0gPSBzdWJzdGl0dXRlKGlhcnlbaV0sIHNjb3BlLCByZWN1cnNlKTsKICAgICAg
ICAgIHZhbHVlID0gb2FyeTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3Ry
aW5nKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSgoU3RyaW5n
KXZhbHVlLCBzY29wZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmlu
Z1tdKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChT
dHJpbmdbXSl2YWx1ZSwgc2NvcGUpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2Vv
ZiBTdHJpbmdbXVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJz
dGl0dXRlKChTdHJpbmdbXVtdKXZhbHVlLCBzY29wZSk7CiAgICAgICAgfQogICAgICB9CiAgICAg
IElEYXRhVXRpbC5wdXQob2MsIGtleSwgdmFsdWUpOwogICAgfQogIH0gZmluYWxseSB7CiAgICBp
Yy5kZXN0cm95KCk7CiAgICBvYy5kZXN0cm95KCk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9Cgov
LyBwYXJzZXMgYW4gSURhdGEgWE1MIGlucHV0IHN0cmVhbSB0byBhbiBJRGF0YSBvYmplY3QKcHVi
bGljIHN0YXRpYyBJRGF0YSBwYXJzZShqYXZhLmlvLklucHV0U3RyZWFtIGluKSB0aHJvd3MgamF2
YS5pby5JT0V4Y2VwdGlvbiB7CiAgY29tLndtLnV0aWwuY29kZXIuWE1MQ29kZXJXcmFwcGVyIGNv
ZGVjID0gbmV3IGNvbS53bS51dGlsLmNvZGVyLlhNTENvZGVyV3JhcHBlcigpOwogIHJldHVybiBj
b2RlYy5kZWNvZGUoaW4pOwp9CgovLyBwYXJzZXMgYW4gSURhdGEgWE1MIHN0cmluZywgYnl0ZSBh
cnJheSBvciBpbnB1dCBzdHJlYW0gdG8gYW4gSURhdGEgb2JqZWN0CnB1YmxpYyBzdGF0aWMgSURh
dGEgcGFyc2UoT2JqZWN0IGNvbnRlbnQsIFN0cmluZyBlbmNvZGluZykgdGhyb3dzIGphdmEuaW8u
SU9FeGNlcHRpb24gewogIHJldHVybiBwYXJzZSgoamF2YS5pby5JbnB1dFN0cmVhbSl0dW5kcmEu
b2JqZWN0LmNvbnZlcnQoY29udGVudCwgZW5jb2RpbmcsICJzdHJlYW0iKSk7Cn0KCi8vIGVtaXRz
IGFuIElEYXRhIG9iamVjdCBhcyBhIGFuIElEYXRhIFhNTCBzdHJpbmcsIGJ5dGUgYXJyYXkgb3Ig
c3RyZWFtCnB1YmxpYyBzdGF0aWMgT2JqZWN0IGVtaXQoSURhdGEgZG9jdW1lbnQsIFN0cmluZyBl
bmNvZGluZywgU3RyaW5nIG1vZGUpIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICBjb20u
d20udXRpbC5jb2Rlci5JRGF0YVhNTENvZGVyIGNvZGVjID0gbnVsbDsKICBpZiAoZW5jb2Rpbmcg
PT0gbnVsbCkgewogICAgY29kZWMgPSBuZXcgY29tLndtLnV0aWwuY29kZXIuSURhdGFYTUxDb2Rl
cigpOwogIH0gZWxzZSB7CiAgICBjb2RlYyA9IG5ldyBjb20ud20udXRpbC5jb2Rlci5JRGF0YVhN
TENvZGVyKGVuY29kaW5nKTsKICB9CgogIGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtIG91
dCA9IG5ldyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogIGNvZGVjLmVuY29kZShv
dXQsIGRvY3VtZW50KTsKCiAgcmV0dXJuIHR1bmRyYS5vYmplY3QuY29udmVydChvdXQudG9CeXRl
QXJyYXkoKSwgZW5jb2RpbmcsIG1vZGUpOwp9</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
