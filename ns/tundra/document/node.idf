<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJl
dHVybiBkb2N1bWVudDsKCiAgZm9yIChpbnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsg
aSsrKSB7CiAgICBpZiAoYW1lbmRtZW50c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhQ3Vyc29y
IGN1cnNvciA9IGFtZW5kbWVudHNbaV0uZ2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImtleSIpOwogICAgICBTdHJpbmcgdmFsdWUgPSBJ
RGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgInZhbHVlIik7CiAgICAgIFN0cmluZyBjb25kaXRp
b24gPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwgImNvbmRpdGlvbiIpOwogICAgICBjdXJz
b3IuZGVzdHJveSgpOwoKICAgICAga2V5ID0gdHVuZHJhLnN0cmluZy5zdWJzdGl0dXRlKGtleSwg
c2NvcGUpOwogICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSh2YWx1ZSwgc2Nv
cGUpOwoKICAgICAgaWYgKChjb25kaXRpb24gPT0gbnVsbCkgfHwgdHVuZHJhLmNvbmRpdGlvbi5l
dmFsdWF0ZShjb25kaXRpb24sIHNjb3BlKSkgewogICAgICAgIGRvY3VtZW50ID0gdHVuZHJhLnN1
cHBvcnQuZG9jdW1lbnQucHV0KGRvY3VtZW50LCBrZXksIHZhbHVlKTsKICAgICAgfQogICAgfQog
IH0KCiAgcmV0dXJuIGRvY3VtZW50Owp9CgovLyByZXR1cm5zIHdoZXRoZXIgdHdvIGRvY3VtZW50
cyBhcmUgZXF1YWwKcHVibGljIHN0YXRpYyBib29sZWFuIGVxdWFsKElEYXRhIHgsIElEYXRhIHkp
IHsKICByZXR1cm4gdHVuZHJhLm9iamVjdC5lcXVhbCh4LCB5KTsKfQoKLy8gcmV0dXJucyBhbGwg
dGhlIGtleXMgaW4gdGhlIGdpdmVuIGRvY3VtZW50IGFzIGEgc3RyaW5nIGxpc3QKcHVibGljIHN0
YXRpYyBTdHJpbmdbXSBrZXlzZXQoSURhdGEgaW5wdXQpIHsKICByZXR1cm4ga2V5c2V0KGlucHV0
LCBudWxsKTsKfQoKLy8gcmV0dXJucyB0aGUga2V5cyB0aGF0IG1hdGNoIHRoZSBnaXZlbiByZWd1
bGFyIGV4cHJlc3Npb24gcGF0dGVybgovLyBpbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgYXMgYSBzdHJp
bmcgbGlzdApwdWJsaWMgc3RhdGljIFN0cmluZ1tdIGtleXNldChJRGF0YSBpbnB1dCwgU3RyaW5n
IHBhdHRlcm4pIHsKICBqYXZhLnV0aWwucmVnZXguUGF0dGVybiBwID0gbnVsbDsKICBpZiAocGF0
dGVybiAhPSBudWxsKSBwID0gamF2YS51dGlsLnJlZ2V4LlBhdHRlcm4uY29tcGlsZShwYXR0ZXJu
KTsKCiAgamF2YS51dGlsLkxpc3Q8U3RyaW5nPiBrZXlzID0gbmV3IGphdmEudXRpbC5BcnJheUxp
c3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJz
b3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAg
U3RyaW5nIGtleSA9IGN1cnNvci5nZXRLZXkoKTsKCiAgICAgIGlmIChwID09IG51bGwpIHsKICAg
ICAgICBrZXlzLmFkZChjdXJzb3IuZ2V0S2V5KCkpOwogICAgICB9IGVsc2UgewogICAgICAgIGph
dmEudXRpbC5yZWdleC5NYXRjaGVyIG0gPSBwLm1hdGNoZXIoa2V5KTsKICAgICAgICBpZiAobS5t
YXRjaGVzKCkpIGtleXMuYWRkKGN1cnNvci5nZXRLZXkoKSk7CiAgICAgIH0gCiAgICB9CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogIH0KICByZXR1cm4gKFN0cmluZ1tdKWtleXMudG9BcnJheShuZXcg
U3RyaW5nWzBdKTsKfQoKLy8gcmV0dXJucyBhbGwgdGhlIHZhbHVlcyBpbiB0aGUgZ2l2ZW4gZG9j
dW1lbnQgYXMgYSBzdHJpbmcgbGlzdApwdWJsaWMgc3RhdGljIE9iamVjdFtdIHZhbHVlc2V0KElE
YXRhIGlucHV0KSB7CiAgamF2YS51dGlsLkxpc3Q8T2JqZWN0PiB2YWx1ZXMgPSBuZXcgamF2YS51
dGlsLkFycmF5TGlzdDxPYmplY3Q+KCk7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIElEYXRh
Q3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgd2hpbGUoY3Vyc29yLm5leHQo
KSkgewogICAgICB2YWx1ZXMuYWRkKGN1cnNvci5nZXRWYWx1ZSgpKTsKICAgIH0KICAgIGN1cnNv
ci5kZXN0cm95KCk7CiAgfQogIHJldHVybiAoT2JqZWN0W10pdmFsdWVzLnRvQXJyYXkobmV3IE9i
amVjdFswXSk7Cn0KCi8vIG1lcmdlcyBtdWx0aXBsZSBJRGF0YSBkb2N1bWVudHMgaW50byBhIHNp
bmdsZSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIG1lcmdlKElEYXRhW10gaW5wdXQpIHsK
ICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgaWYgKGlucHV0ICE9IG51
bGwpIHsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHsKICAgICAg
SURhdGFVdGlsLm1lcmdlKGlucHV0W2ldLCBvdXRwdXQpOwogICAgfQogIH0KICByZXR1cm4gb3V0
cHV0Owp9CgovLyBzb3J0cyB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQgYnkgaXRzIGtleXMgaW4g
bmF0dXJhbCBhc2NlbmRpbmcgb3JkZXIKcHVibGljIHN0YXRpYyBJRGF0YSBzb3J0KElEYXRhIGlu
cHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7
CgogIFN0cmluZ1tdIGtleXMgPSBrZXlzZXQoaW5wdXQpOwogIGphdmEudXRpbC5BcnJheXMuc29y
dChrZXlzKTsKCiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRh
Q3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQu
Z2V0Q3Vyc29yKCk7CgogIGZvciAoaW50IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewog
ICAgYm9vbGVhbiByZXN1bHQ7CgogICAgaWYgKGkgPiAwICYmIGtleXNbaV0uZXF1YWxzKGtleXNb
aS0xXSkpIHsKICAgICAgcmVzdWx0ID0gaWMubmV4dChrZXlzW2ldKTsKICAgIH0gZWxzZSB7CiAg
ICAgIHJlc3VsdCA9IGljLmZpcnN0KGtleXNbaV0pOwogICAgfQoKICAgIGlmIChyZXN1bHQpIHsK
ICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBu
dWxsICYmIHJlY3Vyc2UpIHsKICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewog
ICAgICAgICAgdmFsdWUgPSBzb3J0KChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBl
bHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gfHwgdmFsdWUgaW5zdGFuY2VvZiBjb20u
d20udXRpbC5UYWJsZSkgewogICAgICAgICAgSURhdGFbXSBhcnJheSA9IHZhbHVlIGluc3RhbmNl
b2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSku
Z2V0VmFsdWVzKCk7CiAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsg
aisrKSB7CiAgICAgICAgICAgIGFycmF5W2pdID0gc29ydChhcnJheVtqXSwgcmVjdXJzZSk7CiAg
ICAgICAgICB9CiAgICAgICAgICB2YWx1ZSA9IGFycmF5OwogICAgICAgIH0KICAgICAgfQogICAg
ICBvYy5pbnNlcnRBZnRlcihrZXlzW2ldLCB2YWx1ZSk7CiAgICB9CiAgfQoKICBpYy5kZXN0cm95
KCk7CiAgb2MuZGVzdHJveSgpOwoKICByZXR1cm4gb3V0cHV0Owp9CgovLyB0cmltcyBhbGwgc3Ry
aW5nIHZhbHVlcywgdGhlbiBjb252ZXJ0cyBlbXB0eSBzdHJpbmdzIHRvIG51bGxzLCB0aGVuIGNv
bXBhY3RzIGJ5IHJlbW92aW5nIGFsbCBudWxsIHZhbHVlcwpwdWJsaWMgc3RhdGljIElEYXRhIHNx
dWVlemUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxs
KSByZXR1cm4gbnVsbDsKCiAgSURhdGEgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwog
IElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURhdGFDdXJzb3Igb2MgPSBv
dXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHdoaWxlKGljLm5leHQoKSkgewogICAgU3RyaW5nIGtleSA9
IGljLmdldEtleSgpOwogICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICBpZiAo
dmFsdWUgIT0gbnVsbCkgewogICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAg
ICAgICBTdHJpbmcgc3RyaW5nID0gKFN0cmluZyl2YWx1ZTsKICAgICAgICBzdHJpbmcgPSBzdHJp
bmcudHJpbSgpOwogICAgICAgIGlmIChzdHJpbmcuZXF1YWxzKCIiKSkgc3RyaW5nID0gbnVsbDsK
CiAgICAgICAgdmFsdWUgPSBzdHJpbmc7CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2Vv
ZiBTdHJpbmdbXSkgewogICAgICAgIFN0cmluZ1tdIGFycmF5ID0gKFN0cmluZ1tdKXZhbHVlOwog
ICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICAg
IGlmIChhcnJheVtpXSAhPSBudWxsKSB7CiAgICAgICAgICAgIGFycmF5W2ldID0gYXJyYXlbaV0u
dHJpbSgpOwogICAgICAgICAgICBpZiAoYXJyYXlbaV0uZXF1YWxzKCIiKSkgYXJyYXlbaV0gPSBu
dWxsOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAg
fSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdW10pIHsKICAgICAgICBTdHJpbmdb
XVtdIGFycmF5ID0gKFN0cmluZ1tdW10pdmFsdWU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg
PCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBhcnJh
eVtpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICBpZiAoYXJyYXlbaV1bal0gIT0gbnVsbCkg
ewogICAgICAgICAgICAgIGFycmF5W2ldW2pdID0gYXJyYXlbaV1bal0udHJpbSgpOwogICAgICAg
ICAgICAgIGlmIChhcnJheVtpXVtqXS5lcXVhbHMoIiIpKSBhcnJheVtpXVtqXSA9IG51bGw7CiAg
ICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZhbHVlID0gYXJyYXk7
CiAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAg
ICAgICAgdmFsdWUgPSBzcXVlZXplKChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgIH0gZWxz
ZSBpZiAocmVjdXJzZSAmJiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3Rh
bmNlb2YgY29tLndtLnV0aWwuVGFibGUpKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IHZhbHVl
IGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJs
ZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5s
ZW5ndGg7IGkrKykgewogICAgICAgICAgYXJyYXlbaV0gPSBzcXVlZXplKGFycmF5W2ldLCByZWN1
cnNlKTsKICAgICAgICB9CgogICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgIH0KCiAgICAgIG9j
Lmluc2VydEFmdGVyKGtleSwgdmFsdWUpOwogICAgfQogIH0KCiAgaWMuZGVzdHJveSgpOwogIG9j
LmRlc3Ryb3koKTsKCiAgcmV0dXJuIGNvbXBhY3Qob3V0cHV0LCByZWN1cnNlKTsKfQoKLy8gcmV0
dXJucyB0aGUgbnVtYmVyIG9mIHRvcC1sZXZlbCB7a2V5LCB2YWx1ZX0gcGFpcnMgaW4gdGhlIGdp
dmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgaW50IHNpemUoSURhdGEgaW5wdXQpIHsK
ICBpbnQgc2l6ZSA9IDA7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1
cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgc2l6ZSA9IElEYXRhVXRpbC5zaXplKGN1cnNv
cik7CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KICByZXR1cm4gc2l6ZTsKfQoKLy8gcmV0dXJu
cyBhIGNsb25lIG9mIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRh
IGR1cGxpY2F0ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2VydmljZUV4
Y2VwdGlvbiB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewog
ICAgSURhdGFDdXJzb3IgY3Vyc29yID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB0cnkgewogICAg
ICBpZiAocmVjdXJzZSkgewogICAgICAgIG91dHB1dCA9IElEYXRhVXRpbC5kZWVwQ2xvbmUoaW5w
dXQpOwogICAgICB9IGVsc2UgewogICAgICAgIG91dHB1dCA9IElEYXRhVXRpbC5jbG9uZShpbnB1
dCk7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGphdmEuaW8uSU9FeGNlcHRpb24gZXgpIHsKICAgICAg
dHVuZHJhLmV4Y2VwdGlvbi5yYWlzZShleCk7CiAgICB9IGZpbmFsbHkgewogICAgICBjdXJzb3Iu
ZGVzdHJveSgpOwogICAgfQogIH0KICByZXR1cm4gb3V0cHV0Owp9CgovLyByZW1vdmVzIHRoZSB2
YWx1ZSB3aXRoIHRoZSBnaXZlbiBrZXkgZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVi
bGljIHN0YXRpYyBJRGF0YSBkcm9wKElEYXRhIGlucHV0LCBTdHJpbmcga2V5KSB7CiAgaWYgKGlu
cHV0ICE9IG51bGwgJiYga2V5ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlu
cHV0LmdldEN1cnNvcigpOwogICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleSk7CiAgICBj
dXJzb3IuZGVzdHJveSgpOwoKICAgIGlmICh0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkuaXNG
dWxseVF1YWxpZmllZChrZXkpKSBkcm9wKGlucHV0LCB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5L
ZXkucGFyc2Uoa2V5KSk7CiAgfQogIHJldHVybiBpbnB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUgdmFs
dWUgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnByb3Rl
Y3RlZCBzdGF0aWMgSURhdGEgZHJvcChJRGF0YSBpbnB1dCwgamF2YS51dGlsLlF1ZXVlPHR1bmRy
YS5zdXBwb3J0LmRvY3VtZW50LktleT4ga2V5cykgewogIGlmIChpbnB1dCAhPSBudWxsICYmIGtl
eXMgIT0gbnVsbCAmJiBrZXlzLnNpemUoKSA+IDApIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9
IGlucHV0LmdldEN1cnNvcigpOwogICAgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5IGtleSA9
IGtleXMucmVtb3ZlKCk7CgogICAgaWYgKGtleXMuc2l6ZSgpID4gMCkgewogICAgICBpZiAoa2V5
Lmhhc0luZGV4KCkpIHsKICAgICAgICBJRGF0YVtdIGFycmF5ID0gSURhdGFVdGlsLmdldElEYXRh
QXJyYXkoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSk7CiAgICAgICAgZHJvcCh0dW5kcmEubGlzdC5v
YmplY3QuZ2V0KGFycmF5LCBrZXkuZ2V0SW5kZXgoKSksIGtleXMpOwogICAgICB9IGVsc2Ugewog
ICAgICAgIGRyb3AoSURhdGFVdGlsLmdldElEYXRhKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpLCBr
ZXlzKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAg
ICAgICAgT2JqZWN0W10gYXJyYXkgPSBJRGF0YVV0aWwuZ2V0T2JqZWN0QXJyYXkoY3Vyc29yLCBr
ZXkudG9TdHJpbmcoKSk7CiAgICAgICAgSURhdGFVdGlsLnB1dChjdXJzb3IsIGtleS50b1N0cmlu
ZygpLCB0dW5kcmEubGlzdC5vYmplY3QuZHJvcChhcnJheSwga2V5LmdldEluZGV4KCkpKTsKICAg
ICAgfSBlbHNlIHsKICAgICAgICBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5LnRvU3RyaW5n
KCkpOwogICAgICB9CiAgICB9CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KICByZXR1cm4gaW5w
dXQ7Cn0KCi8vIHZpc2l0cyBlYWNoIGVsZW1lbnQgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50
LCBjYWxscyB0aGUgZ2l2ZW4gc2VydmljZSB0byBjb252ZXJ0IHRoZSBlbGVtZW50LCBhbmQgY3Jl
YXRlcyBhIG5ldyBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSByZXN1bHRpbmcgZWxlbWVudHMKcHVi
bGljIHN0YXRpYyBJRGF0YSBtYXAoSURhdGEgaW5wdXQsIFN0cmluZyBzZXJ2aWNlLCBJRGF0YSBw
aXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBTdHJpbmcga2V5T3V0cHV0LCBTdHJpbmcgdmFsdWVJ
bnB1dCwgU3RyaW5nIHZhbHVlT3V0cHV0LCBDbGFzcyB2YWx1ZUNsYXNzLCBib29sZWFuIHJlY3Vy
c2UpIHRocm93cyBTZXJ2aWNlRXhjZXB0aW9uIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwoKICBp
ZiAoaW5wdXQgIT0gbnVsbCAmJiBzZXJ2aWNlICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGlj
ID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7
CiAgICBJRGF0YUN1cnNvciBvYyA9IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgICBpZiAoa2V5SW5w
dXQgPT0gbnVsbCkga2V5SW5wdXQgPSAiJGtleSI7CiAgICBpZiAoa2V5T3V0cHV0ID09IG51bGwp
IGtleU91dHB1dCA9IGtleUlucHV0OwogICAgaWYgKHZhbHVlSW5wdXQgPT0gbnVsbCkgdmFsdWVJ
bnB1dCA9ICIkdmFsdWUiOwogICAgaWYgKHZhbHVlT3V0cHV0ID09IG51bGwpIHZhbHVlT3V0cHV0
ID0gdmFsdWVJbnB1dDsKICAgIGlmIChwaXBlbGluZSA9PSBudWxsKSBwaXBlbGluZSA9IElEYXRh
RmFjdG9yeS5jcmVhdGUoKTsKCiAgICB0cnkgewogICAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAg
ICAgICBUdXBsZTxPYmplY3Q+IHR1cGxlID0gbmV3IFR1cGxlPE9iamVjdD4oaWMuZ2V0S2V5KCks
IGljLmdldFZhbHVlKCkpOwoKICAgICAgICBpZiAocmVjdXJzZSAmJiB0dXBsZS52YWx1ZSAhPSBu
dWxsKSB7CiAgICAgICAgICBpZiAodHVwbGUudmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAg
ICAgICAgICB0dXBsZS52YWx1ZSA9IG1hcCgoSURhdGEpdHVwbGUudmFsdWUsIHNlcnZpY2UsIHBp
cGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFs
dWVDbGFzcywgcmVjdXJzZSk7CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3Rh
bmNlb2YgSURhdGFbXSB8fCB0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLlRhYmxl
KSB7CiAgICAgICAgICAgIElEYXRhW10gaWFyeSA9IHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURh
dGFbXSA/IChJRGF0YVtdKXR1cGxlLnZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl0dXBsZS52
YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0YVtp
YXJ5Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7
IGkrKykgewogICAgICAgICAgICAgIG9hcnlbaV0gPSBtYXAoaWFyeVtpXSwgc2VydmljZSwgcGlw
ZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1
ZUNsYXNzLCByZWN1cnNlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0dXBsZS52YWx1ZSA9
IG9hcnk7CiAgICAgICAgICB9IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgU3RyaW5n
W11bXSkgewogICAgICAgICAgICBTdHJpbmdbXVtdIGlhcnkgPSAoU3RyaW5nW11bXSl0dXBsZS52
YWx1ZTsKICAgICAgICAgICAgU3RyaW5nW11bXSBvYXJ5ID0gbmV3IFN0cmluZ1tpYXJ5Lmxlbmd0
aF1bXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7
CiAgICAgICAgICAgICAgaWYgKGlhcnlbaV0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgb2Fy
eVtpXSA9IG5ldyBTdHJpbmdbaWFyeVtpXS5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChp
bnQgaiA9IDA7IGogPCBpYXJ5W2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIFR1
cGxlPFN0cmluZz4gdCA9IG1hcChuZXcgVHVwbGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV1b
al0pLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwg
dmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwogICAgICAgICAgICAgICAgICBvYXJ5W2ldW2pdID0g
dC52YWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K
ICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBs
ZS52YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGlhcnkg
PSAoU3RyaW5nW10pdHVwbGUudmFsdWU7CiAgICAgICAgICAgIFN0cmluZ1tdIG9hcnkgPSBuZXcg
U3RyaW5nW2lhcnkubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5
Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgVHVwbGU8U3RyaW5nPiB0ID0gbWFwKG5ldyBU
dXBsZTxTdHJpbmc+KHR1cGxlLmtleSwgaWFyeVtpXSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJ
bnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAg
ICAgICAgICAgICAgb2FyeVtpXSA9IHQudmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg
dHVwbGUudmFsdWUgPSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0
YW5jZW9mIE9iamVjdFtdKSB7CiAgICAgICAgICAgIE9iamVjdFtdIGlhcnkgPSAoT2JqZWN0W10p
dHVwbGUudmFsdWU7CiAgICAgICAgICAgIE9iamVjdFtdIG9hcnkgPSBuZXcgT2JqZWN0W2lhcnku
bGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsr
KSB7CiAgICAgICAgICAgICAgVHVwbGU8T2JqZWN0PiB0ID0gbWFwKG5ldyBUdXBsZTxPYmplY3Q+
KHR1cGxlLmtleSwgaWFyeVtpXSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0
cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAg
b2FyeVtpXSA9IHQudmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUg
PSBvYXJ5OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0dXBsZSA9IG1hcCh0dXBsZSwg
c2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVl
T3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAgICBJRGF0YVV0aWwucHV0KG9jLCB0dXBsZS5rZXks
IHR1cGxlLnZhbHVlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgp
OwogICAgICBvYy5kZXN0cm95KCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIG91dHB1dCA9IGR1cGxp
Y2F0ZShpbnB1dCwgcmVjdXJzZSk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyB3cmFwcGVy
IGNsYXNzIGZvciB7a2V5LCB2YWx1ZX0gdHVwbGVzCnByb3RlY3RlZCBzdGF0aWMgY2xhc3MgVHVw
bGU8VD4geyAKICBwdWJsaWMgU3RyaW5nIGtleTsKICBwdWJsaWMgVCB2YWx1ZTsKICBwdWJsaWMg
VHVwbGUoU3RyaW5nIGtleSwgVCB2YWx1ZSkgeyAKICAgIHRoaXMua2V5ID0ga2V5OyAKICAgIHRo
aXMudmFsdWUgPSB2YWx1ZTsgCiAgfQp9CgovLyBjb252ZXJ0cyB0aGUgZ2l2ZW4gZWxlbWVudCBi
eSBjYWxsaW5nIHRoZSBnaXZlbiBzZXJ2aWNlLCBhbmQgcmV0dXJucyB0aGUgcmVzdWx0CnByb3Rl
Y3RlZCBzdGF0aWMgPFQ+IFR1cGxlPFQ+IG1hcChUdXBsZTxUPiB0dXBsZSwgU3RyaW5nIHNlcnZp
Y2UsIElEYXRhIHBpcGVsaW5lLCBTdHJpbmcga2V5SW5wdXQsIFN0cmluZyBrZXlPdXRwdXQsIFN0
cmluZyB2YWx1ZUlucHV0LCBTdHJpbmcgdmFsdWVPdXRwdXQsIENsYXNzIHZhbHVlQ2xhc3MpIHRo
cm93cyBTZXJ2aWNlRXhjZXB0aW9uIHsKICBpZiAodHVwbGUudmFsdWUgPT0gbnVsbCB8fCB2YWx1
ZUNsYXNzID09IG51bGwgfHwgdmFsdWVDbGFzcy5pc0luc3RhbmNlKHR1cGxlLnZhbHVlKSkgewog
ICAgSURhdGFDdXJzb3IgY3Vyc29yID0gcGlwZWxpbmUuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0
aWwucHV0KGN1cnNvciwga2V5SW5wdXQsIHR1cGxlLmtleSk7CiAgICBJRGF0YVV0aWwucHV0KGN1
cnNvciwgdmFsdWVJbnB1dCwgdHVwbGUudmFsdWUpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKCiAg
ICBwaXBlbGluZSA9IHR1bmRyYS5zZXJ2aWNlLmludm9rZShzZXJ2aWNlLCBwaXBlbGluZSk7Cgog
ICAgLy8gY2xlYW4gdXAgdGhlIGlucHV0IHBpcGVsaW5lCiAgICBjdXJzb3IgPSBwaXBlbGluZS5n
ZXRDdXJzb3IoKTsKICAgIHR1cGxlLmtleSA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCBr
ZXlPdXRwdXQpOwogICAgdHVwbGUudmFsdWUgPSAoVClJRGF0YVV0aWwuZ2V0KGN1cnNvciwgdmFs
dWVPdXRwdXQpOwogICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleUlucHV0KTsKICAgIGlm
ICgha2V5SW5wdXQuZXF1YWxzKGtleU91dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBr
ZXlPdXRwdXQpOwogICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIHZhbHVlSW5wdXQpOwogICAg
aWYgKCF2YWx1ZUlucHV0LmVxdWFscyh2YWx1ZU91dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vy
c29yLCB2YWx1ZU91dHB1dCk7CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0gIAogIHJldHVybiB0
dXBsZTsKfQoKLy8gaW52b2tlcyB0aGUgZ2l2ZW4gc2VydmljZSBmb3IgZWFjaCB7a2V5LCB2YWx1
ZX0gcGFpciBpbiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyB2b2lkIGVh
Y2goSURhdGEgaW5wdXQsIFN0cmluZyBzZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtl
eUlucHV0LCBTdHJpbmcgdmFsdWVJbnB1dCwgQ2xhc3MgdmFsdWVDbGFzcywgYm9vbGVhbiByZWN1
cnNlKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgbWFwKGlucHV0LCBzZXJ2aWNlLCBwaXBl
bGluZSwga2V5SW5wdXQsIG51bGwsIHZhbHVlSW5wdXQsIG51bGwsIHZhbHVlQ2xhc3MsIHJlY3Vy
c2UpOwp9CgovLyByZW5hbWVzIGEga2V5IGZyb20gc291cmNlIHRvIHRhcmdldCB3aXRoaW4gdGhl
IGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgcmVuYW1lKElEYXRhIGlu
cHV0LCBTdHJpbmcgc291cmNlLCBTdHJpbmcgdGFyZ2V0KSB7CiAgaWYgKCFzb3VyY2UuZXF1YWxz
KHRhcmdldCkpIGlucHV0ID0gZHJvcChjb3B5KGlucHV0LCBzb3VyY2UsIHRhcmdldCksIHNvdXJj
ZSk7CiAgcmV0dXJuIGlucHV0Owp9CgovLyBjb3BpZXMgYSB2YWx1ZSBmcm9tIHNvdXJjZSBrZXkg
dG8gdGFyZ2V0IGtleSB3aXRoaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0
aWMgSURhdGEgY29weShJRGF0YSBpbnB1dCwgU3RyaW5nIHNvdXJjZSwgU3RyaW5nIHRhcmdldCkg
ewogIGlmIChzb3VyY2UuZXF1YWxzKHRhcmdldCkpIHJldHVybiBpbnB1dDsKICByZXR1cm4gdHVu
ZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KGlucHV0LCB0YXJnZXQsIHR1bmRyYS5zdXBwb3J0LmRv
Y3VtZW50LmdldChpbnB1dCwgc291cmNlKSk7Cn0KCi8vIHJlbW92ZXMgYWxsIG51bGwgdmFsdWVz
IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgY29tcGFj
dChJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsK
CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUo
KTsKICAgIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YUN1cnNv
ciBvYyA9IG91dHB1dC5nZXRDdXJzb3IoKTsKCiAgICB0cnkgewogICAgICB3aGlsZShpYy5uZXh0
KCkpIHsKICAgICAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgICAgT2JqZWN0IHZh
bHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAg
ICAgIGlmIChyZWN1cnNlKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRh
KSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBjb21wYWN0KChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7
CiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVl
IGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpIHsKICAgICAgICAgICAgICBJRGF0YVtdIGFy
cmF5ID0gdmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53
bS51dGlsLlRhYmxlKXZhbHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1
bmRyYS5saXN0LmRvY3VtZW50LmNvbXBhY3QoYXJyYXksIHJlY3Vyc2UpOwogICAgICAgICAgICB9
IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAgICAgICAgIFN0
cmluZ1tdW10gYXJyYXkgPSAoU3RyaW5nW11bXSl2YWx1ZTsKICAgICAgICAgICAgICBmb3IgKGlu
dCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBhcnJheVtp
XSA9IHR1bmRyYS5saXN0Lm9iamVjdC5jb21wYWN0KGFycmF5W2ldKTsKICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1
ZSBpbnN0YW5jZW9mIFN0cmluZ1tdKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlz
dC5vYmplY3QuY29tcGFjdCgoU3RyaW5nW10pdmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgaWYg
KHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRy
YS5saXN0Lm9iamVjdC5jb21wYWN0KChPYmplY3RbXSl2YWx1ZSk7CiAgICAgICAgICAgIH0KICAg
ICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSBJRGF0YVV0aWwu
cHV0KG9jLCBrZXksIHZhbHVlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVz
dHJveSgpOwogICAgICBvYy5kZXN0cm95KCk7CiAgICB9CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9
CgovLyByZXR1cm5zIGEgbmV3IElEYXRhIGRvY3VtZW50LCB3aGVyZSBhbGwgSURhdGFzIGFyZSBp
bXBsZW1lbnRlZCB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsCi8vIGZ1bGx5IHF1YWxpZmll
ZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwdWJsaWMgc3RhdGlj
IElEYXRhIG5vcm1hbGl6ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlu
cHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3Rvcnku
Y3JlYXRlKCk7CiAgSURhdGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKCiAgdHJ5IHsK
ICAgIHdoaWxlKGljLm5leHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAg
ICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVs
bCkgewogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLklEYXRh
Q29kYWJsZSkgewogICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29k
YWJsZSl2YWx1ZSkuZ2V0SURhdGEoKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNl
b2YgY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZSkgewogICAgICAgICAgdmFsdWUgPSAo
KGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAg
ICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5JRGF0YUNv
ZGFibGVbXSkgewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKGNvbS53bS51dGlsLmNvZGVy
LklEYXRhQ29kYWJsZVtdKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVl
IGluc3RhbmNlb2YgY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKSB7CiAgICAgICAg
ICB2YWx1ZSA9IG5vcm1hbGl6ZSgoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKXZh
bHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFb
XSkgewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKElEYXRhW10pdmFsdWUsIHJlY3Vyc2Up
OwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkg
ewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSku
Z2V0VmFsdWVzKCksIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiB2YWx1
ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoSURhdGEp
dmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0KICAgICAgfQogICAgICB0dW5kcmEuc3VwcG9ydC5k
b2N1bWVudC5wdXQob3V0cHV0LCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGZpbmFsbHkgewogICAg
aWMuZGVzdHJveSgpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gbm9ybWFsaXplcyBhbiBJ
RGF0YVtdLCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3aXRoIHRoZSBzYW1lIGNs
YXNzLCBhbmQgYWxsCi8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEg
bmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKElEYXRh
W10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4g
bnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3Ig
KGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3Jt
YWxpemUoaW5wdXRbaV0sIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29u
dmVydHMgYW4gSURhdGFDb2RhYmxlW10gdG8gYW4gSURhdGFbXSBhbmQgbm9ybWFsaXplcywgd2hl
cmUgYWxsIElEYXRhcyBhcmUgaW1wbGVtZW50ZWQgCi8vIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFu
ZCBhbGwgZnVsbHkgcXVhbGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3Ry
dWN0dXJlCnByb3RlY3RlZCBzdGF0aWMgSURhdGFbXSBub3JtYWxpemUoY29tLndtLnV0aWwuY29k
ZXIuSURhdGFDb2RhYmxlW10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9
PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQu
bGVuZ3RoXTsKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBv
dXRwdXRbaV0gPSBub3JtYWxpemUoaW5wdXRbaV0uZ2V0SURhdGEoKSwgcmVjdXJzZSk7CiAgfQog
IAogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIGNvbnZlcnRzIGEgVmFsdWVzQ29kYWJsZVtdIHRvIGFu
IElEYXRhW10gYW5kIG5vcm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVk
IAovLyB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFy
ZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRh
W10gbm9ybWFsaXplKGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSBpbnB1dCwgYm9v
bGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0
YVtdIG91dHB1dCA9IG5ldyBJRGF0YVtpbnB1dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBp
IDwgaW5wdXQubGVuZ3RoOyBpKyspIHsKICAgIG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtp
XS5nZXRWYWx1ZXMoKSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJl
bW92ZXMgYWxsIGtleXMgZXhjZXB0IHRob3NlIHNwZWNpZmllZCBmcm9tIHRoZSBnaXZlbiBJRGF0
YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIHZvaWQgY2xlYXIoSURhdGEgZG9jdW1lbnQsIFN0cmlu
Z1tdIGtleXMpIHsKICBpZiAoZG9jdW1lbnQgPT0gbnVsbCkgcmV0dXJuOwoKICBJRGF0YSBzYXZl
ZCA9IG51bGw7CiAgaWYgKGtleXMgIT0gbnVsbCkgewogICAgc2F2ZWQgPSBJRGF0YUZhY3Rvcnku
Y3JlYXRlKCk7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAg
ICAgT2JqZWN0IHZhbHVlID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBr
ZXlzW2ldKTsKICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50
LnB1dChzYXZlZCwga2V5c1tpXSwgdmFsdWUpOwogICAgfQogIH0KCiAgSURhdGFDdXJzb3IgY3Vy
c29yID0gZG9jdW1lbnQuZ2V0Q3Vyc29yKCk7CiAgY3Vyc29yLmZpcnN0KCk7CiAgd2hpbGUoY3Vy
c29yLmRlbGV0ZSgpKTsKICBjdXJzb3IuZGVzdHJveSgpOwoKICBpZiAoa2V5cyAhPSBudWxsKSBJ
RGF0YVV0aWwubWVyZ2Uoc2F2ZWQsIGRvY3VtZW50KTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUg
c3Vic3RpdHV0aW9uIG9uIGFsbCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9j
dW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBzdWJzdGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBz
Y29wZSwgYm9vbGVhbiByZWN1cnNlKSB7CiAgcmV0dXJuIHN1YnN0aXR1dGUoaW5wdXQsIHNjb3Bl
LCBudWxsLCByZWN1cnNlKTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUgc3Vic3RpdHV0aW9uIG9u
IGFsbCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9jdW1lbnQKcHVibGljIHN0
YXRpYyBJRGF0YSBzdWJzdGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBzY29wZSwgU3RyaW5nIGRl
ZmF1bHRWYWx1ZSwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVy
biBudWxsOwogIGlmIChzY29wZSA9PSBudWxsKSBzY29wZSA9IGlucHV0OwoKICBJRGF0YSBvdXRw
dXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CgogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0
Q3Vyc29yKCk7CiAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHRyeSB7
CiAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwog
ICAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwogICAgICBpZiAodmFsdWUgIT0gbnVs
bCkgewogICAgICAgIGlmIChyZWN1cnNlICYmIHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAg
ICAgICAgIHZhbHVlID0gc3Vic3RpdHV0ZSgoSURhdGEpdmFsdWUsIHNjb3BlLCBkZWZhdWx0VmFs
dWUsIHJlY3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiAodmFsdWUgaW5zdGFu
Y2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpKSB7CiAg
ICAgICAgICBJRGF0YVtdIGlhcnkgPSB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFb
XSl2YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAg
ICAgSURhdGFbXSBvYXJ5ID0gbmV3IElEYXRhW2lhcnkubGVuZ3RoXTsKICAgICAgICAgIGZvciAo
aW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgb2FyeVtpXSA9IHN1YnN0aXR1dGUoaWFy
eVtpXSwgc2NvcGUsIGRlZmF1bHRWYWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgICB2YWx1ZSA9IG9h
cnk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAg
ICAgdmFsdWUgPSB0dW5kcmEuc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZyl2YWx1ZSwgc2NvcGUs
IGRlZmF1bHRWYWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmlu
Z1tdKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChT
dHJpbmdbXSl2YWx1ZSwgc2NvcGUsIGRlZmF1bHRWYWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmICh2
YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdW10pIHsKICAgICAgICAgIHZhbHVlID0gdHVuZHJhLmxp
c3Quc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZ1tdW10pdmFsdWUsIHNjb3BlLCBkZWZhdWx0VmFs
dWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBJRGF0YVV0aWwucHV0KG9jLCBrZXksIHZhbHVl
KTsKICAgIH0KICB9IGZpbmFsbHkgewogICAgaWMuZGVzdHJveSgpOwogICAgb2MuZGVzdHJveSgp
OwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcGFyc2VzIGFuIElEYXRhIFhNTCBpbnB1dCBz
dHJlYW0gdG8gYW4gSURhdGEgb2JqZWN0CnB1YmxpYyBzdGF0aWMgSURhdGEgcGFyc2UoamF2YS5p
by5JbnB1dFN0cmVhbSBpbikgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogIGNvbS53bS51
dGlsLmNvZGVyLlhNTENvZGVyV3JhcHBlciBjb2RlYyA9IG5ldyBjb20ud20udXRpbC5jb2Rlci5Y
TUxDb2RlcldyYXBwZXIoKTsKICByZXR1cm4gY29kZWMuZGVjb2RlKGluKTsKfQoKLy8gcGFyc2Vz
IGFuIElEYXRhIFhNTCBzdHJpbmcsIGJ5dGUgYXJyYXkgb3IgaW5wdXQgc3RyZWFtIHRvIGFuIElE
YXRhIG9iamVjdApwdWJsaWMgc3RhdGljIElEYXRhIHBhcnNlKE9iamVjdCBjb250ZW50LCBTdHJp
bmcgZW5jb2RpbmcpIHRocm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICByZXR1cm4gcGFyc2Uo
KGphdmEuaW8uSW5wdXRTdHJlYW0pdHVuZHJhLm9iamVjdC5jb252ZXJ0KGNvbnRlbnQsIGVuY29k
aW5nLCAic3RyZWFtIikpOwp9CgovLyBlbWl0cyBhbiBJRGF0YSBvYmplY3QgYXMgYSBhbiBJRGF0
YSBYTUwgc3RyaW5nLCBieXRlIGFycmF5IG9yIHN0cmVhbQpwdWJsaWMgc3RhdGljIE9iamVjdCBl
bWl0KElEYXRhIGRvY3VtZW50LCBTdHJpbmcgZW5jb2RpbmcsIFN0cmluZyBtb2RlKSB0aHJvd3Mg
amF2YS5pby5JT0V4Y2VwdGlvbiB7CiAgY29tLndtLnV0aWwuY29kZXIuSURhdGFYTUxDb2RlciBj
b2RlYyA9IG51bGw7CiAgaWYgKGVuY29kaW5nID09IG51bGwpIHsKICAgIGNvZGVjID0gbmV3IGNv
bS53bS51dGlsLmNvZGVyLklEYXRhWE1MQ29kZXIoKTsKICB9IGVsc2UgewogICAgY29kZWMgPSBu
ZXcgY29tLndtLnV0aWwuY29kZXIuSURhdGFYTUxDb2RlcihlbmNvZGluZyk7CiAgfQoKICBqYXZh
LmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBvdXQgPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRw
dXRTdHJlYW0oKTsKICBjb2RlYy5lbmNvZGUob3V0LCBkb2N1bWVudCk7CgogIHJldHVybiB0dW5k
cmEub2JqZWN0LmNvbnZlcnQob3V0LnRvQnl0ZUFycmF5KCksIGVuY29kaW5nLCBtb2RlKTsKfQ==
</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
