<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gYW1lbmRzIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudCB3aXRoIHRoZSB7a2V5LHZhbHVlfSBw
YWlycyBzcGVjaWZpZWQgaW4gdGhlCi8vIGFtZW5kbWVudHMgSURhdGEKcHVibGljIHN0YXRpYyBJ
RGF0YSBhbWVuZChJRGF0YSBkb2N1bWVudCwgSURhdGFbXSBhbWVuZG1lbnRzLCBJRGF0YSBzY29w
ZSkgewogIGlmIChhbWVuZG1lbnRzID09IG51bGwpIHJldHVybiBkb2N1bWVudDsKCiAgZm9yIChp
bnQgaSA9IDA7IGkgPCBhbWVuZG1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoYW1lbmRtZW50
c1tpXSAhPSBudWxsKSB7CiAgICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGFtZW5kbWVudHNbaV0u
Z2V0Q3Vyc29yKCk7CiAgICAgIFN0cmluZyBrZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNv
ciwgImtleSIpOwogICAgICBTdHJpbmcgdmFsdWUgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNv
ciwgInZhbHVlIik7CiAgICAgIFN0cmluZyBjb25kaXRpb24gPSBJRGF0YVV0aWwuZ2V0U3RyaW5n
KGN1cnNvciwgImNvbmRpdGlvbiIpOwogICAgICBjdXJzb3IuZGVzdHJveSgpOwoKICAgICAga2V5
ID0gdHVuZHJhLnN0cmluZy5zdWJzdGl0dXRlKGtleSwgc2NvcGUpOwogICAgICB2YWx1ZSA9IHR1
bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSh2YWx1ZSwgc2NvcGUpOwoKICAgICAgaWYgKChjb25kaXRp
b24gPT0gbnVsbCkgfHwgdHVuZHJhLmNvbmRpdGlvbi5ldmFsdWF0ZShjb25kaXRpb24sIHNjb3Bl
KSkgewogICAgICAgIGRvY3VtZW50ID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KGRvY3Vt
ZW50LCBrZXksIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGRvY3VtZW50Owp9
CgovLyByZXR1cm5zIHdoZXRoZXIgdHdvIGRvY3VtZW50cyBhcmUgZXF1YWwKcHVibGljIHN0YXRp
YyBib29sZWFuIGVxdWFsKElEYXRhIHgsIElEYXRhIHkpIHsKICByZXR1cm4gdHVuZHJhLm9iamVj
dC5lcXVhbCh4LCB5KTsKfQoKLy8gcmV0dXJucyBhbGwgdGhlIGtleXMgaW4gdGhlIGdpdmVuIGRv
Y3VtZW50IGFzIGEgc3RyaW5nIGxpc3QKcHVibGljIHN0YXRpYyBTdHJpbmdbXSBrZXlzZXQoSURh
dGEgaW5wdXQpIHsKICByZXR1cm4ga2V5c2V0KGlucHV0LCBudWxsKTsKfQoKLy8gcmV0dXJucyB0
aGUga2V5cyB0aGF0IG1hdGNoIHRoZSBnaXZlbiByZWd1bGFyIGV4cHJlc3Npb24gcGF0dGVybgov
LyBpbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgYXMgYSBzdHJpbmcgbGlzdApwdWJsaWMgc3RhdGljIFN0
cmluZ1tdIGtleXNldChJRGF0YSBpbnB1dCwgU3RyaW5nIHBhdHRlcm4pIHsKICBqYXZhLnV0aWwu
cmVnZXguUGF0dGVybiBwID0gbnVsbDsKICBpZiAocGF0dGVybiAhPSBudWxsKSBwID0gamF2YS51
dGlsLnJlZ2V4LlBhdHRlcm4uY29tcGlsZShwYXR0ZXJuKTsKCiAgamF2YS51dGlsLkxpc3Q8U3Ry
aW5nPiBrZXlzID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1
dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsK
ICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGN1cnNvci5nZXRL
ZXkoKTsKCiAgICAgIGlmIChwID09IG51bGwpIHsKICAgICAgICBrZXlzLmFkZChjdXJzb3IuZ2V0
S2V5KCkpOwogICAgICB9IGVsc2UgewogICAgICAgIGphdmEudXRpbC5yZWdleC5NYXRjaGVyIG0g
PSBwLm1hdGNoZXIoa2V5KTsKICAgICAgICBpZiAobS5tYXRjaGVzKCkpIGtleXMuYWRkKGN1cnNv
ci5nZXRLZXkoKSk7CiAgICAgIH0gCiAgICB9CiAgICBjdXJzb3IuZGVzdHJveSgpOwogIH0KICBy
ZXR1cm4gKFN0cmluZ1tdKWtleXMudG9BcnJheShuZXcgU3RyaW5nWzBdKTsKfQoKLy8gcmV0dXJu
cyBhbGwgdGhlIHZhbHVlcyBpbiB0aGUgZ2l2ZW4gZG9jdW1lbnQgYXMgYSBzdHJpbmcgbGlzdApw
dWJsaWMgc3RhdGljIE9iamVjdFtdIHZhbHVlc2V0KElEYXRhIGlucHV0KSB7CiAgamF2YS51dGls
Lkxpc3Q8T2JqZWN0PiB2YWx1ZXMgPSBuZXcgamF2YS51dGlsLkFycmF5TGlzdDxPYmplY3Q+KCk7
CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0Lmdl
dEN1cnNvcigpOwogICAgd2hpbGUoY3Vyc29yLm5leHQoKSkgewogICAgICB2YWx1ZXMuYWRkKGN1
cnNvci5nZXRWYWx1ZSgpKTsKICAgIH0KICAgIGN1cnNvci5kZXN0cm95KCk7CiAgfQogIHJldHVy
biAoT2JqZWN0W10pdmFsdWVzLnRvQXJyYXkobmV3IE9iamVjdFswXSk7Cn0KCi8vIG1lcmdlcyBt
dWx0aXBsZSBJRGF0YSBkb2N1bWVudHMgaW50byBhIHNpbmdsZSBkb2N1bWVudApwdWJsaWMgc3Rh
dGljIElEYXRhIG1lcmdlKElEYXRhW10gaW5wdXQpIHsKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZh
Y3RvcnkuY3JlYXRlKCk7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsKICAgIGZvciAoaW50IGkgPSAw
OyBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHsKICAgICAgSURhdGFVdGlsLm1lcmdlKGlucHV0W2ld
LCBvdXRwdXQpOwogICAgfQogIH0KICByZXR1cm4gb3V0cHV0Owp9CgovLyBzb3J0cyB0aGUgZ2l2
ZW4gSURhdGEgZG9jdW1lbnQgYnkgaXRzIGtleXMgaW4gbmF0dXJhbCBhc2NlbmRpbmcgb3JkZXIK
cHVibGljIHN0YXRpYyBJRGF0YSBzb3J0KElEYXRhIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsK
ICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIFN0cmluZ1tdIGtleXMgPSBrZXlz
ZXQoaW5wdXQpOwogIGphdmEudXRpbC5BcnJheXMuc29ydChrZXlzKTsKCiAgSURhdGEgb3V0cHV0
ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vy
c29yKCk7CiAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIGZvciAoaW50
IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgYm9vbGVhbiByZXN1bHQ7CgogICAg
aWYgKGkgPiAwICYmIGtleXNbaV0uZXF1YWxzKGtleXNbaS0xXSkpIHsKICAgICAgcmVzdWx0ID0g
aWMubmV4dChrZXlzW2ldKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdCA9IGljLmZpcnN0KGtl
eXNbaV0pOwogICAgfQoKICAgIGlmIChyZXN1bHQpIHsKICAgICAgT2JqZWN0IHZhbHVlID0gaWMu
Z2V0VmFsdWUoKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYmIHJlY3Vyc2UpIHsKICAgICAg
ICBpZiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgdmFsdWUgPSBzb3J0KChJ
RGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9m
IElEYXRhW10gfHwgdmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAg
ICAgSURhdGFbXSBhcnJheSA9IHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXZh
bHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAgICAgICBm
b3IgKGludCBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGFycmF5
W2pdID0gc29ydChhcnJheVtqXSwgcmVjdXJzZSk7CiAgICAgICAgICB9CiAgICAgICAgICB2YWx1
ZSA9IGFycmF5OwogICAgICAgIH0KICAgICAgfQogICAgICBvYy5pbnNlcnRBZnRlcihrZXlzW2ld
LCB2YWx1ZSk7CiAgICB9CiAgfQoKICBpYy5kZXN0cm95KCk7CiAgb2MuZGVzdHJveSgpOwoKICBy
ZXR1cm4gb3V0cHV0Owp9CgovLyB0cmltcyBhbGwgc3RyaW5nIHZhbHVlcywgdGhlbiBjb252ZXJ0
cyBlbXB0eSBzdHJpbmdzIHRvIG51bGxzLCB0aGVuIGNvbXBhY3RzIGJ5IHJlbW92aW5nIGFsbCBu
dWxsIHZhbHVlcwpwdWJsaWMgc3RhdGljIElEYXRhIHNxdWVlemUoSURhdGEgaW5wdXQsIGJvb2xl
YW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGEg
b3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQu
Z2V0Q3Vyc29yKCk7CiAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHdo
aWxlKGljLm5leHQoKSkgewogICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgT2JqZWN0
IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICBp
ZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICBTdHJpbmcgc3RyaW5nID0gKFN0
cmluZyl2YWx1ZTsKICAgICAgICBzdHJpbmcgPSBzdHJpbmcudHJpbSgpOwogICAgICAgIGlmIChz
dHJpbmcuZXF1YWxzKCIiKSkgc3RyaW5nID0gbnVsbDsKCiAgICAgICAgdmFsdWUgPSBzdHJpbmc7
CiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAgIFN0
cmluZ1tdIGFycmF5ID0gKFN0cmluZ1tdKXZhbHVlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgYXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmIChhcnJheVtpXSAhPSBudWxsKSB7
CiAgICAgICAgICAgIGFycmF5W2ldID0gYXJyYXlbaV0udHJpbSgpOwogICAgICAgICAgICBpZiAo
YXJyYXlbaV0uZXF1YWxzKCIiKSkgYXJyYXlbaV0gPSBudWxsOwogICAgICAgICAgfQogICAgICAg
IH0KCiAgICAgICAgdmFsdWUgPSBhcnJheTsKICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5j
ZW9mIFN0cmluZ1tdW10pIHsKICAgICAgICBTdHJpbmdbXVtdIGFycmF5ID0gKFN0cmluZ1tdW10p
dmFsdWU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewog
ICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBhcnJheVtpXS5sZW5ndGg7IGorKykgewogICAg
ICAgICAgICBpZiAoYXJyYXlbaV1bal0gIT0gbnVsbCkgewogICAgICAgICAgICAgIGFycmF5W2ld
W2pdID0gYXJyYXlbaV1bal0udHJpbSgpOwogICAgICAgICAgICAgIGlmIChhcnJheVtpXVtqXS5l
cXVhbHMoIiIpKSBhcnJheVtpXVtqXSA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0K
ICAgICAgICB9CgogICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAgIH0gZWxzZSBpZiAocmVjdXJz
ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgdmFsdWUgPSBzcXVlZXplKChJ
RGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiAodmFsdWUg
aW5zdGFuY2VvZiBJRGF0YVtdIHx8IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUp
KSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJ
RGF0YVtdKXZhbHVlIDogKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCk7CiAg
ICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgICAg
YXJyYXlbaV0gPSBzcXVlZXplKGFycmF5W2ldLCByZWN1cnNlKTsKICAgICAgICB9CgogICAgICAg
IHZhbHVlID0gYXJyYXk7CiAgICAgIH0KCiAgICAgIG9jLmluc2VydEFmdGVyKGtleSwgdmFsdWUp
OwogICAgfQogIH0KCiAgaWMuZGVzdHJveSgpOwogIG9jLmRlc3Ryb3koKTsKCiAgcmV0dXJuIGNv
bXBhY3Qob3V0cHV0LCByZWN1cnNlKTsKfQoKLy8gcmV0dXJucyB0aGUgbnVtYmVyIG9mIHRvcC1s
ZXZlbCB7a2V5LCB2YWx1ZX0gcGFpcnMgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1Ymxp
YyBzdGF0aWMgaW50IHNpemUoSURhdGEgaW5wdXQpIHsKICBpbnQgc2l6ZSA9IDA7CiAgaWYgKGlu
cHV0ICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigp
OwogICAgc2l6ZSA9IElEYXRhVXRpbC5zaXplKGN1cnNvcik7CiAgICBjdXJzb3IuZGVzdHJveSgp
OwogIH0KICByZXR1cm4gc2l6ZTsKfQoKLy8gcmV0dXJucyBhIGNsb25lIG9mIHRoZSBnaXZlbiBJ
RGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIGR1cGxpY2F0ZShJRGF0YSBpbnB1dCwg
Ym9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgSURhdGEgb3V0cHV0
ID0gbnVsbDsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29yID0g
aW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB0cnkgewogICAgICBpZiAocmVjdXJzZSkgewogICAgICAg
IG91dHB1dCA9IElEYXRhVXRpbC5kZWVwQ2xvbmUoaW5wdXQpOwogICAgICB9IGVsc2UgewogICAg
ICAgIG91dHB1dCA9IElEYXRhVXRpbC5jbG9uZShpbnB1dCk7CiAgICAgIH0KICAgIH0gY2F0Y2gg
KGphdmEuaW8uSU9FeGNlcHRpb24gZXgpIHsKICAgICAgdHVuZHJhLmV4Y2VwdGlvbi5yYWlzZShl
eCk7CiAgICB9IGZpbmFsbHkgewogICAgICBjdXJzb3IuZGVzdHJveSgpOwogICAgfQogIH0KICBy
ZXR1cm4gb3V0cHV0Owp9CgovLyByZW1vdmVzIHRoZSB2YWx1ZSB3aXRoIHRoZSBnaXZlbiBrZXkg
ZnJvbSB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBkcm9wKElE
YXRhIGlucHV0LCBTdHJpbmcga2V5KSB7CiAgaWYgKGlucHV0ICE9IG51bGwgJiYga2V5ICE9IG51
bGwpIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgSURh
dGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleSk7CiAgICBjdXJzb3IuZGVzdHJveSgpOwoKICAgIGlm
ICh0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkuaXNGdWxseVF1YWxpZmllZChrZXkpKSBkcm9w
KGlucHV0LCB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5LZXkucGFyc2Uoa2V5KSk7CiAgfQogIHJl
dHVybiBpbnB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUgdmFsdWUgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZy
b20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnByb3RlY3RlZCBzdGF0aWMgSURhdGEgZHJvcChJ
RGF0YSBpbnB1dCwgamF2YS51dGlsLlF1ZXVlPHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LktleT4g
a2V5cykgewogIGlmIChpbnB1dCAhPSBudWxsICYmIGtleXMgIT0gbnVsbCAmJiBrZXlzLnNpemUo
KSA+IDApIHsKICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAg
dHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5IGtleSA9IGtleXMucmVtb3ZlKCk7CgogICAgaWYg
KGtleXMuc2l6ZSgpID4gMCkgewogICAgICBpZiAoa2V5Lmhhc0luZGV4KCkpIHsKICAgICAgICBJ
RGF0YVtdIGFycmF5ID0gSURhdGFVdGlsLmdldElEYXRhQXJyYXkoY3Vyc29yLCBrZXkudG9TdHJp
bmcoKSk7CiAgICAgICAgZHJvcCh0dW5kcmEubGlzdC5vYmplY3QuZ2V0KGFycmF5LCBrZXkuZ2V0
SW5kZXgoKSksIGtleXMpOwogICAgICB9IGVsc2UgewogICAgICAgIGRyb3AoSURhdGFVdGlsLmdl
dElEYXRhKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpLCBrZXlzKTsKICAgICAgfQogICAgfSBlbHNl
IHsKICAgICAgaWYgKGtleS5oYXNJbmRleCgpKSB7CiAgICAgICAgT2JqZWN0W10gYXJyYXkgPSBJ
RGF0YVV0aWwuZ2V0T2JqZWN0QXJyYXkoY3Vyc29yLCBrZXkudG9TdHJpbmcoKSk7CiAgICAgICAg
SURhdGFVdGlsLnB1dChjdXJzb3IsIGtleS50b1N0cmluZygpLCB0dW5kcmEubGlzdC5vYmplY3Qu
ZHJvcChhcnJheSwga2V5LmdldEluZGV4KCkpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBJRGF0
YVV0aWwucmVtb3ZlKGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICB9CiAgICB9CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogIH0KICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHZpc2l0cyBlYWNoIGVs
ZW1lbnQgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50LCBjYWxscyB0aGUgZ2l2ZW4gc2Vydmlj
ZSB0byBjb252ZXJ0IHRoZSBlbGVtZW50LCBhbmQgY3JlYXRlcyBhIG5ldyBJRGF0YSBkb2N1bWVu
dCB3aXRoIHRoZSByZXN1bHRpbmcgZWxlbWVudHMKcHVibGljIHN0YXRpYyBJRGF0YSBtYXAoSURh
dGEgaW5wdXQsIFN0cmluZyBzZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0
LCBTdHJpbmcga2V5T3V0cHV0LCBTdHJpbmcgdmFsdWVJbnB1dCwgU3RyaW5nIHZhbHVlT3V0cHV0
LCBDbGFzcyB2YWx1ZUNsYXNzLCBib29sZWFuIHJlY3Vyc2UpIHRocm93cyBTZXJ2aWNlRXhjZXB0
aW9uIHsKICBJRGF0YSBvdXRwdXQgPSBudWxsOwoKICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBzZXJ2
aWNlICE9IG51bGwpIHsKICAgIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAg
ICBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBvYyA9IG91
dHB1dC5nZXRDdXJzb3IoKTsKCiAgICBpZiAoa2V5SW5wdXQgPT0gbnVsbCkga2V5SW5wdXQgPSAi
JGtleSI7CiAgICBpZiAoa2V5T3V0cHV0ID09IG51bGwpIGtleU91dHB1dCA9IGtleUlucHV0Owog
ICAgaWYgKHZhbHVlSW5wdXQgPT0gbnVsbCkgdmFsdWVJbnB1dCA9ICIkdmFsdWUiOwogICAgaWYg
KHZhbHVlT3V0cHV0ID09IG51bGwpIHZhbHVlT3V0cHV0ID0gdmFsdWVJbnB1dDsKICAgIGlmIChw
aXBlbGluZSA9PSBudWxsKSBwaXBlbGluZSA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKCiAgICB0
cnkgewogICAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgICBUdXBsZTxPYmplY3Q+IHR1cGxl
ID0gbmV3IFR1cGxlPE9iamVjdD4oaWMuZ2V0S2V5KCksIGljLmdldFZhbHVlKCkpOwoKICAgICAg
ICBpZiAocmVjdXJzZSAmJiB0dXBsZS52YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgICBpZiAodHVw
bGUudmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgICB0dXBsZS52YWx1ZSA9IG1h
cCgoSURhdGEpdHVwbGUudmFsdWUsIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0
cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcywgcmVjdXJzZSk7CiAgICAg
ICAgICB9IGVsc2UgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB0dXBsZS52
YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLlRhYmxlKSB7CiAgICAgICAgICAgIElEYXRhW10g
aWFyeSA9IHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSA/IChJRGF0YVtdKXR1cGxlLnZh
bHVlIDogKChjb20ud20udXRpbC5UYWJsZSl0dXBsZS52YWx1ZSkuZ2V0VmFsdWVzKCk7CiAgICAg
ICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0YVtpYXJ5Lmxlbmd0aF07CiAgICAgICAgICAg
IGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIG9h
cnlbaV0gPSBtYXAoaWFyeVtpXSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRw
dXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzLCByZWN1cnNlKTsKICAgICAg
ICAgICAgfQogICAgICAgICAgICB0dXBsZS52YWx1ZSA9IG9hcnk7CiAgICAgICAgICB9IGVsc2Ug
aWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAgICAgICBTdHJp
bmdbXVtdIGlhcnkgPSAoU3RyaW5nW11bXSl0dXBsZS52YWx1ZTsKICAgICAgICAgICAgU3RyaW5n
W11bXSBvYXJ5ID0gbmV3IFN0cmluZ1tpYXJ5Lmxlbmd0aF1bXTsKICAgICAgICAgICAgZm9yIChp
bnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKGlhcnlb
aV0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgb2FyeVtpXSA9IG5ldyBTdHJpbmdbaWFyeVtp
XS5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBpYXJ5W2ldLmxl
bmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIFR1cGxlPFN0cmluZz4gdCA9IG1hcChuZXcg
VHVwbGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV1bal0pLCBzZXJ2aWNlLCBwaXBlbGluZSwg
a2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3Mp
OwogICAgICAgICAgICAgICAgICBvYXJ5W2ldW2pdID0gdC52YWx1ZTsKICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUg
PSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIFN0cmlu
Z1tdKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGlhcnkgPSAoU3RyaW5nW10pdHVwbGUudmFsdWU7
CiAgICAgICAgICAgIFN0cmluZ1tdIG9hcnkgPSBuZXcgU3RyaW5nW2lhcnkubGVuZ3RoXTsKICAg
ICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg
ICAgICAgVHVwbGU8U3RyaW5nPiB0ID0gbWFwKG5ldyBUdXBsZTxTdHJpbmc+KHR1cGxlLmtleSwg
aWFyeVtpXSksIHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlu
cHV0LCB2YWx1ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgb2FyeVtpXSA9IHQu
dmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5OwogICAg
ICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdKSB7CiAgICAg
ICAgICAgIE9iamVjdFtdIGlhcnkgPSAoT2JqZWN0W10pdHVwbGUudmFsdWU7CiAgICAgICAgICAg
IE9iamVjdFtdIG9hcnkgPSBuZXcgT2JqZWN0W2lhcnkubGVuZ3RoXTsKICAgICAgICAgICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBpYXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgVHVwbGU8
T2JqZWN0PiB0ID0gbWFwKG5ldyBUdXBsZTxPYmplY3Q+KHR1cGxlLmtleSwgaWFyeVtpXSksIHNl
cnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91
dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgICAgICAgb2FyeVtpXSA9IHQudmFsdWU7CiAgICAg
ICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUgPSBvYXJ5OwogICAgICAgICAgfQogICAg
ICAgIH0KICAgICAgICB0dXBsZSA9IG1hcCh0dXBsZSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlu
cHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQsIHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAg
ICAgICBJRGF0YVV0aWwucHV0KG9jLCB0dXBsZS5rZXksIHR1cGxlLnZhbHVlKTsKICAgICAgfQog
ICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgpOwogICAgICBvYy5kZXN0cm95KCk7CiAg
ICB9CiAgfSBlbHNlIHsKICAgIG91dHB1dCA9IGR1cGxpY2F0ZShpbnB1dCwgcmVjdXJzZSk7CiAg
fQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyB3cmFwcGVyIGNsYXNzIGZvciB7a2V5LCB2YWx1ZX0g
dHVwbGVzCnByb3RlY3RlZCBzdGF0aWMgY2xhc3MgVHVwbGU8VD4geyAKICBwdWJsaWMgU3RyaW5n
IGtleTsKICBwdWJsaWMgVCB2YWx1ZTsKICBwdWJsaWMgVHVwbGUoU3RyaW5nIGtleSwgVCB2YWx1
ZSkgeyAKICAgIHRoaXMua2V5ID0ga2V5OyAKICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsgCiAgfQp9
CgovLyBjb252ZXJ0cyB0aGUgZ2l2ZW4gZWxlbWVudCBieSBjYWxsaW5nIHRoZSBnaXZlbiBzZXJ2
aWNlLCBhbmQgcmV0dXJucyB0aGUgcmVzdWx0CnByb3RlY3RlZCBzdGF0aWMgPFQ+IFR1cGxlPFQ+
IG1hcChUdXBsZTxUPiB0dXBsZSwgU3RyaW5nIHNlcnZpY2UsIElEYXRhIHBpcGVsaW5lLCBTdHJp
bmcga2V5SW5wdXQsIFN0cmluZyBrZXlPdXRwdXQsIFN0cmluZyB2YWx1ZUlucHV0LCBTdHJpbmcg
dmFsdWVPdXRwdXQsIENsYXNzIHZhbHVlQ2xhc3MpIHRocm93cyBTZXJ2aWNlRXhjZXB0aW9uIHsK
ICBpZiAodHVwbGUudmFsdWUgPT0gbnVsbCB8fCB2YWx1ZUNsYXNzID09IG51bGwgfHwgdmFsdWVD
bGFzcy5pc0luc3RhbmNlKHR1cGxlLnZhbHVlKSkgewogICAgSURhdGFDdXJzb3IgY3Vyc29yID0g
cGlwZWxpbmUuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwga2V5SW5wdXQs
IHR1cGxlLmtleSk7CiAgICBJRGF0YVV0aWwucHV0KGN1cnNvciwgdmFsdWVJbnB1dCwgdHVwbGUu
dmFsdWUpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKCiAgICBwaXBlbGluZSA9IHR1bmRyYS5zZXJ2
aWNlLmludm9rZShzZXJ2aWNlLCBwaXBlbGluZSk7CgogICAgLy8gY2xlYW4gdXAgdGhlIGlucHV0
IHBpcGVsaW5lCiAgICBjdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsKICAgIHR1cGxlLmtl
eSA9IElEYXRhVXRpbC5nZXRTdHJpbmcoY3Vyc29yLCBrZXlPdXRwdXQpOwogICAgdHVwbGUudmFs
dWUgPSAoVClJRGF0YVV0aWwuZ2V0KGN1cnNvciwgdmFsdWVPdXRwdXQpOwogICAgSURhdGFVdGls
LnJlbW92ZShjdXJzb3IsIGtleUlucHV0KTsKICAgIGlmICgha2V5SW5wdXQuZXF1YWxzKGtleU91
dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXlPdXRwdXQpOwogICAgSURhdGFVdGls
LnJlbW92ZShjdXJzb3IsIHZhbHVlSW5wdXQpOwogICAgaWYgKCF2YWx1ZUlucHV0LmVxdWFscyh2
YWx1ZU91dHB1dCkpIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCB2YWx1ZU91dHB1dCk7CiAgICBj
dXJzb3IuZGVzdHJveSgpOwogIH0gIAogIHJldHVybiB0dXBsZTsKfQoKLy8gaW52b2tlcyB0aGUg
Z2l2ZW4gc2VydmljZSBmb3IgZWFjaCB7a2V5LCB2YWx1ZX0gcGFpciBpbiB0aGUgZ2l2ZW4gSURh
dGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyB2b2lkIGVhY2goSURhdGEgaW5wdXQsIFN0cmluZyBz
ZXJ2aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBTdHJpbmcgdmFsdWVJbnB1
dCwgQ2xhc3MgdmFsdWVDbGFzcywgYm9vbGVhbiByZWN1cnNlKSB0aHJvd3MgU2VydmljZUV4Y2Vw
dGlvbiB7CiAgbWFwKGlucHV0LCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIG51bGwsIHZh
bHVlSW5wdXQsIG51bGwsIHZhbHVlQ2xhc3MsIHJlY3Vyc2UpOwp9CgovLyByZW5hbWVzIGEga2V5
IGZyb20gc291cmNlIHRvIHRhcmdldCB3aXRoaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1
YmxpYyBzdGF0aWMgSURhdGEgcmVuYW1lKElEYXRhIGlucHV0LCBTdHJpbmcgc291cmNlLCBTdHJp
bmcgdGFyZ2V0KSB7CiAgaWYgKCFzb3VyY2UuZXF1YWxzKHRhcmdldCkpIGlucHV0ID0gZHJvcChj
b3B5KGlucHV0LCBzb3VyY2UsIHRhcmdldCksIHNvdXJjZSk7CiAgcmV0dXJuIGlucHV0Owp9Cgov
LyBjb3BpZXMgYSB2YWx1ZSBmcm9tIHNvdXJjZSBrZXkgdG8gdGFyZ2V0IGtleSB3aXRoaW4gdGhl
IGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgY29weShJRGF0YSBpbnB1
dCwgU3RyaW5nIHNvdXJjZSwgU3RyaW5nIHRhcmdldCkgewogIGlmIChzb3VyY2UuZXF1YWxzKHRh
cmdldCkpIHJldHVybiBpbnB1dDsKICByZXR1cm4gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0
KGlucHV0LCB0YXJnZXQsIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LmdldChpbnB1dCwgc291cmNl
KSk7Cn0KCi8vIHJlbW92ZXMgYWxsIG51bGwgdmFsdWVzIGZyb20gdGhlIGdpdmVuIElEYXRhIGRv
Y3VtZW50CnB1YmxpYyBzdGF0aWMgSURhdGEgY29tcGFjdChJRGF0YSBpbnB1dCwgYm9vbGVhbiBy
ZWN1cnNlKSB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsKCiAgaWYgKGlucHV0ICE9IG51bGwpIHsK
ICAgIG91dHB1dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICAgIElEYXRhQ3Vyc29yIGljID0g
aW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICBJRGF0YUN1cnNvciBvYyA9IG91dHB1dC5nZXRDdXJzb3Io
KTsKCiAgICB0cnkgewogICAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgICBTdHJpbmcga2V5
ID0gaWMuZ2V0S2V5KCk7CiAgICAgICAgT2JqZWN0IHZhbHVlID0gaWMuZ2V0VmFsdWUoKTsKCiAg
ICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICAgIGlmIChyZWN1cnNlKSB7CiAgICAg
ICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEYXRhKSB7CiAgICAgICAgICAgICAgdmFsdWUg
PSBjb21wYWN0KChJRGF0YSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo
dmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdKSB7CiAgICAgICAgICAgICAgSURhdGFbXSBhcnJheSA9
IHR1bmRyYS5saXN0Lm9iamVjdC5jb21wYWN0KChJRGF0YVtdKXZhbHVlKTsKICAgICAgICAgICAg
ICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg
ICBhcnJheVtpXSA9IGNvbXBhY3QoYXJyYXlbaV0sIHJlY3Vyc2UpOwogICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICB2YWx1ZSA9IGFycmF5OwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVl
IGluc3RhbmNlb2YgU3RyaW5nW11bXSkgewogICAgICAgICAgICAgIFN0cmluZ1tdW10gYXJyYXkg
PSAoU3RyaW5nW11bXSl2YWx1ZTsKICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFy
cmF5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBhcnJheVtpXSA9IHR1bmRyYS5saXN0
Lm9iamVjdC5jb21wYWN0KGFycmF5W2ldKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
dmFsdWUgPSBhcnJheTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0
cmluZ1tdKSB7CiAgICAgICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlzdC5vYmplY3QuY29tcGFj
dCgoU3RyaW5nW10pdmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNl
b2YgT2JqZWN0W10pIHsKICAgICAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0Lm9iamVjdC5j
b21wYWN0KChPYmplY3RbXSl2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAg
ICB9CgogICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSBJRGF0YVV0aWwucHV0KG9jLCBrZXksIHZh
bHVlKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWMuZGVzdHJveSgpOwogICAgICBv
Yy5kZXN0cm95KCk7CiAgICB9CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9CgovLyByZXR1cm5zIGEg
bmV3IElEYXRhIGRvY3VtZW50LCB3aGVyZSBhbGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3aXRo
IHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsCi8vIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBs
YWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwdWJsaWMgc3RhdGljIElEYXRhIG5vcm1hbGl6
ZShJRGF0YSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJl
dHVybiBudWxsOwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgSURh
dGFDdXJzb3IgaWMgPSBpbnB1dC5nZXRDdXJzb3IoKTsKCiAgdHJ5IHsKICAgIHdoaWxlKGljLm5l
eHQoKSkgewogICAgICBTdHJpbmcga2V5ID0gaWMuZ2V0S2V5KCk7CiAgICAgIE9iamVjdCB2YWx1
ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgIGlm
ICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSkgewogICAg
ICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZSl2YWx1ZSkuZ2V0
SURhdGEoKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwu
Y29kZXIuVmFsdWVzQ29kYWJsZSkgewogICAgICAgICAgdmFsdWUgPSAoKGNvbS53bS51dGlsLmNv
ZGVyLlZhbHVlc0NvZGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgIH0gZWxzZSBpZiAo
dmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVbXSkgewogICAg
ICAgICAgdmFsdWUgPSBub3JtYWxpemUoKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZVtd
KXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29t
LndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1h
bGl6ZSgoY29tLndtLnV0aWwuY29kZXIuVmFsdWVzQ29kYWJsZVtdKXZhbHVlLCByZWN1cnNlKTsK
ICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSkgewogICAgICAgICAg
dmFsdWUgPSBub3JtYWxpemUoKElEYXRhW10pdmFsdWUsIHJlY3Vyc2UpOwogICAgICAgIH0gZWxz
ZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJsZSkgewogICAgICAgICAgdmFs
dWUgPSBub3JtYWxpemUoKChjb20ud20udXRpbC5UYWJsZSl2YWx1ZSkuZ2V0VmFsdWVzKCksIHJl
Y3Vyc2UpOwogICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIElE
YXRhKSB7CiAgICAgICAgICB2YWx1ZSA9IG5vcm1hbGl6ZSgoSURhdGEpdmFsdWUsIHJlY3Vyc2Up
OwogICAgICAgIH0KICAgICAgfQogICAgICB0dW5kcmEuc3VwcG9ydC5kb2N1bWVudC5wdXQob3V0
cHV0LCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGZpbmFsbHkgewogICAgaWMuZGVzdHJveSgpOwog
IH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gbm9ybWFsaXplcyBhbiBJRGF0YVtdLCB3aGVyZSBh
bGwgSURhdGFzIGFyZSBpbXBsZW1lbnRlZCB3aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsCi8v
IGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVy
ZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKElEYXRhW10gaW5wdXQsIGJvb2xl
YW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGFb
XSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3IgKGludCBpID0gMDsgaSA8
IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3JtYWxpemUoaW5wdXRbaV0s
IHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gY29udmVydHMgYW4gSURhdGFD
b2RhYmxlW10gdG8gYW4gSURhdGFbXSBhbmQgbm9ybWFsaXplcywgd2hlcmUgYWxsIElEYXRhcyBh
cmUgaW1wbGVtZW50ZWQgCi8vIHdpdGggdGhlIHNhbWUgY2xhc3MsIGFuZCBhbGwgZnVsbHkgcXVh
bGlmaWVkIGtleXMgYXJlIHJlcGxhY2VkIHdpdGggYSBuZXN0ZWQgc3RydWN0dXJlCnByb3RlY3Rl
ZCBzdGF0aWMgSURhdGFbXSBub3JtYWxpemUoY29tLndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxl
W10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4g
bnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3RoXTsKICBmb3Ig
KGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRbaV0gPSBub3Jt
YWxpemUoaW5wdXRbaV0uZ2V0SURhdGEoKSwgcmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBvdXRw
dXQ7Cn0KCi8vIGNvbnZlcnRzIGEgVmFsdWVzQ29kYWJsZVtdIHRvIGFuIElEYXRhW10gYW5kIG5v
cm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVkIAovLyB3aXRoIHRoZSBz
YW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBsYWNlZCB3aXRo
IGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9ybWFsaXplKGNv
bS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGVbXSBpbnB1dCwgYm9vbGVhbiByZWN1cnNlKSB7
CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwoKICBJRGF0YVtdIG91dHB1dCA9IG5l
dyBJRGF0YVtpbnB1dC5sZW5ndGhdOwogIGZvciAoaW50IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3Ro
OyBpKyspIHsKICAgIG91dHB1dFtpXSA9IG5vcm1hbGl6ZShpbnB1dFtpXS5nZXRWYWx1ZXMoKSwg
cmVjdXJzZSk7CiAgfQogIAogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJlbW92ZXMgYWxsIGtleXMg
ZXhjZXB0IHRob3NlIHNwZWNpZmllZCBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJs
aWMgc3RhdGljIHZvaWQgY2xlYXIoSURhdGEgZG9jdW1lbnQsIFN0cmluZ1tdIGtleXMpIHsKICBp
ZiAoZG9jdW1lbnQgPT0gbnVsbCkgcmV0dXJuOwoKICBJRGF0YSBzYXZlZCA9IG51bGw7CiAgaWYg
KGtleXMgIT0gbnVsbCkgewogICAgc2F2ZWQgPSBJRGF0YUZhY3RvcnkuY3JlYXRlKCk7CiAgICBm
b3IgKGludCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgT2JqZWN0IHZhbHVl
ID0gdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuZ2V0KGRvY3VtZW50LCBrZXlzW2ldKTsKICAgICAg
aWYgKHZhbHVlICE9IG51bGwpIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LnB1dChzYXZlZCwga2V5
c1tpXSwgdmFsdWUpOwogICAgfQogIH0KCiAgSURhdGFDdXJzb3IgY3Vyc29yID0gZG9jdW1lbnQu
Z2V0Q3Vyc29yKCk7CiAgY3Vyc29yLmZpcnN0KCk7CiAgd2hpbGUoY3Vyc29yLmRlbGV0ZSgpKTsK
ICBjdXJzb3IuZGVzdHJveSgpOwoKICBpZiAoa2V5cyAhPSBudWxsKSBJRGF0YVV0aWwubWVyZ2Uo
c2F2ZWQsIGRvY3VtZW50KTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUgc3Vic3RpdHV0aW9uIG9u
IGFsbCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9jdW1lbnQKcHVibGljIHN0
YXRpYyBJRGF0YSBzdWJzdGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBzY29wZSwgYm9vbGVhbiBy
ZWN1cnNlKSB7CiAgcmV0dXJuIHN1YnN0aXR1dGUoaW5wdXQsIHNjb3BlLCBudWxsLCByZWN1cnNl
KTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUgc3Vic3RpdHV0aW9uIG9uIGFsbCBlbGVtZW50cyBv
ZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0YSBzdWJz
dGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBzY29wZSwgU3RyaW5nIGRlZmF1bHRWYWx1ZSwgYm9v
bGVhbiByZWN1cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwogIGlmIChz
Y29wZSA9PSBudWxsKSBzY29wZSA9IGlucHV0OwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3Rv
cnkuY3JlYXRlKCk7CgogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURh
dGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHRyeSB7CiAgICB3aGlsZShpYy5u
ZXh0KCkpIHsKICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgICBPYmplY3QgdmFs
dWUgPSBpYy5nZXRWYWx1ZSgpOwogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgIGlm
IChyZWN1cnNlICYmIHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAgIHZhbHVlID0g
c3Vic3RpdHV0ZSgoSURhdGEpdmFsdWUsIHNjb3BlLCBkZWZhdWx0VmFsdWUsIHJlY3Vyc2UpOwog
ICAgICAgIH0gZWxzZSBpZiAocmVjdXJzZSAmJiAodmFsdWUgaW5zdGFuY2VvZiBJRGF0YVtdIHx8
IHZhbHVlIGluc3RhbmNlb2YgY29tLndtLnV0aWwuVGFibGUpKSB7CiAgICAgICAgICBJRGF0YVtd
IGlhcnkgPSB2YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10gPyAoSURhdGFbXSl2YWx1ZSA6ICgoY29t
LndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAgSURhdGFbXSBvYXJ5
ID0gbmV3IElEYXRhW2lhcnkubGVuZ3RoXTsKICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg
aWFyeS5sZW5ndGg7IGkrKykgb2FyeVtpXSA9IHN1YnN0aXR1dGUoaWFyeVtpXSwgc2NvcGUsIGRl
ZmF1bHRWYWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgICB2YWx1ZSA9IG9hcnk7CiAgICAgICAgfSBl
bHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgdmFsdWUgPSB0dW5k
cmEuc3RyaW5nLnN1YnN0aXR1dGUoKFN0cmluZyl2YWx1ZSwgc2NvcGUsIGRlZmF1bHRWYWx1ZSk7
CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdKSB7CiAgICAgICAg
ICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChTdHJpbmdbXSl2YWx1ZSwg
c2NvcGUsIGRlZmF1bHRWYWx1ZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9m
IFN0cmluZ1tdW10pIHsKICAgICAgICAgIHZhbHVlID0gdHVuZHJhLmxpc3Quc3RyaW5nLnN1YnN0
aXR1dGUoKFN0cmluZ1tdW10pdmFsdWUsIHNjb3BlLCBkZWZhdWx0VmFsdWUpOwogICAgICAgIH0K
ICAgICAgfQogICAgICBJRGF0YVV0aWwucHV0KG9jLCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGZp
bmFsbHkgewogICAgaWMuZGVzdHJveSgpOwogICAgb2MuZGVzdHJveSgpOwogIH0KCiAgcmV0dXJu
IG91dHB1dDsKfQoKLy8gcGFyc2VzIGFuIElEYXRhIFhNTCBpbnB1dCBzdHJlYW0gdG8gYW4gSURh
dGEgb2JqZWN0CnB1YmxpYyBzdGF0aWMgSURhdGEgcGFyc2UoamF2YS5pby5JbnB1dFN0cmVhbSBp
bikgdGhyb3dzIGphdmEuaW8uSU9FeGNlcHRpb24gewogIGNvbS53bS51dGlsLmNvZGVyLlhNTENv
ZGVyV3JhcHBlciBjb2RlYyA9IG5ldyBjb20ud20udXRpbC5jb2Rlci5YTUxDb2RlcldyYXBwZXIo
KTsKICByZXR1cm4gY29kZWMuZGVjb2RlKGluKTsKfQoKLy8gcGFyc2VzIGFuIElEYXRhIFhNTCBz
dHJpbmcsIGJ5dGUgYXJyYXkgb3IgaW5wdXQgc3RyZWFtIHRvIGFuIElEYXRhIG9iamVjdApwdWJs
aWMgc3RhdGljIElEYXRhIHBhcnNlKE9iamVjdCBjb250ZW50LCBTdHJpbmcgZW5jb2RpbmcpIHRo
cm93cyBqYXZhLmlvLklPRXhjZXB0aW9uIHsKICByZXR1cm4gcGFyc2UoKGphdmEuaW8uSW5wdXRT
dHJlYW0pdHVuZHJhLm9iamVjdC5jb252ZXJ0KGNvbnRlbnQsIGVuY29kaW5nLCAic3RyZWFtIikp
Owp9CgovLyBlbWl0cyBhbiBJRGF0YSBvYmplY3QgYXMgYSBhbiBJRGF0YSBYTUwgc3RyaW5nLCBi
eXRlIGFycmF5IG9yIHN0cmVhbQpwdWJsaWMgc3RhdGljIE9iamVjdCBlbWl0KElEYXRhIGRvY3Vt
ZW50LCBTdHJpbmcgZW5jb2RpbmcsIFN0cmluZyBtb2RlKSB0aHJvd3MgamF2YS5pby5JT0V4Y2Vw
dGlvbiB7CiAgY29tLndtLnV0aWwuY29kZXIuSURhdGFYTUxDb2RlciBjb2RlYyA9IG51bGw7CiAg
aWYgKGVuY29kaW5nID09IG51bGwpIHsKICAgIGNvZGVjID0gbmV3IGNvbS53bS51dGlsLmNvZGVy
LklEYXRhWE1MQ29kZXIoKTsKICB9IGVsc2UgewogICAgY29kZWMgPSBuZXcgY29tLndtLnV0aWwu
Y29kZXIuSURhdGFYTUxDb2RlcihlbmNvZGluZyk7CiAgfQoKICBqYXZhLmlvLkJ5dGVBcnJheU91
dHB1dFN0cmVhbSBvdXQgPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKICBj
b2RlYy5lbmNvZGUob3V0LCBkb2N1bWVudCk7CgogIHJldHVybiB0dW5kcmEub2JqZWN0LmNvbnZl
cnQob3V0LnRvQnl0ZUFycmF5KCksIGVuY29kaW5nLCBtb2RlKTsKfQ==</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
